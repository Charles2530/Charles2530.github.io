<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Charles">
    
    <meta name="author" content="Charles">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
        
            <link rel="preconnect" href="https://npm.elemecdn.com" crossorigin>
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://charles2530.github.io/2023/03/09/oo-summary-1-expression/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="post by Charles in 2023-03-09 13:17:18">
<meta property="og:type" content="article">
<meta property="og:title" content="OO_summary_1.Expression">
<meta property="og:url" content="http://charles2530.github.io/2023/03/09/oo-summary-1-expression/index.html">
<meta property="og:site_name" content="Charles&#39;s Castle">
<meta property="og:description" content="post by Charles in 2023-03-09 13:17:18">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://charles2530.github.io/image/BNF_hw1">
<meta property="og:image" content="https://charles2530.github.io/image/hw1.png">
<meta property="og:image" content="https://charles2530.github.io/image/BNF_hw2">
<meta property="og:image" content="https://charles2530.github.io/image/hw2.png">
<meta property="og:image" content="https://charles2530.github.io/image/BNF_hw3">
<meta property="og:image" content="https://charles2530.github.io/image/hw3.png">
<meta property="og:image" content="https://charles2530.github.io/image/oo_1_line">
<meta property="og:image" content="https://charles2530.github.io/image/UML_oo_1">
<meta property="og:image" content="https://charles2530.github.io/image/match.png">
<meta property="article:published_time" content="2023-03-09T05:17:18.000Z">
<meta property="article:modified_time" content="2023-06-17T06:13:59.334Z">
<meta property="article:author" content="Du Jinyang">
<meta property="article:tag" content="OO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://charles2530.github.io/image/BNF_hw1">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://charles2530.github.io/image/background/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://charles2530.github.io/image/background/favicon.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://charles2530.github.io/image/background/favicon.png">
    <!--- Page Info-->
    
    <title>
        
            OO_summary_1.Expression -
        
        Charles&#39;s Castle
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fonts/fonts.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fonts/Satoshi/satoshi.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fonts/Chillax/chillax.css">
    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"charles2530.github.io","root":"/","language":"en","path":"search.xml"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":true,"list":["lol","Neo","God"]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":true,"title":"recommend_articles","limit":3,"mobile_limit":2,"placeholder":"https://charles2530.github.io/image/background/p3.jfif","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":"#1890ff"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://charles2530.github.io/image/background/background-light1.jpg","dark":"https://charles2530.github.io/image/background/background-dark1.jpg"},"title":"Charles's Castle","subtitle":{"text":["Happiness is best!","Never give up!","Everyday is a gift!"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#000000","dark":"#d1d1b6"},"text_style":{"title_size":"3.2rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/Charles2530/","zhihu":"https://www.zhihu.com/people/yang-guang-xiao-zi-55-55","email":"charles2530@163.com"}}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null},{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.2.0","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Categories":{"path":"/categories","icon":"fas fa-bookmark"},"Tags":{"path":"/tags","icon":"fas fa-tags"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/Charles2530/","Blog":"https://charles2530.github.io"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"This is Charles's Castle","links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Photos":{"icon":"fa-solid fa-image","path":"/masonry/"},"Essays":{"icon":"fa-solid fa-message-lines","path":"/essay/"},"Friends":{"icon":"fa-solid fa-user-group","path":"/friends/"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/12/27 00:00:00"};
    Global.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    Global.data_config = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="Charles's Castle" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>



<body>
  <div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Charles&#39;s Castle
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fas fa-bookmark"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags"  >
                                    
                                        
                                            <i class="fas fa-tags"></i>
                                        
                                        TAGS
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://charles2530.github.io">BLOG
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/categories"  >
                             
                                
                                    <i class="fas fa-bookmark"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/tags"  >
                             
                                
                                    <i class="fas fa-tags"></i>
                                
                                TAGS
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="https://charles2530.github.io">BLOG</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
                      
                <div class="article-title">
                    <img src="https://charles2530.github.io/image/background/p1.jfif" alt="OO_summary_1.Expression" />
                    <h1 class="article-title-cover">OO_summary_1.Expression</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://charles2530.github.io/image/background/logo.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Charles</span>
                            
                                <span class="author-label">Lv6</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-03-09 13:17:18</span>
        <span class="mobile">2023-03-09 13:17</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-06-17 14:13:59</span>
            <span class="mobile">2023-06-17 14:13</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Lesson/">Lesson</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/Lesson/OO/">OO</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/Lesson/OO/OO-lab/">OO-lab</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/OO/">OO</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>13k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>54 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1 id="OO-summary-1-Expression"><a href="#OO-summary-1-Expression" class="headerlink" title="OO_summary_1.Expression"></a>OO_summary_1.Expression</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><code>OO</code>第一单元的主题是<strong>表达式括号展开</strong>，主要的学习目标是熟悉面向对象的思想（<strong>继承、封装、多态</strong>），学会使用类来管理对象，掌握一定的<strong>模块化设计能力,</strong>学习一些设计模式如<strong>工厂模式</strong>的概念，是一章对于架构设计要求很高的单元。本单元一共有三次作业——<strong>多变量多项式展开</strong>，<strong>含有三角函数和自定义函数的多项式展开</strong>，<strong>含有多层嵌套的表达式展开及求导因子的引入</strong>。</p>
<p>不难看出，这三次作业的要求是<strong>层层递进</strong>，代码的复杂度也同样大大递增，笔者甚至在第二次作业贡献了一波<code>TLE</code>。21级的<code>OO</code>第一单元是在20级的单变量表达式展开和19级的求导运算相结合的产物，并且难度也明显增加，例如将变量改成了x，y，z三种并支持<strong>导数因子</strong>和<strong>自定义函数嵌套</strong>等，这些在实际上手时还是非常有难度的。<del>这时候就体现出<code>OO-pre</code>的优越性了</del></p>
<hr>
<h2 id="hw1分析"><a href="#hw1分析" class="headerlink" title="hw1分析"></a>hw1分析</h2><p>第一次作业主要是关于<strong>多变量多项式的展开</strong>，这次我们需要展开的表达式中项只有四种——<strong>变量因子</strong>，<strong>幂函数因子</strong>，<strong>常数因子</strong>和<strong>表达式因子</strong>。而笔者更是将变量因子和常数因子一并包含到了幂函数因子中，实现了类型的统一，当然随之而来<strong>耦合性</strong>也相对较高。</p>
<h3 id="文法规则"><a href="#文法规则" class="headerlink" title="文法规则"></a>文法规则</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/BNF_hw1"
                      alt="image-20230309202619338"
                ></p>
<h3 id="代码UML类图"><a href="#代码UML类图" class="headerlink" title="代码UML类图"></a>代码UML类图</h3><p>本次作业代码的<code>UML</code>类图如下所示</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/hw1.png"
                      alt=""
                ></p>
<h3 id="简要思路"><a href="#简要思路" class="headerlink" title="简要思路"></a>简要思路</h3><p>由于这是一单元作业的开篇之作，所以一个好的<strong>架构</strong>可以起到一劳永逸的效果，所以我花了一天查博客等寻找思路，以追求更好的效果。我的第一次作业大致思路分为四个部分。<strong>预处理\==&gt;递归下降形成表达式\==&gt;将表达式转化为多项式\==&gt;多项式化简（合并同类项）\==&gt;利用重写<code>toString()</code>来完成多项式的输出</strong>，并优化性能分。具体细节看下面的具体介绍。</p>
<h3 id="代码架构分析"><a href="#代码架构分析" class="headerlink" title="代码架构分析"></a>代码架构分析</h3><p>简单分析本次作业的要求后我们不难发现(在<strong>第一次训练</strong>部分也给出了类似思路），我们表达式主要包含三部分——<code>Expr</code>，<code>Term</code>，<code>Factor</code>，而<code>Factor</code>又有四种——<strong>幂函数，变量因子，常数因子和表达式因子</strong>，基于<strong>面向对象</strong>的思想，我们要对这些类型分别建类。其中<code>Expr</code>类中使用<code>ArrayList</code>来容纳该表达式中含有的<code>Term</code>，<code>Term</code>类中使用<code>ArrayList</code>来容纳该项中含有的<code>Factor</code>。而<code>Factor</code>由于有多种不同的因子（之后两次作业本质上也就是引入了新的因子），所以我引入了<code>Expfactor</code>来集中表示幂函数、变量因子和常量因子,用<code>ExprFactor</code>来表示表达式因子，至此完成了作业的第一步——<strong>建类</strong>。</p>
<h4 id="表达式解析：递归下降算法"><a href="#表达式解析：递归下降算法" class="headerlink" title="表达式解析：递归下降算法"></a>表达式解析：递归下降算法</h4><p><strong>表达式解析</strong>有使用<strong>正则表达式</strong>进行字符串解析和使用<strong>递归下降</strong>两种方式，但由于正则表达式法不能在后续不能有效的处理递归括号的情况，而且在之前<code>OO-pre</code>课程中我们已经练习过了简单的递归下降的书写，所以我重点在这里介绍<strong>递归下降</strong>方法。</p>
<p>递归下降算法主要包含了两个部分——<code>Lexer</code>（<strong>词法分析器</strong>）和<code>Paser</code>（<strong>解析器</strong>）。<code>Lexer</code>主要是将表达式分解成一系列基本语法单元及完成预处理工作，而<code>Parser</code>主要是根据表达式的形式化定义，依靠<code>Lexer</code>分解出的语法单元，递归的生成表达式、项和因子。</p>
<h5 id="Lexer（词法分析器）"><a href="#Lexer（词法分析器）" class="headerlink" title="Lexer（词法分析器）"></a>Lexer（词法分析器）</h5><p>对于<code>lexer</code>部分，我在<code>lexer</code>部分主要做了三件事，<strong>处理掉空白符</strong>、<strong>将连续的正负号合并</strong>成一个以及将<strong>变量常量等处理为一个整体</strong>。</p>
<p>具体而言，我设置了一个<code>acquire</code>容器来<strong>存储对于解析有效的各种特征字符串</strong>，具体操作就是用<code>idx</code>指针先提前将整个字符串分析一遍，然后让<code>parser</code>中用<code>pos</code>指针来完成读入工作，这样先处理一遍可以给<code>parser</code>中省去大量的工作，如分辨*和**,将数字读取成一个整体等，下方是一段预处理的部分代码。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">trans</span><span class="params">(String str)</span> &#123;<span class="comment">//input</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> str.length();</span><br><span class="line">    <span class="keyword">for</span> (pos = <span class="number">0</span>; pos &lt; len; pos++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/* 是数字 */</span>) &#123;</span><br><span class="line">            acquire.add(getNumber());</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="comment">/* 是因子 */</span>)) &#123;</span><br><span class="line">            acquire.add(getTerm());</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str.charAt(pos) == <span class="string">&#x27;+&#x27;</span> || str.charAt(pos) == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">//处理连续正负号</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str.charAt(pos) == <span class="string">&#x27;(&#x27;</span> || str.charAt(pos) == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">            acquire.add(String.valueOf(str.charAt(pos)));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str.charAt(pos) == <span class="string">&#x27;*&#x27;</span>) &#123;<span class="comment">//分辨*和**</span></span><br><span class="line">            <span class="keyword">if</span> (str.charAt(pos + <span class="number">1</span>) == <span class="string">&#x27;*&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">//处理**</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//处理*</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*由于没有写else块，所以会自动过滤掉所有空白符，当然也可以使用replaceALL方法*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>词法分析器，其实就是把一个一个的字符拆成有意义的语义元素，比如将 <code>sin(x**2)**3</code> 就顺序拆成 <code>sin</code>，<code>(</code>，<code>x</code>，<code>**</code>，<code>2</code>，<code>)</code>，<code>**</code>，<code>3</code> 即可。这样我们就把表达式中所有语法单元都解析出来了，下面就该到<code>Parser</code>发挥作用了。</p>
<h5 id="Parser-解释器"><a href="#Parser-解释器" class="headerlink" title="Parser(解释器)"></a>Parser(解释器)</h5><p><code>Parser</code>类的设计主要是沿用了本单元练习题中的写法，将表达式的解析分成了三部分——<code>parseExpr</code>, <code>parseTerm</code>, <code>parseFactor</code>，每一部分的解析都遵循<strong>形式化文法</strong>，然后我在<code>parseFactor</code>中根据调用的不同因子而分别调用了不同因子的<strong>构造方法</strong>，并将这些分别写为小函数，从而大幅度降低了耦合性(这样做对于后面的作业而言也只需要加方法即可）。</p>
<p>在parser中我们需要使用<code>lexer</code>的两个函数以让<code>lexer</code>分析出的那些语法单元真正在parser中发挥作用：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">next</td>
<td style="text-align:left"><code>Lexer</code>移动指向下一个元素</td>
</tr>
<tr>
<td style="text-align:left">present</td>
<td style="text-align:left">返回<code>Lexer</code> 当前指向的元素</td>
</tr>
</tbody>
</table>
</div>
<p>以<code>parseExpr</code>为例，因为第一项之前可能带有符号，于是我们就先将符号（<code>+</code>或者<code>-</code>）解析出来，然后解析第1项。解析完第1项后，我们就可以直接使用<code>while</code>循环对后面的项依次进行解析。需要注意的是，<strong>解析项</strong>实际上就调用一次<code>parseFactor()</code>方法.代码如下</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Expr <span class="title function_">parseExpr</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Expr</span> <span class="variable">expr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Expr</span>();</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">sign</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (lexer.isOp(lexer.present())) &#123;</span><br><span class="line">        sign = (lexer.present().equals(<span class="string">&quot;+&quot;</span>));</span><br><span class="line">        lexer.next();</span><br><span class="line">    &#125;</span><br><span class="line">    expr.addTerm(parseTerm(sign));</span><br><span class="line">    <span class="keyword">while</span> (lexer.present().equals(<span class="string">&quot;+&quot;</span>) || lexer.present().equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (lexer.present().equals(<span class="string">&quot;+&quot;</span>)) &#123;</span><br><span class="line">            lexer.next();</span><br><span class="line">            expr.addTerm(parseTerm(<span class="literal">true</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            lexer.next();</span><br><span class="line">            expr.addTerm(parseTerm(<span class="literal">false</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> expr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> Term <span class="title function_">parseTerm</span><span class="params">(<span class="type">int</span> sign)</span> &#123;...&#125;</span><br><span class="line"><span class="keyword">public</span> Factor <span class="title function_">parseFactor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="comment">/*是表达式因子*/</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> parseExprFactor();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="comment">/*是数字*/</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> parseNumFactor();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="comment">/*是变量或幂函数*/</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> parseExpFactor(BigInteger.valueOf(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>最后说句题外话，感觉<strong>递归下降算法</strong>真的很像树上<code>dp</code>算法，都是一边在<code>dfs</code>一边在不停的优化，甚至同样在回溯的时候也可以做一下骚操作<code>(bushi</code>(听说有的同学在回溯的时候顺便把合并同类项给做了<code>orz</code>)</p>
<h4 id="表达式展开"><a href="#表达式展开" class="headerlink" title="表达式展开"></a>表达式展开</h4><p>经过分析，本次作业中表达式展开的最终结果其实是一个多项式的形式——</p>
<script type="math/tex; mode=display">Expr=\sum_1^nbase_i*x^iy^jz^k</script><p>可以发现，<strong>多项式</strong>中含有一系列的<strong>单项式</strong>，每个单项式都是$base_i<em>x^iy^jz^k$这种形式。于是我们不难想到，我们可以再建立两个类——<code>Poly</code>（<strong>多项式类</strong>）和<code>Mono</code>（<em>*单项式类</em></em>）。</p>
<h5 id="Mono（单项式）"><a href="#Mono（单项式）" class="headerlink" title="Mono（单项式）"></a>Mono（单项式）</h5><ul>
<li><p><code>Mono</code>类含有两个成员变量——<code>base</code>和<code>radio</code>，分别代表<strong>系数</strong>和<strong>变量及指数</strong>。然后还有<code>toString()</code>方法，将<code>Mono</code>转化成 <strong>`base*x</strong>exp1<em>y**exp2</em>z<strong>exp3`</strong> 这种形式,由于当时第一次作业不知道后续作业未知量的数量会不会变，所以我选择使用存储<code>ExpFactor</code>的容器radio来存储未知量，<code>ExpFactor</code>存储了变量名，而数组的值为<strong>该变量的幂指数</strong>。<code>Mono</code>中比较重要的是重写的<code>toString()</code>方法和将表达式符号求反的<code>negete()</code>方法。具体里面的其他方法可以看每次作业最前面的<code>UML</code>类图。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Mono.java</span></span><br><span class="line">  <span class="keyword">private</span> <span class="type">BigInteger</span> <span class="variable">base</span> <span class="operator">=</span> BigInteger.valueOf(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> ArrayList&lt;ExpFactor&gt; radio = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<h5 id="Poly（多项式）"><a href="#Poly（多项式）" class="headerlink" title="Poly（多项式）"></a>Poly（多项式）</h5><ul>
<li><code>Poly</code>类有一个<code>ArrayList</code>容器，用来容纳<strong>一系列<code>Mono</code></strong>，此外还有<code>negete()</code>,<code>add()</code>，<code>mul()</code>和<code>pow()</code>等方法来实现多项式的运算,最后有<code>toString()</code>方法<strong>将每个<code>Mono</code>的字符串形式链接起来，形成表达式字符串</strong>，值得一提的是，这部分大家需要谨慎的考虑<strong>浅拷贝和深拷贝</strong>的问题，想清楚再开始，要不然会浪费很多无效时间。<br>例如在实现<code>pow()</code>函数时，我对于次幂的思路是在确定<code>exp</code>非<code>0</code>的情况下使用循环调用<code>mul</code>的方法来实现，这样不可避免的需要保存每个循环<strong>用于乘法的基础量</strong>,此时就要注意一定要对这个变量进行深拷贝，否则在循环之后就会被改变导致结果错误。最后顺便提一嘴，实现深拷贝其实也非常简单，<strong>将每一层的数据进行<code>clone()</code>方法的重写即可</strong>，而且我感觉理论上第一单元的作业全用深拷贝也不会错，只是有点费内存罢了。（评测中其实有关于内存的限制，但我目前还没看到哪位同学因为<code>MLE</code>强测炸过）<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Poly.java</span></span><br><span class="line"><span class="keyword">private</span> ArrayList&lt;Mono&gt; monos;</span><br><span class="line"><span class="comment">//.....</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">negete</span><span class="params">()</span> &#123;...&#125;</span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">add</span><span class="params">(Poly other)</span> &#123;...&#125;</span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">mul</span><span class="params">(Poly other)</span> &#123;...&#125;</span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">pow</span><span class="params">(Poly other)</span> &#123;...&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toStirng</span><span class="params">()</span> &#123;...&#125;</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<p>这样之后，我们就可以在<code>Expr</code>、<code>Term</code>、<code>Factor</code>等类中都写一个<code>toPoly()</code>方法，将类中的内容转化为多项式。然后从<code>factor.toPoly()</code>一步步向上转化，那么最终可以通过<code>expr.toPoly()</code>来获得结果。具体的转化过程如下——</p>
<ul>
<li><p><code>ExpFactor</code>（幂函数因子）的<code>toPoly</code>方法很简单，直接转化为 <strong>只含有一个<code>Mono</code>的<code>Poly</code></strong> 即可。<strong>例如</strong>，因子<code>5</code>可以转化为一个只含有单项式<code>5*constant**1</code>的多项式，因子<code>x**2</code>一个只含有单项式<code>1*x**2</code>的多项式。这里我设置了<strong>字符串“constant”</strong>填充radio位置来转化表示这是一个常数（不能写null会报错）</p>
</li>
<li><p><code>Term</code>类的<code>toPoly()</code>方法是：将该类中含有的所有<code>Factor</code>的<code>Poly</code>形式（即<code>toPoly()</code>的结果）用<code>mul()</code>方法乘起来。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Term.java</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">    	<span class="keyword">for</span> (Factor it : factors) &#123;</span><br><span class="line">          poly = poly.mul(it.toPoly());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!sign) &#123;</span><br><span class="line">          poly.negete();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> poly;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
<p>注意一个细节，因为项是有符号的，<strong>如果该项整体是负的，我们需要把<code>Poly</code>中所有的单项式的系数取反</strong>，这个取反操作我们是通过<code>Poly</code>类中定义的<code>negate()</code>方法实现的。</p>
</li>
<li><p><code>Expr</code>类的<code>toPoly()</code>方法是：将其含有的所有<code>Term</code>的<code>Poly</code>形式（即<code>toPoly()</code>的结果）用<code>add()</code>方法加起来。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Expr.java</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">    	<span class="keyword">for</span> (Term it : terms) &#123;</span><br><span class="line">          poly = poly.add(it.toPoly());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> poly;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>对于<code>exprFactor</code>，因为其包含一个<strong><code>Expr</code>类型的“底”</strong>和一个<strong>int类型的指数</strong>，我们可以通过<code>expr.toPoly()</code>得到 <strong>”底”的多项式形式</strong>，然后使用<code>powPoly()</code>方法展开。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ExprFactor.java</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> base.toPoly().pow(exp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<p>这样，我们就可以通过在每个类中定义的<code>toPoly()</code>方法<strong>自底向上</strong>地得到<strong>表达式的多项式形式</strong>。最后，我们再通过<code>Poly</code>中的<code>toString()</code>方法就可以获得最终展开后的结果。</p>
<p>关于在<code>Poly</code>和<code>Mono</code>实现<code>toString(</code>)这件事上，这部分是想要<strong>卷性能分</strong>的<code>uu</code>们的主战场,所以可以做以下这些优化，当然一定要保证正确分再卷性能分，强测砍人太伤了(这里提醒大家观察一下强测和互测的性价比，强测完胜好吧）。</p>
<ul>
<li>如果单项式系数为<code>0</code>，则最终结果为<code>0</code>,</li>
<li>如果单项式系数为<code>1</code>，则可以省略系数，简化为$radio^n$</li>
<li>如果单项式系数为<code>-1</code>，则可以省略系数，简化为$-radio^n$</li>
<li>如果单项式x的指数为<code>0</code>，则最终结果只输出系数</li>
<li>如果单项式x的指数为<code>1</code>，则指数部分可以省略,简化为$base*radio$</li>
<li>如果单项式x的指数为<code>2</code>,则<code>radio**2</code>可以化简为<code>radio*radio</code>(短了一个字符)</li>
<li>可以使用排序将第一项改为正的，这样可以整体简化减少一个字符。</li>
</ul>
<p>最后分享一个<code>debug</code>小技巧，由于<code>IDEA</code>会对所有重写了<code>toString()</code>方法的变量在调试展示输出，所以我们可以在<code>Expr</code>、<code>Term</code>和各种<code>Factor</code>中重写一下<code>toString()</code>方法，可以大幅度提高<code>debug</code>效率，<strong>增强可视化效果</strong>，而且本身对我们的代码复杂度其实没有任何影响，因为我们在实际使用过程中并不会去调用它。实现起来也很简单，一行即可：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.toPoly().toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>至此<strong>第一次作业</strong>大功告成。</p>
<h3 id="代码复杂度分析"><a href="#代码复杂度分析" class="headerlink" title="代码复杂度分析"></a>代码复杂度分析</h3><p>先来介绍一下下方的几个指标：</p>
<h5 id="方法的衡量指标："><a href="#方法的衡量指标：" class="headerlink" title="方法的衡量指标："></a><strong>方法的衡量指标</strong>：</h5><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">指标</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>CogC(Cognitive complexity)</code>认知复杂度</td>
<td style="text-align:left">衡量一个方法的控制流程有多困难去理解。具有高认知复杂度的方法将难以维护。sonar要求复杂度要在15以下。计算的大致思路是统计方法中控制流程语句的个数</td>
</tr>
<tr>
<td style="text-align:left"><code>ev(G)(essential cyclomatic complexity)</code>方法的基本圈复杂度</td>
<td style="text-align:left">衡量程序非结构化程度的。</td>
</tr>
<tr>
<td style="text-align:left"><code>iv(G) (Design complexity)</code>：设计复杂度</td>
<td style="text-align:left">字面意思，不解释</td>
</tr>
<tr>
<td style="text-align:left"><code>v(G)(cyclomatic complexity)</code>：方法的圈复杂度</td>
<td style="text-align:left">衡量判断模块的复杂度。数值越高说明独立路径越多，测试完备的难度越大</td>
</tr>
</tbody>
</table>
</div>
<h5 id="类的衡量指标："><a href="#类的衡量指标：" class="headerlink" title="类的衡量指标："></a><strong>类的衡量指标</strong>：</h5><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">指标</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>OCavg（Average opearation complexity）</code></td>
<td style="text-align:left">平均操作复杂度</td>
</tr>
<tr>
<td style="text-align:left"><code>OCmax（Maximum operation complexity）</code></td>
<td style="text-align:left">最大操作复杂度</td>
</tr>
<tr>
<td style="text-align:left"><code>WMC（Weighted method complexity）</code></td>
<td style="text-align:left">加权方法复杂度</td>
</tr>
</tbody>
</table>
</div>
<p>这里由于分析太长了，我只展示了<code>Method Metrics</code>部分</p>
<h5 id="Method-Metrics"><a href="#Method-Metrics" class="headerlink" title="Method Metrics"></a><strong>Method Metrics</strong></h5><div class="table-container">
<table>
<thead>
<tr>
<th>Method</th>
<th>CogC</th>
<th>ev(G)</th>
<th>iv(G)</th>
<th>v(G)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Main.inputString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Main.main(String[])</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Main.outputString(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.ExpFactor(BigInteger, String, int)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.getBase()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.getExp()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.getRadio()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.setBase(BigInteger)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExpFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Expr.Expr()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Expr.addTerm(Term)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Expr.toPoly()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>expr.Expr.toString()</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>expr.ExprFactor.ExprFactor(Expr, int)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExprFactor.getBase()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExprFactor.getExp()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.ExprFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Term.Term()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Term.addFactor(Factor)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Term.setSign(boolean)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>expr.Term.toPoly()</td>
<td>7</td>
<td>1</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td>expr.Term.toString()</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.Lexer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Lexer.getAcquire()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Lexer.getNext()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.getNumber()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.getPre()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.getTerm()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.isOp(String)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.isTerm(char)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.negete(String)</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.next()</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.present()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.printLexer()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.trans(String)</td>
<td>24</td>
<td>7</td>
<td>14</td>
<td>14</td>
</tr>
<tr>
<td>parser.Parser.Parser(Lexer)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Parser.parseExpr()</td>
<td>6</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>parser.Parser.parseFactor()</td>
<td>31</td>
<td>9</td>
<td>18</td>
<td>18</td>
</tr>
<tr>
<td>parser.Parser.parseTerm(boolean)</td>
<td>5</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>poly.Mono.add(Mono)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.getBase()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.getRadio()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.negete()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revert(String, int, boolean)</td>
<td>40</td>
<td>14</td>
<td>12</td>
<td>18</td>
</tr>
<tr>
<td>poly.Mono.setBase(BigInteger)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.setRadio(ArrayList<ExpFactor>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.toString()</td>
<td>7</td>
<td>2</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td>poly.Poly.Poly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.Poly(Poly)</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.add(Poly)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.changeToExp()</td>
<td>10</td>
<td>3</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>poly.Poly.cmp(ExpFactor, ExpFactor)</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.equal(Mono, Mono)</td>
<td>9</td>
<td>4</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td>poly.Poly.getMonos()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.mul(Mono, Mono)</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.mul(Poly)</td>
<td>7</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>poly.Poly.negete()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Poly.pow(int)</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.setMonos(ArrayList<Mono>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.simplify()</td>
<td>8</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>poly.Poly.toString()</td>
<td>10</td>
<td>4</td>
<td>6</td>
<td>7</td>
</tr>
</tbody>
</table>
</div>
<p>从代码复杂度分析数据可以看到，大多数方法的复杂度在合理范围之内，而有四个方法<strong>复杂度超标</strong>.</p>
<ul>
<li><code>Lexer</code>类中的<code>trans()</code>方法使用了<code>if-else</code>对表达式的语法单元进行解析，因此<strong>结构非常冗杂</strong>，导致代码量暴增。</li>
<li>再<code>Parser</code>类中的<code>parseFactor()</code>方法里，我们需要<strong>先判断当前解析的因子的类型</strong>,然后<strong>再根据因子的类型分别进行解析</strong>，这样也导致了代码复杂度较高。在作业2中，我为每一种因子的解析都<strong>单独封装了一个方法</strong>(其实上文也提到过，但在实际操作时第一次作业没有实现），然后在<code>parseFactor()</code>中调用这些方法。这样既可以减少<code>parseFactor()</code>方法的复杂度，也<strong>提高了代码可读性</strong>。</li>
<li><code>Mono</code>类中<code>toString()</code>方法<strong>在生成单项式的字符串形式时</strong>，需要针对对每一种特定的情况进行优化，免不了使用大量的<code>if-else</code>语句进行特判，复杂度高也在所难免。</li>
<li>还有几个复杂度比较高的是用于实现<strong>合并同类项</strong>而编写的类，这几个复杂度高没啥好方法解决，毕竟<strong>性能和效率不可兼得</strong>。</li>
</ul>
<hr>
<h2 id="hw2分析"><a href="#hw2分析" class="headerlink" title="hw2分析"></a>hw2分析</h2><p>第二次作业在第一次的基础上增加了<strong>三角函数因子</strong>和<strong>自定义函数因子</strong>，复杂度进一步提高。</p>
<h3 id="文法规则-1"><a href="#文法规则-1" class="headerlink" title="文法规则"></a>文法规则</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/BNF_hw2"
                      alt="image-20230309202701894"
                ></p>
<h3 id="代码UML类图-1"><a href="#代码UML类图-1" class="headerlink" title="代码UML类图"></a>代码<code>UML</code>类图</h3><p>本次作业代码的<code>UML</code>类图如下所示</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/hw2.png"
                      alt=""
                ></p>
<h3 id="代码架构分析-1"><a href="#代码架构分析-1" class="headerlink" title="代码架构分析"></a>代码架构分析</h3><p>第一次作业到第二次作业的跨度比较大，主要时在可以嵌套括号的基础上添加了<strong>三角函数因子</strong>和<strong>自定义函数因子</strong>，但是<strong>递归下降方法可以继续沿用</strong>，在第一次架构很好的情况下只需要简单修改就可以完成了。</p>
<h4 id="三角函数的解析"><a href="#三角函数的解析" class="headerlink" title="三角函数的解析"></a>三角函数的解析</h4><p>对于<strong>三角函数的解析</strong>，我选择建立了<code>TriFactor</code>类来统一处理三角函数，类中有四个成员变量——<code>sign</code>(表示该三角函数的正负）,<code>factor</code>(表示三角函数括号内的因子)，<code>type</code>（判断该三角函数的类型）,<code>exp</code>(表示三角函数的指数部分)</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sinFactor.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> sign;</span><br><span class="line"><span class="keyword">private</span> Factor factor; <span class="comment">//三角函数括号内的因子</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> type;</span><br><span class="line"><span class="comment">// sin-&gt; 1 ,cos-&gt; 0</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> exp; <span class="comment">//三角函数的指数部分</span></span><br></pre></td></tr></table></figure></div>
<p>为解析三角函数，我们在<code>parser</code>类中设置了一个<code>parserTriFactor()</code>方法，该方法在<code>parseFactor()</code>中被调用。<strong>解析逻辑是</strong>，当我们在<code>parseFactor()</code>中发现当前解析的因子为<code>sin</code>或者<code>cos</code>时，我们就可以调用<code>parserTriFactor()</code>方法，先将三<strong>角函数括号内的因子</strong>进行解析（即在该方法中再调用<code>parseFactor()</code>方法），然后解析该<strong>三角函数的指数</strong>，最后将解析结果保存到一个<code>TriFactor</code>对象中返回即可。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Paser.java</span></span><br><span class="line"><span class="keyword">private</span> Factor <span class="title function_">parseTriFactor</span><span class="params">(String str)</span> &#123;</span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">sign</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (lexer.present().equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.equals(<span class="string">&quot;sin&quot;</span>)) &#123;</span><br><span class="line">            sign = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        lexer.next();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (lexer.present().equals(<span class="string">&quot;+&quot;</span>)) &#123;</span><br><span class="line">        lexer.next();</span><br><span class="line">    &#125;<span class="comment">//判断正负号sign</span></span><br><span class="line">    <span class="type">Factor</span> <span class="variable">factor</span> <span class="operator">=</span> parseFactor();</span><br><span class="line">    flag = lexer.next();</span><br><span class="line">    <span class="type">int</span> <span class="variable">exp</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag &amp;&amp; lexer.present().equals(<span class="string">&quot;**&quot;</span>)) &#123;</span><br><span class="line">        flag = lexer.next();</span><br><span class="line">        <span class="keyword">while</span> (!Character.isDigit(lexer.present().charAt(<span class="number">0</span>))) &#123;</span><br><span class="line">            lexer.next();</span><br><span class="line">        &#125;</span><br><span class="line">        exp = Integer.parseInt(lexer.present());</span><br><span class="line">        flag = lexer.next();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">type</span> <span class="operator">=</span> str.equals(<span class="string">&quot;sin&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TriFactor</span>(sign, factor, type, exp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里为了防止<code>lexer</code>读到结尾造成<strong>空指针</strong>，我用<code>flag</code>接收了<code>lexer.next()</code>的返回值，这样在<strong>判断指数时加入，就可以有效防止空指针的出现</strong>。</p>
<p>在之后的表达式化简过程中，有一个很让人烦恼的考点——<strong>重写</strong><code>hashcode</code>和<code>equals</code>方法，这样是为了处理<strong>三角函数的合并同类项问题</strong>，由于诱导公式等问题的存在，要想达到很好的效果，我们需要对三角函数因子中断表达式因子内的项进行<strong>排序</strong>，还有处理负号等一对小问题（如果不卷性能分这些烦恼全部一笔勾销<code>qwq</code>），这里给出一个小技巧——可以将<code>Poly</code>转化为<code>toString</code>作为它的键，因为对于某个字符串而言，只要串相同是不存在引用不同的问题，就可以巧妙规避了重写<code>hashcode</code>的烦恼问题，甚至粗略计算似乎比重写<code>HashCode</code>在数据量较小的情况下甚至可以起到更好的效果，毕竟只有150个字符左右，循环还是比递归效率高的。下面是<code>sort</code>函数的写法和一处调用的示例(<code>lambda</code>表达式<code>yyds</code>)。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Poly <span class="title function_">mul</span><span class="params">(Poly polys)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.getMonos().isEmpty()) &#123;</span><br><span class="line">        polys.sort();</span><br><span class="line">        <span class="keyword">return</span> polys;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">Poly</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">        <span class="type">Poly</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(<span class="built_in">this</span>);</span><br><span class="line">        <span class="keyword">for</span> (Mono mo : res.getMonos()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Mono poly : polys.getMonos()) &#123;</span><br><span class="line">                tmp.getMonos().add(mul(mo, poly));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp.sort();</span><br><span class="line">        <span class="keyword">return</span> tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getMonos().sort((o1, o2) -&gt; o2.toString().compareTo(o1.toString()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="自定义函数的定义和解析"><a href="#自定义函数的定义和解析" class="headerlink" title="自定义函数的定义和解析"></a>自定义函数的定义和解析</h4><p>第二次迭代关于<strong>自定义函数</strong>有两种处理方式，第一种是<strong>存储函数名和形参的对应表，之后在正式读入时使用正则表达式作为符号替换处理</strong>，简而言之就是字符串替换，第二种是在实际操作时作为符号解析式<strong>重新调用新的<code>lexer</code>、<code>parser</code>函数等直接返回表达式并于原来的表达式合并</strong>，所以后者鲁棒性更强,当然难度也更大。具体两种实现而言，主要存在于下方<code>newFunc</code>的写法区别，在此只聊思路，不具体展开。</p>
<p>首先，我新建了一个<code>FuncFactor</code>类，成员变量有——<code>newFunc</code>和<code>expr</code>，用于封装自定义函数类型的对象</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//FuncFactor.java</span></span><br><span class="line"><span class="keyword">private</span> String newFunc; <span class="comment">//将函数实参带入形参位置后的结果(字符串形式)</span></span><br><span class="line"><span class="keyword">private</span> Expr expr; <span class="comment">//将newFunc解析成表达式后的结果</span></span><br></pre></td></tr></table></figure></div>
<p>为了便于<strong>自定义函数的定义和解析</strong>，我还新建了一个工具类<code>Definer</code>,主要处理<strong>自定义函数的定义和调用</strong>。该函数的成员和方法都是静态的，意味着我们<strong>不需要实例化对象</strong>，直接通过类名即可调用。</p>
<ul>
<li><p>该函数有两个主要的私有静态成员<code>funcMap</code>和<code>paraMap</code>,两者都是<code>HashMap</code>类型，前者可以通过函数名（f/g/h）来获得函数的定义式，后者可以通过函数名来获得该函数的形参列表（x/y/z）。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Definer.java</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, String&gt; funcMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, ArrayList&lt;String&gt;&gt; paraMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>该类有两个主要函数——<code>addFunc()</code>和<code>callFunc()</code>，分别用于加入函数列表和进行形参和实参的呼唤。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Definer.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addFunc</span><span class="params">(String input)</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">callFunc</span><span class="params">(String name, ArrayList&lt;Boolean&gt; signs，ArrayList&lt;Factor&gt; paras)</span> &#123;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>前者是在函数定义时使用，将终端输入的函数表达式传入该函数并进行解析（主要通过<strong>正则表达式</strong>），并<strong>将该函数的定义式和形参列表分别加入<code>funcMap</code>和<code>paraMap</code></strong>。</li>
<li>后者是在函数调用时使用，传入的参量是函数名<code>name</code>、实参符号列表<code>signs</code>和实参列表<code>paras</code>(这里是由于我的实现是以项为基本的符号单位的，而自定义函数的各个变量都是以因子为基本单位，所以我需要额外传递一个符号列表）。该函数的逻辑是——首先根据<code>name</code>获得<strong>函数定义式和行参列表</strong>，根据<strong>形参列表</strong>和<strong>实参列表</strong>的对应关系建立一个映射<code>map</code>。然后<strong>遍历一遍字符串</strong>，根据映射关系将函数定义式中的<strong>形参</strong>替换成 <strong>实参的字符串形式</strong>(实参传入时是<code>Factor</code>类型,直接调用其<code>toString()</code>方法即可)</li>
</ul>
</li>
</ul>
<p>有了工具类<code>Definer</code>提供的<code>buff</code>加成，我们接下来就可以轻松的进行自定义函数的解析了。<br>首先还是先在<code>parser</code>类中设置了一个<code>parseFuncFactor()</code>方法，<strong>解析逻辑是</strong>先解析函数名，然后解析所有的实参（因为实参是<code>Factor</code>类型，因此还是直接调用<code>parseFactor()</code>），最后将结果封装在<code>FuncFactor</code>对象中返回即可。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parser.java</span></span><br><span class="line"><span class="keyword">private</span> Factor <span class="title function_">parseFuncFactor</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    ArrayList&lt;Factor&gt; paras = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    ArrayList&lt;Boolean&gt; signs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    flag = lexer.next();</span><br><span class="line">    <span class="keyword">if</span> (lexer.isOp(lexer.present())) &#123;</span><br><span class="line">        signs.add(lexer.present().equals(<span class="string">&quot;+&quot;</span>));</span><br><span class="line">        lexer.next();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        signs.add(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    paras.add(parseFactor());</span><br><span class="line">    <span class="keyword">while</span> (!lexer.present().equals(<span class="string">&quot;)&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (lexer.isOp(lexer.present())) &#123;</span><br><span class="line">            signs.add(lexer.present().equals(<span class="string">&quot;+&quot;</span>));</span><br><span class="line">            lexer.next();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            signs.add(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        paras.add(parseFactor());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FuncFactor</span>(name, signs, paras);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>此时我们只把<strong>函数名和实参</strong>解析出来，还没有对<strong>函数表达式</strong>进行解析。剩下的解析过程在<code>FuncFactor</code>类的构造方法中实现——</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//FuncFactor.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">FuncFactor</span><span class="params">(String name, ArrayList&lt;Boolean&gt; signs, ArrayList&lt;Factor&gt; paras)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.newFunc = Definer.callFunc(name, signs, paras);</span><br><span class="line">    <span class="built_in">this</span>.expr = setExpr();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Expr <span class="title function_">setExpr</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Lexer</span> <span class="variable">lexer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lexer</span>(newFunc);</span><br><span class="line">    <span class="type">Parser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parser</span>(lexer);</span><br><span class="line">    <span class="keyword">return</span> parser.parseExpr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>在<strong>构造函数</strong>中，我们通过工具类<code>Definer</code>中的<code>callFunc()</code>方法，获得了<strong>带入实参后的表达式的字符串形式</strong><code>newFunc</code>，然后用本类中的私有方法<code>setExpr()</code>将<code>newFunc</code>解析成了<code>Expr</code>（同样需要使用<code>Lexer</code>和<code>Paser</code>)</p>
<p>至此，<strong>自定义函数的解析</strong>也圆满结束了。</p>
<h4 id="表达式展开-1"><a href="#表达式展开-1" class="headerlink" title="表达式展开"></a>表达式展开</h4><p>将新加入的几种<code>Factor</code>解析完后，终于到了最后一步——<strong>表达式展开</strong>。我继续沿用第一次作业中<code>Mono</code>和<code>Poly</code>的形式，但是需要做一些修改，因为本次作业中多项式最小单元变成了——</p>
<script type="math/tex; mode=display">Expr=\sum_1^nbase_i*x^iy^jz^k\prod sin\prod cos</script><p>所以我们在Mono中也要作出对应的修改。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Mono.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">BigInteger</span> <span class="variable">base</span> <span class="operator">=</span> BigInteger.valueOf(<span class="number">0</span>);<span class="comment">//系数</span></span><br><span class="line"><span class="keyword">private</span> ArrayList&lt;ExpFactor&gt; radio = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();<span class="comment">//参数表</span></span><br><span class="line"><span class="keyword">private</span> HashMap&lt;Poly, Integer&gt; sinMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();<span class="comment">//所有sin括号里的内容及其指数</span></span><br><span class="line"><span class="keyword">private</span> HashMap&lt;Poly, Integer&gt; cosMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();<span class="comment">//所有cos括号里的内容及其指数</span></span><br></pre></td></tr></table></figure></div>
<p><code>base</code>和<code>radio</code>都和第一次作业相关架构相同，<code>sinMap</code>和<code>cosMap</code>是新加入的部分，用来存储这个最小单元的三角函数。<code>Hashmap</code>的key是<strong>三角函数括号里的表达式</strong>，value是<strong>三角函数指数</strong>,这样再稍微调整一下<strong>各个数据类的<code>toPoly()</code>方法</strong>的实现，就可以得到最终的结果了。</p>
<h3 id="代码复杂度分析-1"><a href="#代码复杂度分析-1" class="headerlink" title="代码复杂度分析"></a>代码复杂度分析</h3><h5 id="Method-Metrics-1"><a href="#Method-Metrics-1" class="headerlink" title="Method Metrics"></a><strong>Method Metrics</strong></h5><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">Method</th>
<th style="text-align:center">CogC</th>
<th>ev(G)</th>
<th>iv(G)</th>
<th>v(G)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">factor.ExpFactor.ExpFactor(BigInteger, String, int)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExpFactor.getBase()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExpFactor.getExp()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExpFactor.getRadio()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExpFactor.toPoly()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExpFactor.toString()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Expr.Expr()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Expr.addTerm(Term)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Expr.toPoly()</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">factor.Expr.toString()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExprFactor.ExprFactor(Expr, int)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExprFactor.toPoly()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.ExprFactor.toString()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.FuncFactor.FuncFactor(String, ArrayList<Boolean>, ArrayList<Factor>)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.FuncFactor.setExpr()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.FuncFactor.toPoly()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Term.Term()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Term.addFactor(Factor)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Term.setSign(boolean)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.Term.toPoly()</td>
<td style="text-align:center">2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">factor.Term.toString()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.TriFactor.TriFactor(boolean, Factor, boolean, int)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">factor.TriFactor.toPoly()</td>
<td style="text-align:center">25</td>
<td>1</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td style="text-align:left">factor.TriFactor.toString()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.Lexer(String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getAcquire()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getNext()</td>
<td style="text-align:center">1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getNumber()</td>
<td style="text-align:center">2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getPre()</td>
<td style="text-align:center">1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getTerm()</td>
<td style="text-align:center">2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.getTriType()</td>
<td style="text-align:center">2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.isOp(String)</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.isTerm(char)</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.isUnknown(char)</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.negete(String)</td>
<td style="text-align:center">2</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.next()</td>
<td style="text-align:center">1</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.present()</td>
<td style="text-align:center">1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.printLexer()</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">parser.Lexer.trans(String)</td>
<td style="text-align:center">27</td>
<td>7</td>
<td>18</td>
<td>18</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.Parser(Lexer)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseExpFactor(BigInteger)</td>
<td style="text-align:center">4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseExpr()</td>
<td style="text-align:center">6</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseExprFactor()</td>
<td style="text-align:center">4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseFactor()</td>
<td style="text-align:center">6</td>
<td>6</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseFuncFactor(String)</td>
<td style="text-align:center">6</td>
<td>1</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseNumFactor()</td>
<td style="text-align:center">4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseTerm(boolean)</td>
<td style="text-align:center">5</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td style="text-align:left">parser.Parser.parseTriFactor(String)</td>
<td style="text-align:center">8</td>
<td>1</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Definer.addFunc(String)</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">poly.Definer.callFunc(String, ArrayList<Boolean>, ArrayList<Factor>)</td>
<td style="text-align:center">8</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td style="text-align:left">poly.Definer.simplify(String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.checkPoly(Poly)</td>
<td style="text-align:center">4</td>
<td>1</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.getBase()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.getCosMap()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.getRadio()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.getSinMap()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.negete()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revert(String, int, boolean)</td>
<td style="text-align:center">40</td>
<td>14</td>
<td>12</td>
<td>18</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTri(String)</td>
<td style="text-align:center">34</td>
<td>1</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriNoStar(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriNoStarExpCos(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriNoStarExpSin(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriStar(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriStarExpCos(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.revertTriStarExpSin(StringBuilder, Poly, String)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.setBase(BigInteger)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.setCosMap(HashMap<Poly, Integer>)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.setSinMap(HashMap<Poly, Integer>)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Mono.toString()</td>
<td style="text-align:center">19</td>
<td>2</td>
<td>22</td>
<td>23</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.Poly()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.Poly(Poly)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.add(Poly)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.changeToExp()</td>
<td style="text-align:center">10</td>
<td>3</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.changeTri(Mono)</td>
<td style="text-align:center">16</td>
<td>5</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.cmp(ExpFactor, ExpFactor)</td>
<td style="text-align:center">2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.equal(Mono, Mono)</td>
<td style="text-align:center">10</td>
<td>4</td>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.getMonos()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.isSame(HashMap<Poly, Integer>, HashMap<Poly, Integer>)</td>
<td style="text-align:center">10</td>
<td>4</td>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.mul(Mono, Mono)</td>
<td style="text-align:center">2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.mul(Poly)</td>
<td style="text-align:center">7</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.negete()</td>
<td style="text-align:center">1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.pow(int)</td>
<td style="text-align:center">2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.setMonos(ArrayList<Mono>)</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.simplify()</td>
<td style="text-align:center">11</td>
<td>1</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.sort()</td>
<td style="text-align:center">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.toString()</td>
<td style="text-align:center">10</td>
<td>4</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td style="text-align:left">poly.Poly.triMul(Mono, Mono)</td>
<td style="text-align:center">8</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
<p>不难发现，这次<strong>复杂方法重灾区</strong>主要集中在<code>Mono</code>类和<code>Poly</code>类中，分析原因，主要是因为<code>Mono</code>类中增加了<code>sin</code>,<code>cos</code>等新的数据成员，导致在<strong>输出时判断逻辑更为复杂</strong>，同时也直接导致了<code>Poly</code>类中进行<code>add</code>和<code>mul</code>运算时进行的操作也更为复杂,所以我尽可能的将这部分拆解开来，以尽可能的降低时间开销和解耦合。</p>
<p>顺便提一句，其实第二次作业在三角函数方面有很多<strong>优化空间</strong>，例如<strong>平方和和二倍角公式</strong>，但我由于时间和性价比问题并没有去尝试，当然如果加上了，我的代码复杂度可能真的会爆掉（毕竟本身差点<code>TLE</code>了）。</p>
<hr>
<h2 id="hw3分析"><a href="#hw3分析" class="headerlink" title="hw3分析"></a>hw3分析</h2><p>第三次作业加入了<strong>自定义函数的相互嵌套</strong>，并加入了<strong>导数因子</strong>的概念。</p>
<h3 id="文法规则-2"><a href="#文法规则-2" class="headerlink" title="文法规则"></a>文法规则</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/BNF_hw3"
                      alt="image-20230309202747141"
                ></p>
<h3 id="代码UML类图-2"><a href="#代码UML类图-2" class="headerlink" title="代码UML类图"></a>代码UML类图</h3><p>本次作业代码的<code>UML</code>类图如下所示</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/hw3.png"
                      alt="img"
                ></p>
<h3 id="代码架构分析-2"><a href="#代码架构分析-2" class="headerlink" title="代码架构分析"></a>代码架构分析</h3><h4 id="自定义函数嵌套"><a href="#自定义函数嵌套" class="headerlink" title="自定义函数嵌套"></a>自定义函数嵌套</h4><p>为了实现<strong>自定义函数的互相嵌套</strong>（其实是为了补第二次迭代偷懒的坑），我将自定义函数的解析方式从字符串替换改成了表达式解析，从而完成了对自定义函数嵌套的需要,除此之外，在自定义函数定义过程中我们还需要处理<strong>求导因子</strong>的相关操作。</p>
<p>具体就是在<code>Definer</code>中假如了<code>changeFunc()</code>函数，从而像<code>parser</code>那样在遇到<strong>自定义函数名</strong>和<strong>求导因子</strong>时分别解析即可，下面是只保留了解析部分原理的代码。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">changeFunc</span><span class="params">(String operation)</span> &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> operation.length();</span><br><span class="line">       <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span> (FuncMap.get(String.valueOf(operation.charAt(i))) != <span class="literal">null</span>) &#123;</span><br><span class="line">               <span class="comment">//处理自定义函数因子</span></span><br><span class="line">               <span class="comment">//</span></span><br><span class="line">               <span class="type">Lexer</span> <span class="variable">lexer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lexer</span>(sbn.toString());</span><br><span class="line">               <span class="type">Parser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parser</span>(lexer);</span><br><span class="line">               sb.append(<span class="string">&quot;(&quot;</span>).append(parser.parseFuncFactor(op).toPoly().toString()).append(<span class="string">&quot;)&quot;</span>);</span><br><span class="line">               <span class="comment">//</span></span><br><span class="line">           &#125; <span class="keyword">else</span> <span class="keyword">if</span> (operation.charAt(i) == <span class="string">&#x27;d&#x27;</span>) &#123;</span><br><span class="line">               <span class="comment">//处理导数因子</span></span><br><span class="line">               <span class="comment">//</span></span><br><span class="line">               <span class="type">Lexer</span> <span class="variable">lexer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lexer</span>(sbn.toString());</span><br><span class="line">               <span class="type">Parser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parser</span>(lexer);</span><br><span class="line">               <span class="type">Expr</span> <span class="variable">expr</span> <span class="operator">=</span> parser.parseExpr();</span><br><span class="line">               sb.append(<span class="string">&quot;(&quot;</span>).append(expr.toDer(op).toPoly().simplify()).append(<span class="string">&quot;)&quot;</span>);</span><br><span class="line">               <span class="comment">//</span></span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               sb.append(operation.charAt(i));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>之后在和同学们讨论的过程中我想到，因为我们通过<strong>第二次作业的设计</strong>，其实自定义函数带入这个功能已经帮我们实现过了，所以我们并不需要<strong>重复造轮子</strong>，直接重新使用即可，即上面几行代码可以用下面这样的<strong>简化形式</strong>代替。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">changeFunc</span><span class="params">(String operation)</span> &#123;</span><br><span class="line">    <span class="type">Lexer</span> <span class="variable">lexer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lexer</span>(operation);</span><br><span class="line">    <span class="type">Parser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parser</span>(lexer);</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> parser.parseExpr().toPoly().simplify().toString();</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="导数因子的定义与解析"><a href="#导数因子的定义与解析" class="headerlink" title="导数因子的定义与解析"></a>导数因子的定义与解析</h4><p>对于<strong>导数因子的解析</strong>，我选择创造了<code>DerFactor</code>这个类来进行导数多项式的存储，这个类只有一个成员变量<code>Poly</code>型的<code>derivation</code>来存储求导完成后的多项式，之后只需要在调用<code>toPoly()</code>方法时将<strong>各部分返回</strong>回去即可。简要代码如下：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DerFactor.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DerFactor</span> <span class="keyword">implements</span> <span class="title class_">Factor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Poly derivation;</span><br><span class="line">    <span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.derivation;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>之后我们根据获得的表达式分别调用相关的求导函数即可，即为各个<code>Factor</code>，<code>Poly</code>和<code>Mono</code>分别编写一个<code>toDer(radio)</code>方法，其中传入<code>radio</code>为求偏导时所用的偏量。各种求导函数编写按照求导规则即可。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DerFactor.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">DerFactor</span><span class="params">(Expr origin, <span class="type">int</span> exp, String op)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.derivation = derCheck(origin, exp, op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Poly <span class="title function_">derCheck</span><span class="params">(Expr origin, <span class="type">int</span> exp, String radio)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ExprFactor</span>(origin, exp).toPoly().toDer(radio);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p><strong>可能用到的求导公式有：</strong></p>
<p>Ⅰ.当$f(x)=c$（<em>c</em>为常数）时，$f′(x)=0$</p>
<p>Ⅱ.当$f(x)=x^n$时，$f′(x)=nx^{n−1}$</p>
<p>Ⅲ.当$f(x)=sin(x)$时，$f′(x)=cos(x)$</p>
<p>Ⅳ.当$f(x)=cos(x)$时，$f′(x)=−sin(x)$</p>
<p>Ⅴ.链式法则：$[f(g(x))]′=f′(g(x))g′(x)$</p>
<p>Ⅵ.乘法法则：$[f(x)g(x)]′=f′(x)g(x)+f(x)g′(x)$</p>
</blockquote>
<p>这里给出我处理三角函数求导的部分来简要提示即可(相对比较容易出错）。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Expr <span class="title function_">toDer</span><span class="params">(String radio)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (type) &#123;</span><br><span class="line">        <span class="keyword">return</span> sinToDer(radio);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cosToDer(radio);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Expr <span class="title function_">cosToDer</span><span class="params">(String radio)</span> &#123;</span><br><span class="line">    <span class="type">Term</span> <span class="variable">term</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Term</span>();</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">ExpFactor</span>(BigInteger.valueOf(exp), <span class="string">&quot;constant&quot;</span>, <span class="number">1</span>));</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">TriFactor</span>(<span class="literal">true</span>, factor, <span class="literal">false</span>, exp - <span class="number">1</span>));</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">TriFactor</span>(<span class="literal">false</span>, factor, <span class="literal">true</span>, <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> Definer.merge(term, (factor.toDer(radio)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Expr <span class="title function_">sinToDer</span><span class="params">(String radio)</span> &#123;</span><br><span class="line">    <span class="type">Term</span> <span class="variable">term</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Term</span>();</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">ExpFactor</span>(BigInteger.valueOf(exp), <span class="string">&quot;constant&quot;</span>, <span class="number">1</span>));</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">TriFactor</span>(<span class="literal">true</span>, factor, <span class="literal">true</span>, exp - <span class="number">1</span>));</span><br><span class="line">    term.addFactor(<span class="keyword">new</span> <span class="title class_">TriFactor</span>(<span class="literal">true</span>, factor, <span class="literal">false</span>, <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> Definer.merge(term, (factor.toDer(radio)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="代码复杂度分析-2"><a href="#代码复杂度分析-2" class="headerlink" title="代码复杂度分析"></a>代码复杂度分析</h3><h5 id="Method-Metrics-2"><a href="#Method-Metrics-2" class="headerlink" title="Method Metrics"></a><strong>Method Metrics</strong></h5><div class="table-container">
<table>
<thead>
<tr>
<th>Method</th>
<th>CogC</th>
<th>ev(G)</th>
<th>iv(G)</th>
<th>v(G)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Main.inputLexer()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Main.inputString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Main.main(String[])</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>Main.outputString(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.DerFactor.DerFactor(Expr, int, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.DerFactor.derCheck(Expr, int, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.DerFactor.toDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.DerFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.ExpFactor(BigInteger, String, int)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.getBase()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.getExp()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.getRadio()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.toDer(String)</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>factor.ExpFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExpFactor.toString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Expr.Expr()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Expr.add(Expr)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>factor.Expr.addTerm(Term)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Expr.getTerms()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Expr.toDer(String)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>factor.Expr.toPoly()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>factor.Expr.toString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExprFactor.ExprFactor(Expr, int)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExprFactor.toDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExprFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.ExprFactor.toString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.FuncFactor.FuncFactor(String, ArrayList<Boolean>, ArrayList<Factor>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.FuncFactor.setExpr()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.FuncFactor.toDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.FuncFactor.toPoly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.Term()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.addFactor(Factor)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.getFactors()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.isSign()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.setSign(boolean)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.Term.toDer(String)</td>
<td>11</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>factor.Term.toPoly()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>factor.Term.toString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.TriFactor.TriFactor(boolean, Factor, boolean, int)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.TriFactor.cosToDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.TriFactor.sinToDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>factor.TriFactor.toDer(String)</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>factor.TriFactor.toPoly()</td>
<td>25</td>
<td>1</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td>factor.TriFactor.toString()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Lexer.Lexer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Lexer.getAcquire()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Lexer.getNext()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.getNumber()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.getPre()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.getTerm()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.getTriType()</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.isOp(String)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.isTerm(char)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.isUnknown(char)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>parser.Lexer.negete(String)</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.next()</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.present()</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.printLexer()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>parser.Lexer.trans(String)</td>
<td>27</td>
<td>7</td>
<td>18</td>
<td>18</td>
</tr>
<tr>
<td>parser.Parser.Parser(Lexer)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>parser.Parser.parseDerFactor()</td>
<td>4</td>
<td>1</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>parser.Parser.parseExpFactor(BigInteger)</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>parser.Parser.parseExpr()</td>
<td>6</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>parser.Parser.parseExprFactor()</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>parser.Parser.parseFactor()</td>
<td>7</td>
<td>7</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<td>parser.Parser.parseFuncFactor(String)</td>
<td>6</td>
<td>1</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>parser.Parser.parseNumFactor()</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>parser.Parser.parseTerm(boolean)</td>
<td>5</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>parser.Parser.parseTriFactor(String)</td>
<td>8</td>
<td>1</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td>poly.Definer.addFunc(String)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Definer.callFunc(String, ArrayList<Boolean>, ArrayList<Factor>)</td>
<td>8</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>poly.Definer.changeFunc(String)</td>
<td>21</td>
<td>1</td>
<td>8</td>
<td>10</td>
</tr>
<tr>
<td>poly.Definer.isTerm(char)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>poly.Definer.isUnknown(char)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>poly.Definer.merge(Expr, Expr)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Definer.merge(Factor, Expr)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Definer.merge(Term, Expr)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Definer.simplify(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.checkPoly(Poly)</td>
<td>4</td>
<td>1</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td>poly.Mono.getBase()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.getCosMap()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.getRadio()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.getSinMap()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.negete()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revert(String, int, boolean)</td>
<td>40</td>
<td>14</td>
<td>12</td>
<td>18</td>
</tr>
<tr>
<td>poly.Mono.revertTri(String)</td>
<td>34</td>
<td>1</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>poly.Mono.revertTriNoStar(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revertTriNoStarExpCos(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revertTriNoStarExpSin(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revertTriStar(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revertTriStarExpCos(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.revertTriStarExpSin(StringBuilder, Poly, String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.setBase(BigInteger)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.setCosMap(HashMap<Poly, Integer>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.setSinMap(HashMap<Poly, Integer>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.toDer(String)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Mono.toString()</td>
<td>19</td>
<td>2</td>
<td>22</td>
<td>23</td>
</tr>
<tr>
<td>poly.Poly.Poly()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.Poly(Poly)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.add(Poly)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.changeToExp()</td>
<td>10</td>
<td>3</td>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>poly.Poly.changeTri(Mono)</td>
<td>16</td>
<td>5</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<td>poly.Poly.cmp(ExpFactor, ExpFactor)</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.equal(Mono, Mono)</td>
<td>10</td>
<td>4</td>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td>poly.Poly.getMonos()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.isSame(HashMap<Poly, Integer>, HashMap<Poly, Integer>)</td>
<td>10</td>
<td>4</td>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td>poly.Poly.mul(Mono, Mono)</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.mul(Poly)</td>
<td>7</td>
<td>2</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>poly.Poly.negete()</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Poly.pow(int)</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>poly.Poly.setMonos(ArrayList<Mono>)</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.simplify()</td>
<td>11</td>
<td>1</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td>poly.Poly.sort()</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>poly.Poly.toDer(String)</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>poly.Poly.toString()</td>
<td>10</td>
<td>4</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td>poly.Poly.triMul(Mono, Mono)</td>
<td>8</td>
<td>1</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
<p>新加入的<strong>导数因子</strong>和<strong>Definer新定义的方法</strong>的复杂度都不是很高，可以接受，就此完成了第一单元的迭代工作，撒花！！！</p>
<hr>
<p>就此第一单元各部分细节介绍完毕，下面这一部分是对于其他内容的一些<strong>所思所感</strong>，在此与大家分享。</p>
<h2 id="作业总结与感悟"><a href="#作业总结与感悟" class="headerlink" title="作业总结与感悟"></a>作业总结与感悟</h2><h3 id="关于课程"><a href="#关于课程" class="headerlink" title="关于课程"></a>关于课程</h3><p>伴随着我们<code>OO</code>第一单元作业还有我们第一单元的理论课课程，这一单元的理论课重点在于讲解了如何进行<strong>层次化编程</strong>，并介绍了面向对象很入门的知识点——<strong>继承与接口</strong>。与第一单元作业相对应的是我们第一单元作业用到了接口的知识,在第一单元多次用到的<code>Factor</code>的相关知识相信大家依然记忆犹新。</p>
<h4 id="研讨课收获"><a href="#研讨课收获" class="headerlink" title="研讨课收获"></a>研讨课收获</h4><p>在第三次研讨课我们收获到了关于SOLID的原则的一些概念，就简单介绍一下，并说一说我的感受吧。</p>
<blockquote>
<p>OO的五大原则是指<br>|原则|含义|感受|<br>|:—|:—|:—|<br>|SRP（Single Responsibility Principle 单一职责原则） |单一职责很容易理解，所谓单一职责，就是一个设计元素只做一件事。（单一职责）| 如果不满足单一职责，可能一方面造成耦合性比较强，不利于拓展，也会导致代码冗长可读性较差。|<br>|OCP （Open Close Principle 开闭原则）| 一句话：“Closed for Modification; Open for Extension”——“对变更关闭；对扩展开放”。(可拓展性)| 对拓展开放，对修改封闭。尽可能不要动之前的代码，好的架构在拓展时不需要大改代码。而拓展性的重要性，主要是可以有效避免重构，比如我在写的时候其实存储变量池使用的是数组，防止出现除x,y,z的变量。 |<br>|（Liskov Substitution Principle 里氏替换原则）| 子类应当可以替换父类并出现在父类能够出现的任何地方。这个原则是Liskov于1987年提出的设计原则。它同样可以从Bertrand Meyer 的DBC (Design by Contract) 的概念推出。| 一个能够反映这个原则的例子时圆和椭圆，圆是椭圆的一个特殊子类。因此任何出现椭圆的地方，圆均可以出现。但反过来就可能行不通。运用替换原则时，我们尽量把类B设计为抽象类或者接口，让C类继承类B(接口B)并实现操作A和操作B，运行时，类C实例替换B，这样我们即可进行新类的扩展(继承类B或接口B)，同时无须对类A进行修改。（子类替换父类）除此之外， 感觉对于接口就是子类必须重写父类的所有方法这个思想。如果子类不实现父类接口，会造成内容的损失，甚至报错。 |<br>| （Dependence Inversion Principle 依赖倒置原则）| 依赖倒置（Dependence Inversion Principle）原则讲的是：要依赖于抽象，不要依赖于具体。|简单的说，依赖倒置原则要求客户端依赖于抽象耦合。原则表述：抽象不应当依赖于细节；细节应当依赖于抽象；要针对接口编程，不针对实现编程。（高层模块不依赖底层模块）降低耦合性，面对接口编程。抽象类不依赖具体实现（动物不能继承猫，狗）|<br>|（Interface Segregation Principle 接口分隔原则）| 采用多个与特定客户类有关的接口比采用一个通用的涵盖多个业务方法的接口要好。ISP原则是另外一个支持诸如COM等组件化的使能技术。缺少ISP，组件、类的可用性和移植性将大打折扣。这个原则的本质相当简单。如果你拥有一个针对多个客户的类，为每一个客户创建特定业务接口，然后使该客户类继承多个特定业务接口将比直接加载客户所需所有方法有效。（低耦合）|动物跑，飞的方法，要分成不同的接口，再去接口具体的动物类（有点界门纲目科属种的感觉）|</p>
</blockquote>
<h3 id="关于测试"><a href="#关于测试" class="headerlink" title="关于测试"></a>关于测试</h3><h4 id="测试模块"><a href="#测试模块" class="headerlink" title="测试模块"></a>测试模块</h4><p>这一单元测试我借助<code>python</code>的<code>simpify</code>包书写了自动化测试模块，但后续由于该包只能<strong>测试多项式</strong>（也不能处理前导0），只适用于第一次作业的测试(当然后续有大佬进行改进以适用于后面两次作业），具体测试方案和代码可以见链接我的站点<a href="https://charles2530.github.io/2023/02/25/oo-hw1-test/">OO_hw1_test - Charles’s Castle</a>或讨论区，当然互测的<strong>自动化测试</strong>也是相同思路的编写，在此不具体展开。</p>
<h4 id="数据生成器"><a href="#数据生成器" class="headerlink" title="数据生成器"></a>数据生成器</h4><p>关于<strong>数据生成器</strong>部分，由于题目有规定的文法，我们只需要按照题目规定的<strong>思路及文法</strong>完成相关数据生成的编写即可，比较简单，在此放一个第一次作业的数据生成器。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">My_path = <span class="string">&#x27;D:\\coding_file\\study\\Lesson\\oo_lesson\\OO\\test\\hw1&#x27;</span></span><br><span class="line"></span><br><span class="line">Var = [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]</span><br><span class="line">Op = [<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>]</span><br><span class="line">cnt = <span class="number">3</span></span><br><span class="line">maxi = sys.maxsize</span><br><span class="line">poly_num = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">get_Code</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.get_Exp()</span><br><span class="line">        self.main()</span><br><span class="line">        self.get_Con()</span><br><span class="line">        self.get_Factor()</span><br><span class="line">        self.get_Expr()</span><br><span class="line">        self.get_Poly()</span><br><span class="line">        self.get_Mono()</span><br><span class="line">        self.get_Var()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Poly</span>(<span class="params">self</span>):</span><br><span class="line">        s = self.get_Mono()</span><br><span class="line">        num = random.randint(<span class="number">0</span>, poly_num)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">            random2 = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(Op)-<span class="number">1</span>)</span><br><span class="line">            op = Op[random2]</span><br><span class="line">            s += <span class="built_in">str</span>(op)+self.get_Mono()</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Mono</span>(<span class="params">self</span>):</span><br><span class="line">        s = self.get_Factor()</span><br><span class="line">        num = random.randint(<span class="number">0</span>, <span class="number">2</span>*poly_num)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">            s += <span class="string">&quot;*&quot;</span>+self.get_Factor()</span><br><span class="line">            i = i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Exp</span>(<span class="params">self</span>):</span><br><span class="line">        base = random.randint(-<span class="number">1</span>*maxi, maxi)</span><br><span class="line">        exp = random.randint(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">        random1 = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(Var)-<span class="number">1</span>)</span><br><span class="line">        var = Var[random1]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(base)+<span class="string">&quot; *&quot;</span>+<span class="built_in">str</span>(var)+<span class="string">&quot;** +&quot;</span>+<span class="built_in">str</span>(exp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Con</span>(<span class="params">self</span>):</span><br><span class="line">        base = random.randint(-<span class="number">1</span>*maxi, maxi)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(base)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Var</span>(<span class="params">self</span>):</span><br><span class="line">        base = random.randint(-<span class="number">1</span>*maxi, maxi)</span><br><span class="line">        random2 = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(Var)-<span class="number">1</span>)</span><br><span class="line">        var = Var[random2]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(base)+<span class="string">&quot; *&quot;</span>+<span class="built_in">str</span>(var)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Factor</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Factor_list = [self.get_Con(), self.get_Exp(), self.get_Expr()]</span></span><br><span class="line">        Factor_list = [self.get_Con(), self.get_Exp(), self.get_Var()]</span><br><span class="line">        ans = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(Factor_list)-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> Factor_list[ans]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_Expr</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span>+self.get_Poly()+<span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">self</span>):</span><br><span class="line">        R = [<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;*&#x27;</span>]</span><br><span class="line">        self.code = self.get_Poly()</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">5</span>):</span><br><span class="line">            ran = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(R)-<span class="number">1</span>)</span><br><span class="line">            self.code = self.code+<span class="built_in">str</span>(R[ran])+self.get_Expr()</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(My_path+<span class="string">&#x27;\\src\\in.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    a = get_Code()</span><br><span class="line">    f.write(a.code)</span><br></pre></td></tr></table></figure></div>
<p><strong>其中My_path为项目的路径</strong>，数据将生成于路径下<code>src/in.txt</code>文件中。除此之外，要想获得数据还可以直接输入文法跑<code>chatgpt</code>！！</p>
<h4 id="导出-jar包"><a href="#导出-jar包" class="headerlink" title="导出-jar包"></a>导出-jar包</h4><p>最后还有一个小技能，<strong>导出-jar的包</strong>，-jar这个东西想想大家应该非常熟悉，毕竟它陪伴了我们整个CO（Mars就是一个-jar的包），用-jar加上命令行，可以很方便、系统、快速的得到输。</p>
<p>导出-jar很简单，放一篇之前<code>OO-pre</code>课程讨论区的精品文即可——<a href="https://charles2530.github.io/2023/01/31/oo-pre-9/">OO_pre_9 - Charles’s Castle</a></p>
<hr>
<h3 id="BUG分析"><a href="#BUG分析" class="headerlink" title="BUG分析"></a>BUG分析</h3><p>不幸的是，本人在<strong>第二次作业的强测和互测</strong>中出现了<code>bug</code>，主要时递归下降时出现<code>lexer.next()</code>没有处理好导致了<strong>自定义函数</strong>出错引起的，算是一个很小众的错误，在此不再赘述。但这个bug还是让我感触良多，代码构造真是一个<strong>牵一发而动全身</strong>的事情，只是一个小错误，却给代码带来了很大的错误，这些要<strong>引以为鉴</strong>。</p>
<p>当然第二次还有个很让人难受的点——<code>TLE</code>，我在<code>toString()</code>函数由于<strong>过于在意性能</strong>，结果导致多次调用了<code>toString()</code>函数简化输出，但却最终导致了超时，这次惨痛的经历告诉我们——<strong>优化一定要慎重！！！如果错了就完了<code>qwq</code></strong></p>
<p>而在找别人<code>bug</code>方面，我保持了<strong>“人不犯我，我不犯人”</strong>的基本原则，在没有受到<code>hack</code>之前不开刀，所以这里主要分享 一下自己<code>hack</code>别人第二次作业的一些感受。我hack别人的方法使用的是<strong>用数据生成器或者自己手动构造数据</strong>（但实际产生<code>hack</code>效果的大多还是自己手动构造的），然后写了一个可以遍历运行房里其他人-jar文件的一个脚本，之后通过<code>simpify</code>函数统一输出后再在找到不同的时候进行人工核对结果。</p>
<p>由于我在编写数据生成器时并没有<strong>计算代价cost</strong>，所以在找出可以hack的数据时需要简化代价后填入，这部分在后续有待改进。</p>
<p>从hack测试的有效性方面来说，我由于第二次所在的房间比较惨(感觉是c？），所以真的很容易就hack到了很多bug。主要这些bug都来自<strong>优化方面</strong>，只能说第二次作业优化真的很容易出错，比如有位同学为了追求性能优化了二倍角公式，结果基础分给优化错了。所以这里在此强调一个受用一生的道理——<strong>代码能跑就行，适度优化，正确性才是第一位的。</strong></p>
<hr>
<h3 id="架构设计体验"><a href="#架构设计体验" class="headerlink" title="架构设计体验"></a>架构设计体验</h3><h4 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h4><p>在这三次作业中我并没有重构，主要得益于<strong>递归下降算法</strong>的天然优势和合理的<strong>需求预测</strong>,我在做每一次作业时，并<strong>不仅仅着眼于本次作业的要求</strong>，还对下次作业的要求进行一定预测(当然也有些预测失误导致了代码难度和复杂度的损失，当然理论上<strong>鲁棒性</strong>还是增强的，只是题目没有要求而已），然后在<code>coding</code>的时候尽量关注代码的可扩展性，<strong>为下一次作业的迭代</strong>做好准备。</p>
<h4 id="行数分析"><a href="#行数分析" class="headerlink" title="行数分析"></a>行数分析</h4><p>这里就以<strong>第三次作业</strong>作为样本分析，以展示我经过三次迭代最终的工作量。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/oo_1_line"
                      alt="image-20230315185650221"
                ></p>
<p>由于做了很多优化，最终代码达到了<strong>1380行</strong>，其中<code>poly</code>包有625行，<code>parser</code>包有328行，<code>factor</code>包中有381行，<code>Main</code>函数有46行，出去部分用于提高<code>debug</code>速度的<code>toString()</code>等代码，整体各部分的代码量还是<strong>比较平均的</strong>。</p>
<h4 id="从UML类图展开分析"><a href="#从UML类图展开分析" class="headerlink" title="从UML类图展开分析"></a>从UML类图展开分析</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/UML_oo_1"
                      alt="image-20230315194908472"
                ></p>
<p>这是我自己<code>DIY</code>的一张第三次作业的类图（比较丑），从类图的代码架构可以看出，我的代码结构类间<strong>层次化结构较清晰</strong>，主要以<code>Factor</code>作为主要的中转点，分别做到了统一各类<code>Factor</code>的功能，并通过<code>Facto</code>r作为<strong>桥梁</strong>统一转化为<code>Poly</code>类型最终实现<code>Main</code>中的结果输出。</p>
<p>但在第三次作业做完后，我又重新翻阅了一遍自己的代码，发现还是有不少地方存在<strong>重复造轮子的不好习惯</strong>，如<code>Lexer</code>中的几个函数就可以合并到<code>Definer</code>中全局使用，这个习惯下次一定要改掉！！！</p>
<h3 id="学会的一些小技巧"><a href="#学会的一些小技巧" class="headerlink" title="学会的一些小技巧"></a>学会的一些小技巧</h3><h4 id="BNF的简单入门"><a href="#BNF的简单入门" class="headerlink" title="BNF的简单入门"></a>BNF的简单入门</h4><p><code>BNF(Backus Naur Form Notation)</code>表示文法，用于解析字符串，详细内容涉及到<strong>编译</strong>的知识。<code>BNF</code>是描述上下文无关理论的一种具体方法，所以我们需要学习<code>BNF</code>。可以把它看做一门描述语法的编程语言，通过<code>BNF</code>可以实现此种文法的具体化、公式化、科学化，是实现代码解析的必要条件。</p>
<h4 id="正则表达式的使用"><a href="#正则表达式的使用" class="headerlink" title="正则表达式的使用"></a>正则表达式的使用</h4><p>正则表达式真的<code>yyds</code>，而且真的很在<code>java</code>的那一堆<code>matcher</code>等类的帮助下发挥着巨大的作用，关于正则表达式的使用可以看我的另一篇博客——<a href="https://charles2530.github.io/2022/12/28/regular-expression/">regular expression - Charles’s Castle</a></p>
<h4 id="IDEA的一个实用工具"><a href="#IDEA的一个实用工具" class="headerlink" title="IDEA的一个实用工具"></a>IDEA的一个实用工具</h4><p>IDEA有匹配<strong>正则表达式</strong>的工具，可以实时编辑调试，还是非常好用的。</p>
<ul>
<li>鼠标移动到正则表达式处，右键点击后，点击第一个“<strong>显示上下文操作</strong>”</li>
<li>然后点击“<strong>检查正则表达式</strong>”，效果如图：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://charles2530.github.io/image/match.png"
                      alt="match"
                ></li>
</ul>
<hr>
<h3 id="心得体会"><a href="#心得体会" class="headerlink" title="心得体会"></a>心得体会</h3><p>第一单元作为<code>OO</code>的开胃菜，还是非常让人舒爽的（听某个学长说<code>oo</code>是<strong>开局即地狱</strong>的两单元<strong>超舒爽体验</strong>，意思就是<code>OO</code>最难的部分就是前两个单元，如果保真那不是我已经完成了一半（<code>bushi</code>），这两周在非常忙碌的学习生活中真的让我从来没有这么充实过，减少了不少摸鱼的时间~。</p>
<p>从<code>OO</code>学习到的经验而言，首先我们一定<strong>多多关注讨论区</strong>。当某个地方陷入死局时，<strong>阅读一下同学的思路和分享</strong>也许会让你豁然开朗,更有机会可以白嫖各种大佬的评测机等“神器”。第二是要<strong>关注代码复杂度</strong>，尽量不要写太长的方法。即使不得不写，也要多加小心，因为很有可能有bug藏匿其中。（<code>TLE</code>的教训）如果迫不得已要写，尽量强迫自己不要写大量相似的代码，<strong>提高代码的复用性</strong>。第三是<strong>优化时要慎重</strong>，正确性一定要放在第一位，如果没有正确性，性能分一点没有，还会有很多补bug的痛苦经历，得不偿失的。第四是<strong>注意测试的全面性</strong>。 在测试的时候不能只进行<strong>随机测试</strong>，还要针对我们做的优化多测几组特殊数据。最后，我们一定要<strong>注意代码可扩展性</strong>。写代码时不仅仅要着眼于本次作业的要求，还需要思考下一次作业中可能会有哪些新的要求，为迭代开发做好准备。</p>
<p>最后，在本单元作业中，老师、助教和同学们都给予了我相当大的帮助，数千行代码的书写也进一步提升了我的代码能力，并将我从<strong>面向过程的舒适区</strong>中拽了出来,希望后面的<code>OO</code>课程我可以取得更好的成绩，互测成绩越来越好（开学立个<code>flag</code>哈哈哈！！！）。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1].<a class="link"   target="_blank" rel="noopener" href="https://hyggge.github.io/2022/03/24/oo/oo-di-yi-dan-yuan-zong-jie/" >「BUAA-OO」第一单元:表达式展开 | Hyggge’s Blog <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>(主要思路来源)</p>
<p>[2].<a class="link"   target="_blank" rel="noopener" href="https://plantuml.com/zh/" >使用简单的文字描述画UML图的开源工具。 (plantuml.com) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>(学习画<code>UML</code>类图)</p>
<p>[3].<a href="https://charles2530.github.io/2022/12/28/regular-expression/">regular expression - Charles’s Castle</a></p>
<p>[4].<a href="https://charles2530.github.io/2023/02/25/oo-hw1-test/">OO_hw1_test - Charles’s Castle</a></p>
<p>[5].<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/regexp/regexp-tutorial.html" >正则表达式 – 教程 | 菜鸟教程 (runoob.com) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>[6].<a href="https://charles2530.github.io/2023/01/31/oo-pre-9/">OO_pre_9 - Charles’s Castle</a></p>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> OO_summary_1.Expression</li>
        <li><strong>Author:</strong> Charles</li>
        <li><strong>Created at:</strong> 2023-03-09 13:17:18</li>
        
            <li>
                <strong>Updated at:</strong> 2023-06-17 14:13:59
            </li>
        
        <li>
            <strong>Link:</strong> https://charles2530.github.io/2023/03/09/oo-summary-1-expression/
        </li>
        <li>
            <strong>License:</strong> This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>.
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/OO/">#OO</a>&nbsp;
                        </li>
                    
                </ul>
            

            
  <div class="recommended-article">
   <div class="recommended-desktop">
    <div class="recommended-article-header">
     <i aria-hidden="true"></i><span>recommend_articles</span>
    </div>
    <div class="recommended-article-group"><a class="recommended-article-item" href="/2022/12/26/p6-design-documents/" title="P6 Design documents" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p5.jfif" alt="P6 Design documents">
  <span class="title">P6 Design documents</span>
</a><a class="recommended-article-item" href="/2023/07/17/swift-note-1/" title="Swift-note-1" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.png" alt="Swift-note-1">
  <span class="title">Swift-note-1</span>
</a><a class="recommended-article-item" href="/2022/12/26/p3-design-documents/" title="P3 Design documents" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p2.jfif" alt="P3 Design documents">
  <span class="title">P3 Design documents</span>
</a></div>
   </div>
   <div class="recommended-mobile">
   <div class="recommended-article-header">
     <i aria-hidden="true"></i><span>recommend_articles</span>
   </div>
   <div class="recommended-article-group"><a class="recommended-article-item" href="/2022/12/26/p6-design-documents/" title="P6 Design documents" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p5.jfif" alt="P6 Design documents">
  <span class="title">P6 Design documents</span>
</a><a class="recommended-article-item" href="/2023/07/17/swift-note-1/" title="Swift-note-1" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.png" alt="Swift-note-1">
  <span class="title">Swift-note-1</span>
</a></div>
   </div>
  </div>

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/03/10/tf-keras-layers-dense-introduction/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">tf.keras.layers.Dense()-introduction</span>
                                    <span class="post-nav-item">Prev posts</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/03/07/lab1-report/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">lab1_report</span>
                                    <span class="post-nav-item">Next posts</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
  <div id="comment-anchor"></div>
  <div class="comment-area-title">
    <i class="fa-solid fa-comments"></i>&nbsp;Comments
  </div>
  

  <!-- 
            
    <div id="gitalk-container"></div>
    <script data-pjax
            src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
    <script data-pjax>

        function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
                __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
                Gitalk && new Gitalk({
                    clientID: '8083299a8ee2aaf23879',
                    clientSecret: 'a8161e81d4872181e884fdb69f7be24916b6a9d0',
                    repo: 'charles2530_issues',
                    owner: 'Charles2530',
                    admin: ['Charles2530'],
                    id: __gitalk__pathname,
                    language: 'en'
                }).render('gitalk-container');

            } catch (e) {
                window.Gitalk = null;
            }
        }

        if ('true') {
            const loadGitalkTimeout = setTimeout(() => {
                loadGitalk();
                clearTimeout(loadGitalkTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
        }
    </script>



         -->
  <script src="https://utteranc.es/client.js" repo="Charles2530/Charles2530.github.io" issue-term="pathname"
    label="Comment" theme="preferred-color-scheme" crossorigin="anonymous" async>
  </script>
  
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">OO_summary_1.Expression</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#OO-summary-1-Expression"><span class="nav-text">OO_summary_1.Expression</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hw1%E5%88%86%E6%9E%90"><span class="nav-text">hw1分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%B3%95%E8%A7%84%E5%88%99"><span class="nav-text">文法规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81UML%E7%B1%BB%E5%9B%BE"><span class="nav-text">代码UML类图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E8%A6%81%E6%80%9D%E8%B7%AF"><span class="nav-text">简要思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90"><span class="nav-text">代码架构分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%A7%A3%E6%9E%90%EF%BC%9A%E9%80%92%E5%BD%92%E4%B8%8B%E9%99%8D%E7%AE%97%E6%B3%95"><span class="nav-text">表达式解析：递归下降算法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Lexer%EF%BC%88%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8%EF%BC%89"><span class="nav-text">Lexer（词法分析器）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Parser-%E8%A7%A3%E9%87%8A%E5%99%A8"><span class="nav-text">Parser(解释器)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%B1%95%E5%BC%80"><span class="nav-text">表达式展开</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Mono%EF%BC%88%E5%8D%95%E9%A1%B9%E5%BC%8F%EF%BC%89"><span class="nav-text">Mono（单项式）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Poly%EF%BC%88%E5%A4%9A%E9%A1%B9%E5%BC%8F%EF%BC%89"><span class="nav-text">Poly（多项式）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="nav-text">代码复杂度分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E8%A1%A1%E9%87%8F%E6%8C%87%E6%A0%87%EF%BC%9A"><span class="nav-text">方法的衡量指标：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E8%A1%A1%E9%87%8F%E6%8C%87%E6%A0%87%EF%BC%9A"><span class="nav-text">类的衡量指标：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Method-Metrics"><span class="nav-text">Method Metrics</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hw2%E5%88%86%E6%9E%90"><span class="nav-text">hw2分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%B3%95%E8%A7%84%E5%88%99-1"><span class="nav-text">文法规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81UML%E7%B1%BB%E5%9B%BE-1"><span class="nav-text">代码UML类图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90-1"><span class="nav-text">代码架构分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="nav-text">三角函数的解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E8%A7%A3%E6%9E%90"><span class="nav-text">自定义函数的定义和解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%B1%95%E5%BC%80-1"><span class="nav-text">表达式展开</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90-1"><span class="nav-text">代码复杂度分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Method-Metrics-1"><span class="nav-text">Method Metrics</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hw3%E5%88%86%E6%9E%90"><span class="nav-text">hw3分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%B3%95%E8%A7%84%E5%88%99-2"><span class="nav-text">文法规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81UML%E7%B1%BB%E5%9B%BE-2"><span class="nav-text">代码UML类图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90-2"><span class="nav-text">代码架构分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E5%B5%8C%E5%A5%97"><span class="nav-text">自定义函数嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E6%95%B0%E5%9B%A0%E5%AD%90%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E8%A7%A3%E6%9E%90"><span class="nav-text">导数因子的定义与解析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90-2"><span class="nav-text">代码复杂度分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Method-Metrics-2"><span class="nav-text">Method Metrics</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93%E4%B8%8E%E6%84%9F%E6%82%9F"><span class="nav-text">作业总结与感悟</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E8%AF%BE%E7%A8%8B"><span class="nav-text">关于课程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A0%94%E8%AE%A8%E8%AF%BE%E6%94%B6%E8%8E%B7"><span class="nav-text">研讨课收获</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%B5%8B%E8%AF%95"><span class="nav-text">关于测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E6%A8%A1%E5%9D%97"><span class="nav-text">测试模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-text">数据生成器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%87%BA-jar%E5%8C%85"><span class="nav-text">导出-jar包</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BUG%E5%88%86%E6%9E%90"><span class="nav-text">BUG分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%BD%93%E9%AA%8C"><span class="nav-text">架构设计体验</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E8%A8%80-1"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%8C%E6%95%B0%E5%88%86%E6%9E%90"><span class="nav-text">行数分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8EUML%E7%B1%BB%E5%9B%BE%E5%B1%95%E5%BC%80%E5%88%86%E6%9E%90"><span class="nav-text">从UML类图展开分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%BC%9A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="nav-text">学会的一些小技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BNF%E7%9A%84%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8"><span class="nav-text">BNF的简单入门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">正则表达式的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IDEA%E7%9A%84%E4%B8%80%E4%B8%AA%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="nav-text">IDEA的一个实用工具</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%83%E5%BE%97%E4%BD%93%E4%BC%9A"><span class="nav-text">心得体会</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-text">Reference</span></a></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Charles</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        Total Page Views&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">Powered by Charles</span>
                <br>
            <span class="theme-version-container">Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.2.0</a>
        </div>
        
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>



  <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/layouts/navbarShrink.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/scrollTopBottom.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/lightDarkSwitch.js"></script>


    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/localSearch.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/codeBlock.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/layouts/lazyload.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/runtime.js"></script>
    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/odometer.min.js"></script>
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/assets/odometer-theme-minimal.css">



  <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/Typed.min.js"></script>
  <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/plugins/typed.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/mermaid.min.js"></script>
    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/plugins/mermaid.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/minimasonry.min.js"></script>
    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/plugins/masonry.js"></script>


<div class="post-scripts pjax">
    
        <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/tools/tocToggle.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/anime.min.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/layouts/toc.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/plugins/tabs.js"></script>
    
</div>


    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.2.0/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>



  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>

</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
