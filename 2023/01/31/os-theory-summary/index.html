<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Charles">
    <meta name="description" content="This is Charles&#39;s Castle">
    <meta name="author" content="Charles">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-redefine.png">
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://charles2530.github.io/2023/01/31/os-theory-summary/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    <meta property="og:type" content="article">
    <meta property="og:title" content="OS_theory_Summary">
    <meta property="og:description" content="This is Charles&#39;s Castle">
    <meta property="og:url" content="http://charles2530.github.io2023/01/31/os-theory-summary/">
    <meta property="og:image" content="https://charles2530.github.io/image/background/favicon.png">
    <meta property="og:site_name" content="Charles&#39;s Castle">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="OS_theory_Summary">
    <meta name="twitter:description" content="This is Charles&#39;s Castle">
    <meta name="twitter:image" content="https://charles2530.github.io/image/background/favicon.png">
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://charles2530.github.io/image/background/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://charles2530.github.io/image/background/favicon.png">
    <meta name="theme-color" content="#005080">
    <link rel="shortcut icon" href="https://charles2530.github.io/image/background/favicon.png">
    
    <title>
        
            OS_theory_Summary -
        
        Charles&#39;s Castle
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/assets/fonts.css">

    
    
    
        
            
    
            
    
            
                
                    <script data-pjax src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script>
                
    
    
    <script id="hexo-configurations">
    let REDEFINE = window.REDEFINE || {};
    REDEFINE.hexo_config = {"hostname":"charles2530.github.io","root":"/","language":"en","path":"search.xml"};
    REDEFINE.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#005080","avatar":"https://charles2530.github.io/image/background/logo.jpg","favicon":"https://charles2530.github.io/image/background/favicon.png","article_img_align":"center","right_side_width":"210px","content_max_width":"1000px","nav_color":{"left":"#f78736","right":"#367df7","transparency":35},"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_image":{"light":"https://charles2530.github.io/image/background/background-light1.jpg","dark":"https://charles2530.github.io/image/background/background-dark1.jpg"},"title_color":{"light":"#fff","dark":"#d1d1b6"},"description":"Happiness is best","custom_font":{"enable":false,"font_family":null,"font_url":null}},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_block":{"copy":true,"style":"mac","custom_font":{"enable":false,"font_family":null,"font_url":null}},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"1.1.2","friend_links":{"columns":2},"home_article":{"date_format":"auto","category":{"enable":true,"limit":3},"tag":{"enable":true,"limit":3}}};
    REDEFINE.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
    
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
<meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="Charles's Castle" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>



<body>
  <div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="menu-wrapper">
    
    <div class="menu-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Charles&#39;s Castle
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="pc">
                <ul class="menu-list">
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fas fa-bookmark"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags"  >
                                    
                                        
                                            <i class="fas fa-tags"></i>
                                        
                                        TAGS
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://charles2530.github.io">BLOG
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="/friends">FRIENDS
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="menu-drawer">
        <ul class="drawer-menu-list">
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/categories"  >
                             
                                
                                    <i class="fas fa-bookmark"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/tags"  >
                             
                                
                                    <i class="fas fa-tags"></i>
                                
                                TAGS
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="https://charles2530.github.io">BLOG</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/friends">FRIENDS</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
                      
                <div class="article-title">
                    <img src="https://charles2530.github.io/image/background/p1.jfif" alt="OS_theory_Summary" />
                    <h1 class="article-title-cover">OS_theory_Summary</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://charles2530.github.io/image/background/logo.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Charles</span>
                            
                                <span class="author-label">Lv6</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="pc">2023-01-31 13:14:55</span>
        <span class="mobile">2023-01-31 13:14</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="pc">2023-03-09 13:23:37</span>
            <span class="mobile">2023-03-09 13:23</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Lesson/">Lesson</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/Lesson/OS/">OS</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/Lesson/OS/OS-theory/">OS-theory</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/OS/">OS</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-file-word"></i>&nbsp;<span>28.1k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>97 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote>
<p>OS的启动需要硬件层面的帮助,它叫BootLoader.它负责运行第一段软件代码.</p>
</blockquote>
<h1 id="内存划分"><a href="#内存划分" class="headerlink" title="内存划分"></a>内存划分</h1><p>在32位MIPS中,一次性能访问的空间是4GB .从上到下分为:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/13/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%90%AF%E5%8A%A8/4f82685665a0d39f66b0bd02880b221cc4cd45bc7d8d2c4da4f3cb567a226b1a.png"
                      alt="内存划分"
                ></p>
<p><strong>内存划分</strong></p>
<blockquote>
<ul>
<li><strong>kseg2</strong> 是mapped的内存空间,访问需要通过MMU模块转换.</li>
<li><strong>kseg1</strong> 既没有mapped,也没有cached,所以它能在cache和MMU都没有初始化的时候使用.只需要去掉高三位地址就能实现地址映射使用.</li>
<li><strong>kseg0</strong> 没有mapped,所以在初始化cache之后就能使用.只需要去掉最高位地址就能实现地址映射使用.</li>
<li><strong>kuseg</strong> 是用户能使用的空间.</li>
</ul>
</blockquote>
<p>通过上面的分析我们知道,在刚开电的时候只有<code>kseg1</code>和<code>kseg0</code>能使用,另外两个都需要<code>MMU</code>和<code>cache</code>初始化之后才能用,但是等这俩初始化完,os早就能用了.</p>
<h1 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h1><h3 id="硬件检测"><a href="#硬件检测" class="headerlink" title="硬件检测"></a>硬件检测</h3><p>这一步是计算机检测自己的硬件是否符合开机的要求,在<code>X86</code>体系使用的是<code>BIOS</code> .这段代码存在<code>ROM</code>(Read Only Memory),它和<code>RAM</code>最大的区别就是断电之后不会消失(不是用的电容存信息),所以存放<code>bios</code>正合适.因为直接使用的<code>ROM</code>,所以更倾向于将其看成硬件结构,而不是软件,也常称作<code>bios</code>芯片.</p>
<h3 id="读取MBR"><a href="#读取MBR" class="headerlink" title="读取MBR"></a>读取MBR</h3><h4 id="MBR介绍"><a href="#MBR介绍" class="headerlink" title="MBR介绍"></a>MBR介绍</h4><p><code>MBR(Master Boot Record)</code>主引导目录,存放了预启动信息,分区表信息.这里存了操作系统的<code>bootloader</code>.<br>其446bytes存的是<code>BootLoader</code>,之后64bytes的分区表,之后是2bytes的魔数(bios检查这个来判断是否是一个分区的硬盘).<br>64bytes中每16bytes是一个分区的入口,所以一共有四个分区.也就是说一个系统最多四个入口.</p>
<h4 id="分区介绍"><a href="#分区介绍" class="headerlink" title="分区介绍"></a>分区介绍</h4><p>磁盘有三种分区,主磁盘分区,扩展磁盘分区,逻辑分区.</p>
<blockquote>
<ul>
<li>一个系统最多四个主分区,最少一个主分区,主分区用于存储系统.只能有一个主分区处于active状态,其余为inactive,便于boot选择系统.</li>
<li>一个系统最多一个扩展磁盘分区,主分区和扩展分区之和最多不超过四个.</li>
<li>逻辑分区可以有若干个.逻辑分区可以认为是扩展分区的子集.<br>对于磁盘一般分出主分区存系统之后,剩余空间全部都是扩展分区,对于扩展分区一般分成多个逻辑分区.</li>
</ul>
</blockquote>
<h3 id="Run-BootLoader"><a href="#Run-BootLoader" class="headerlink" title="Run BootLoader"></a>Run BootLoader</h3><p>那么读取了MBR之后,找到了<code>BootLoader</code>,接下来就应该<code>run</code>了.该段代码用于初始化硬件设备,建立内存空间的映射,为<code>os</code>做好准备.</p>
<h4 id="运行引导程序"><a href="#运行引导程序" class="headerlink" title="运行引导程序"></a>运行引导程序</h4><p><strong>首先</strong>读入主引导记录至<code>7C00H</code>处,运行主引导程序.其任务包括</p>
<blockquote>
<ul>
<li>检查(<code>WORD</code>)<code>0x7dfe</code>是否等于<code>0xaa55</code></li>
<li>跳转到<code>0x7c00</code>运行<code>MBR</code>中程序</li>
<li>将自己复制到<code>0x0600</code>处,继续执行</li>
<li>搜索主分区表中标志位<code>active</code>的分区</li>
<li>将活动分区的第一个扇区(<code>boot sector</code>)读入<code>0x7c00</code></li>
<li>检查<code>WORD</code>是否等于<code>0xaa55</code></li>
<li>运行该扇区的指令(<code>bootsect.s</code>),该函数的运行在下一个title中详解</li>
</ul>
</blockquote>
<h3 id="加载内核"><a href="#加载内核" class="headerlink" title="加载内核"></a>加载内核</h3><p><strong>bootsect.s的工作流程如下:</strong></p>
<blockquote>
<ul>
<li>首先将自身从原始启动区<code>0x7c00-0x7dff</code>移动到<code>0x90000-0x901ff</code></li>
<li>读引导扇区的后四个扇区到<code>0x90200</code>,调用引导阶段函数</li>
<li>设置一些参数,比如堆栈基址.磁盘参数表</li>
<li>加载内核映像.如果是大内核就加载到<code>0x100000</code>,否则加载到<code>0x10000</code></li>
<li>跳转到<code>Setup</code>的入口点</li>
</ul>
</blockquote>
<p><strong>setup.s的工作:</strong></p>
<blockquote>
<ul>
<li>初始化硬件设备</li>
<li>为内核程序的执行家里环境</li>
<li>如果内核镜像在0x10000处,则将其移动到0x1000.</li>
<li>跳转到<code>startup_32()</code>汇编程序</li>
</ul>
</blockquote>
<p><strong>Head.s的工作(第一个start_32()函数)</strong></p>
<blockquote>
<ul>
<li>初始化段寄存器和临时堆栈.</li>
<li>清除<code>efags</code>寄存器的所有位</li>
<li>将<code>_edata</code>和<code>_end</code>区间的所有内核未初始化区填充0</li>
<li>调用<code>decompress_kernal()</code>函数解压内核映像,并将其移动到<code>0x100000</code>处.</li>
<li>跳转到<code>0x100000</code>物理内存处执行.</li>
</ul>
</blockquote>
<p><strong>Head.s的工作(第二个start_32()函数)</strong></p>
<blockquote>
<ul>
<li>因为这是在<code>0x100000</code>地址的函数,所以相同的函数名没有什么问题(类似于c语言两个同名函数但是在不同工程里面),该函数用于为第一个Linux进程建立执行环境</li>
<li>初始化段寄存器的最终值</li>
<li>0填充内核的<code>bss</code>段</li>
<li>初始化<code>swapper_pg_dir</code>数组和<code>pg0</code>包含的临时内核页表</li>
<li>建立进程<code>0idle</code>进程的内核模式的堆栈.</li>
<li>……</li>
<li>跳转到<code>start_kernal</code>函数,这个函数是第一个C编制的函数.</li>
</ul>
</blockquote>
<p><strong>Start_kernal()的工作</strong></p>
<blockquote>
<ul>
<li>这个函数用于启动初始化函数初始化各种设备,完成<code>Linux</code>核心环境的建立</li>
<li><code>sched_init()</code>初始化调度器</li>
<li><code>build_all_zonelists</code>函数初始化内存区</li>
<li>调用<code>page_alloc_init()</code>和<code>mem_init()</code>初始化伙伴系统分配器</li>
<li>调用<code>trap_init()</code>和<code>init_IRQ()</code>对中断控制表IDT进行最后的初始化</li>
<li>…<br>至此Linux内核单减完成,基于Linux的程序可以正常运行了.</li>
</ul>
</blockquote>
<h3 id="用户层init依据inittab文件设定运行等级"><a href="#用户层init依据inittab文件设定运行等级" class="headerlink" title="用户层init依据inittab文件设定运行等级"></a>用户层init依据inittab文件设定运行等级</h3><p><strong>Linux的运行等级划分:</strong></p>
<blockquote>
<ul>
<li>0:关机</li>
<li>1:单用户模式</li>
<li>2:无网络支持的多用户模式</li>
<li>3:有网络支持的多用户模式</li>
<li>4:未使用的等级</li>
<li>5:有网络支持有X_Window支持的多用户模式</li>
<li>6:重启</li>
</ul>
</blockquote>
<h3 id="执行rc-sysinit"><a href="#执行rc-sysinit" class="headerlink" title="执行rc.sysinit"></a>执行rc.sysinit</h3><p>该文件主要用于初始化一些软件层面的事情,比如<code>PATH</code>的配置,网络配置等.</p>
<h3 id="启动内核模块"><a href="#启动内核模块" class="headerlink" title="启动内核模块"></a>启动内核模块</h3><p>该步骤用于装载内核模块,<code>Linux</code>全面接手后续工作</p>
<h3 id="执行脚本程序"><a href="#执行脚本程序" class="headerlink" title="执行脚本程序"></a>执行脚本程序</h3><p>根据运行级别不同,系统执行从<code>rc0.d</code>到<code>rc6.d</code>中的相应脚本程序,完成初始化和启动服务.</p>
<h3 id="执行rc-local-可选"><a href="#执行rc-local-可选" class="headerlink" title="执行rc.local(可选)"></a>执行rc.local(可选)</h3><p>此处是用户自定义的模块,类似开机自启动项.</p>
<h3 id="执行login程序-进入登录状态"><a href="#执行login程序-进入登录状态" class="headerlink" title="执行login程序,进入登录状态"></a>执行login程序,进入登录状态</h3><p>进入这一步,计算机算完成了的开机工作,硬件层面的通电,到<code>MMU</code>,<code>Cache</code>的建立,时钟频率等的计算,内核装载并开始进行服务,接下来就等着用户输入密码,开始使用这台电脑大干一番了.</p>
<h1 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h1><h2 id="原因和需求"><a href="#原因和需求" class="headerlink" title="原因和需求"></a>原因和需求</h2><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><blockquote>
<ul>
<li>软件对内存的需求很大,如果不加管理,会无限制使用内存</li>
<li>快速存储器成本太高,需要好好利用内存</li>
</ul>
</blockquote>
<h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><blockquote>
<ul>
<li>支持多程序和多用户</li>
<li>充分利用空间</li>
<li>给每一个程序足够大的逻辑运行空间</li>
<li>存储保护</li>
</ul>
</blockquote>
<h2 id="存储管理的功能"><a href="#存储管理的功能" class="headerlink" title="存储管理的功能"></a>存储管理的功能</h2><blockquote>
<ul>
<li><strong>存储的分配和回收</strong>:时存储管理的重点,重点时讨论算法和相应的数据结构.</li>
<li><strong>存储的共享和保护</strong>:可以理解成对地址空间的权限(读,写,运行).</li>
<li><strong>地址变换</strong>: 可执行文件生成时的链接计数,程序加载时的重定位技术,进程运行时硬件和软件的地址变换技术.</li>
<li><strong>存储的容量扩充</strong>:不是增加内存条的容量扩充,而是当需要更多内存的时候,内存的覆盖,交换,虚拟内存.</li>
</ul>
</blockquote>
<h2 id="概念解析"><a href="#概念解析" class="headerlink" title="概念解析:"></a>概念解析:</h2><blockquote>
<ul>
<li><strong>地址空间</strong>:源程序经过编译之后得到的目标地址,存在于它所限定的地址范围类,这个范围称为地址空间.简言之,地址空间就是<strong>逻辑地址</strong>的集合.</li>
<li><strong>存储空间</strong>:主存中一系列存储信息的物理单元的集合,这些单元的编号称为物理地址或绝对地址.简言之,存储空间就是<strong>物理地址</strong>的集合.</li>
</ul>
</blockquote>
<p>简言之,地址空间就是<strong>进程认为</strong>自己使用的空间,是一个抽象空降,存储空间就是<strong>实际操作</strong>访问的物理空间,这二者就是CO中提到的<strong>虚拟内存技术</strong>.</p>
<blockquote>
<ul>
<li><strong>内碎片</strong>:如果一个分区没有被完全占用,则剩下的空间被称为内碎片.该碎片在操作系统眼里已经被占用,无法整理.</li>
<li><strong>外碎片</strong>: 占用分区之间的空闲分区,这片分区如果小于载入程序则无法利用,被浪费.该碎片可以整理后清楚,是内存系统性能下降的主要原因.</li>
</ul>
</blockquote>
<p>  <strong>刚好利用</strong>:<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E5%88%9A%E5%A5%BD%E5%88%A9%E7%94%A8.png"
                      alt="刚好利用"
                ><br>  <strong>外碎片</strong>:<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E5%A4%96%E7%A2%8E%E7%89%87.png"
                      alt="外碎片"
                ><br>  <strong>内碎片</strong>:<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E5%86%85%E7%A2%8E%E7%89%87.png"
                      alt="内碎片"
                ></p>
<h2 id="单道程序的内存管理"><a href="#单道程序的内存管理" class="headerlink" title="单道程序的内存管理"></a>单道程序的内存管理</h2><p>整个系统中出了操作系统之外只剩这一个程序,所以整个内存可以供他使用,其地址也可以固定.就像整个地区如果只有一个部落,那部落肯定找一个最好的地方发展下去.如果有多个部落互相抢占资源,那肯定存在部落被顶替掉的情况.</p>
<h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><blockquote>
<ul>
<li>在单道程序环境下,整个内存里只有两个程序,一个是用户程序,一个是操作系统.</li>
<li>操作系统占据的空间是固定的.</li>
<li>因此可以将用户程序加载到同一个地址,即用户程序永远可以从同一个地方开始运行.</li>
</ul>
</blockquote>
<h3 id="静态地址翻译"><a href="#静态地址翻译" class="headerlink" title="静态地址翻译"></a>静态地址翻译</h3><p>因为程序的地址固定,所以可以在程序运行之前就计算出所有的物理地址.使用此方法,用户无需知道关于内存的知道,操作系统直接访问地址即可,而且因为没有其他程序,那么整个程序在这个地址就是安全的.</p>
<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><blockquote>
<ul>
<li>优点:运行简单,没有地址翻译,运行速度快</li>
<li>缺点:整个内存只给一个程序,造成资源浪费.而且如果程序必内存大无法加载,则无法运行.</li>
</ul>
</blockquote>
<h2 id="多道程序的内存管理–分区"><a href="#多道程序的内存管理–分区" class="headerlink" title="多道程序的内存管理–分区"></a>多道程序的内存管理–分区</h2><h3 id="空间的分配"><a href="#空间的分配" class="headerlink" title="空间的分配"></a>空间的分配</h3><blockquote>
<ul>
<li>把内存分成一些大小<strong>相等或者不等的</strong>分区,每个应用程序占用一个或者多个分区,操作系统占用一个分区.</li>
<li>适用于多道程序系统和分时系统,支持并发,但难以进行内存分区的共享.(每个程序共享整个内存,难以对某一些地址空间进行权限控制)</li>
</ul>
</blockquote>
<h3 id="固定式分区分配"><a href="#固定式分区分配" class="headerlink" title="固定式分区分配"></a>固定式分区分配</h3><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><blockquote>
<ul>
<li>固定(静态)式分区分配:这个方法是<strong>程序适应分区</strong>,在系统初始化之后将内存划分成若干个<strong>任意大小</strong>的区域,然后将这些区域分配给进程.</li>
<li><ul>
<li>相同大小的分区:适用性差,只适用于多个相同程序的并发执行</li>
</ul>
</li>
<li><ul>
<li>分区大小不等:多个小分区,适量的中等分区,少量的大分区,根据程序大小,分配适当的分区.</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h4><blockquote>
<ul>
<li>优点:算法实现简单,方案运行开销小</li>
<li>缺点:出现了内碎片,分区数目限制之后,最大载入程序数量也确定,限制了并发执行程序的数量.</li>
</ul>
</blockquote>
<h4 id="分配方式"><a href="#分配方式" class="headerlink" title="分配方式"></a>分配方式</h4><blockquote>
<ul>
<li>单一队列的分配方式:当加载程序是,选择一个闲置且足够大的分区加载.多个程序排在同一个队列.</li>
<li>多队列的分配方式:根据程序的大小分成不同队列,排在不同大小的分区后面.</li>
</ul>
</blockquote>
<h3 id="可变式分区"><a href="#可变式分区" class="headerlink" title="可变式分区"></a>可变式分区</h3><h4 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h4><blockquote>
<ul>
<li>可变式分区分配:这个方法是分区适应程序,分区的边界可以更改.</li>
</ul>
</blockquote>
<h4 id="优缺点-2"><a href="#优缺点-2" class="headerlink" title="优缺点"></a>优缺点</h4><blockquote>
<ul>
<li>优点:没有了内碎片</li>
<li>缺点:有外碎片</li>
</ul>
</blockquote>
<h3 id="闲置空间的管理"><a href="#闲置空间的管理" class="headerlink" title="闲置空间的管理"></a>闲置空间的管理</h3><h4 id="位图表示法"><a href="#位图表示法" class="headerlink" title="位图表示法"></a>位图表示法</h4><p>给每个分区赋予一个滋味,用来记录该分配单元是否闲置.</p>
<h4 id="链表表示法"><a href="#链表表示法" class="headerlink" title="链表表示法"></a>链表表示法</h4><p>将分配单元按照是否闲置链接起来.每一个结点分别记录该空间是否空闲,空间的起止地址以及指向下一个结点的指针.</p>
<h4 id="两种方法分析"><a href="#两种方法分析" class="headerlink" title="两种方法分析"></a>两种方法分析</h4><p><strong>位图表示法</strong></p>
<blockquote>
<ul>
<li>空间成本固定,不依赖于内存中程序数量</li>
<li>时间成本低,只需要修改位图即可,一次改1bit</li>
<li>没有容错能力,如果存储单元出错,无法分辨该位置的1是被占用还是出错.</li>
</ul>
</blockquote>
<p><strong>链表表示法</strong></p>
<blockquote>
<ul>
<li>空间成本取决于程序数量</li>
<li>时间成本高,链表的查找是O(n)的复杂度</li>
<li>有一定容错能力,因为链表有被占空间和闲置空间的表项,可以互相验证.</li>
</ul>
</blockquote>
<h4 id="可变分区的管理"><a href="#可变分区的管理" class="headerlink" title="可变分区的管理"></a>可变分区的管理</h4><p>内存采用两张表,已分配分区表和为分配分区表.</p>
<p>每张表的表项都可称为存储控制块<code>MCB(Memory Control Block)</code>,包括<code>AMCB</code>(Allocated MCB)和<code>FMCB</code>(Free MCB).</p>
<p>空闲分区控制块按某种次序构成FMCB链表接口,但分区被分配之后,其前后项指针无意义.</p>
<h3 id="分区分配操作"><a href="#分区分配操作" class="headerlink" title="分区分配操作"></a>分区分配操作</h3><h4 id="分配内存"><a href="#分配内存" class="headerlink" title="分配内存"></a>分配内存</h4><blockquote>
<ul>
<li>设size是最小分区大小,不能再分割</li>
<li>如果请求分区大小&gt;分区大小 ==&gt; 检索下一个表项</li>
<li>如果请求分区大小+size&lt;分区大小 ==&gt; 则将分区中按照相应大小划分一块,剩下的部分留在空间分区表中.</li>
<li>如果请求分区大小+size≥分区大小 ==&gt; 则将整个分区都分给程序.</li>
</ul>
</blockquote>
<h4 id="回收内存"><a href="#回收内存" class="headerlink" title="回收内存"></a>回收内存</h4><blockquote>
<ul>
<li>回收分区邻接空闲分区则将空闲分区和回收分区合并</li>
<li>回收分区不邻接空闲分区则在空闲分区表中新建表项放置回收分区</li>
</ul>
</blockquote>
<h3 id="搜索算法"><a href="#搜索算法" class="headerlink" title="搜索算法"></a>搜索算法</h3><h4 id="基于顺序搜索的分配算法"><a href="#基于顺序搜索的分配算法" class="headerlink" title="基于顺序搜索的分配算法"></a>基于顺序搜索的分配算法</h4><p><strong>算法介绍</strong></p>
<blockquote>
<ul>
<li><strong>首次适应算法</strong>:每个空白区按照地址顺序排成链表,从头找到尾,分配出第一个满足条件的分区</li>
<li><strong>下次适应算法</strong>:把空白区构成一个循环链表,每一次查询从上一次的位置出发,分配出第一个满足条件的分区</li>
<li><strong>最佳适应算法</strong>:遍历所有空白区,分配最佳的分区</li>
<li><strong>最坏适应算法</strong>:遍历所有空白区,分配最大的空白区</li>
</ul>
</blockquote>
<p><strong>算法特点</strong></p>
<blockquote>
<ul>
<li><strong>首次适应算法</strong>:低地址地址会被不断划分出去,之后的查找时间开销变大</li>
<li><strong>下次适应算法</strong>:是空间使用更加均匀</li>
<li><strong>最佳适应算法</strong>:分配出的空间是最佳的,但是会剩下很多特别小的碎片,而且时间开销大</li>
<li><strong>最坏适应算法</strong>:剩下比较大的碎片,不能满足之后的大程序,而且时间开销大</li>
</ul>
</blockquote>
<p><strong>总结</strong><br>该类方法只适用于小系统,如果系统很大,则分区很多,每次的查找开销很大</p>
<h4 id="基于索引搜索的分配算法"><a href="#基于索引搜索的分配算法" class="headerlink" title="基于索引搜索的分配算法"></a>基于索引搜索的分配算法</h4><h5 id="快速适应算法"><a href="#快速适应算法" class="headerlink" title="快速适应算法"></a>快速适应算法</h5><p>快速适应算法:将空闲分区按照容量大小分类,并把常用大小的分区单独建立链表,并对多个链条设立管理索引链表.</p>
<blockquote>
<ul>
<li>优点:查找效率高,根据长度分类,保证了内存分配结果的最优,不产生碎片</li>
<li>缺点:算法复杂,开销大,分配空间的时候以进程为单位,存在一定的浪费.</li>
</ul>
</blockquote>
<h5 id="伙伴系统"><a href="#伙伴系统" class="headerlink" title="伙伴系统"></a>伙伴系统</h5><p>  在分配存储块时将一个大的存储块分裂成两个大小相等的小块，这两个小块就称为“伙伴”,对于不同大小分区建立链表.</p>
<blockquote>
<p>伙伴系统规定分区的大小一定是2的k次幂,n≤k≤m,其中<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.279ex" height="1.528ex" role="img" focusable="false" viewBox="0 -675.5 1007.3 675.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>是最小分区大小,<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.724ex" height="1.528ex" role="img" focusable="false" viewBox="0 -675.5 1203.8 675.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>是最大分区大小,通常为整个内存<br>在系统运行中可能因为不断划分形成若干个不连续的空闲分区<br>内存管理模块保持有多个空闲块链表,空闲块大小为2的整数次幂</p>
</blockquote>
<p><strong>内存分配</strong></p>
<blockquote>
<ul>
<li>在程序启动的时候只有一个空闲块(整个内存)</li>
<li>当一个大小为n的进程申请内存的时候向上取2的整数次幂(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.279ex" height="1.528ex" role="img" focusable="false" viewBox="0 -675.5 1007.3 675.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>)寻找空闲块,如果没有空闲块,则去<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="4.323ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1910.9 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg></mjx-container>去寻找.</li>
<li>对于<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="4.323ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1910.9 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg></mjx-container>大小的空闲分区,分出2n用于分配,另一半加入管理<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.279ex" height="1.528ex" role="img" focusable="false" viewBox="0 -675.5 1007.3 675.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>的链表中,这两个分区称为<strong>伙伴</strong></li>
<li>如果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="4.323ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1910.9 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg></mjx-container>大小的空闲分区不存在则依次类推</li>
</ul>
</blockquote>
<p><strong>内存释放</strong><br>将被释放块与其伙伴合并成一个更大的空闲块,然后一直合并下去</p>
<h2 id="多道程序的内存管理–分页"><a href="#多道程序的内存管理–分页" class="headerlink" title="多道程序的内存管理–分页"></a>多道程序的内存管理–分页</h2><h3 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想"></a>基本思想</h3><p>分区的思路怎样都会导致碎片的出现,浪费空间,影响性能.如果把一个逻辑地址连续的程序分散存放到不连续的内存区域中,但保证正常运行,则级充分利用了空间,由可减少移动带来的开销.支持分页的硬件部件通常叫做MMU.</p>
<h3 id="纯分页系统"><a href="#纯分页系统" class="headerlink" title="纯分页系统"></a>纯分页系统</h3><blockquote>
<ul>
<li>如果不具备页面交换功能,那么每次作业的时候必须<strong>将所有页面一次性装入到主存</strong>,如果空间不够,则必须等待.</li>
<li>优点:没有外碎片,每个内碎片也不超过页的大小</li>
<li>缺点:程序全部装入内存,空间开销大.</li>
</ul>
</blockquote>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><blockquote>
<ul>
<li><strong>页</strong>: 在分页存储管理系统中把每个作业的地址空间分成一些大小相等的片,称之为<strong>页面或者页</strong>(<code>page</code>),从0开始编号,其大小通常是2的幂次方,常用大小为4KB.</li>
<li><strong>存储块</strong>: 在分页存储管理系统中,把主存的存储空间也分成了和页相同大小的片,这些片成为<strong>存储块</strong>,或称为<strong>页框</strong>,从0开始编号.</li>
<li><strong>页表</strong>: 装载进程空间中的页和内存空间中页框的映射的表,每一个进程都有一个.</li>
</ul>
</blockquote>
<h3 id="多级页表"><a href="#多级页表" class="headerlink" title="多级页表"></a>多级页表</h3><h4 id="一级页表的问题"><a href="#一级页表的问题" class="headerlink" title="一级页表的问题"></a>一级页表的问题</h4><p>  如果内存很大,那么页表也会很大,占用内存多,实现复杂.</p>
<p>  因此解决思路如下:</p>
<blockquote>
<ul>
<li>动态调入页表,只调入当前需用的部分页表项</li>
<li>多级页表</li>
</ul>
</blockquote>
<h4 id="两级页表"><a href="#两级页表" class="headerlink" title="两级页表"></a>两级页表</h4><p>  将页表再进行分页,离散的将给个页表页面存放咋i不同物理块,然后再建立一张外部页表用来记录对应的物理块号,运行时调入一级页表,再动态调入页表,因为只调入所需页表,所以占用的空间少了.</p>
<h4 id="多级页表-1"><a href="#多级页表-1" class="headerlink" title="多级页表"></a>多级页表</h4><p>  多级页表同理,每一级页表只指向下一个页表项所在地址,最后的页表指向实际的内存地址.但是页表级数增加,访存次数增加,降低效率.</p>
<h3 id="快表TLB"><a href="#快表TLB" class="headerlink" title="快表TLB"></a>快表TLB</h3><p>  因为无论如何,页表至少需要访问两次内存,所以需要使用<code>Cache</code>装入部分常用页表项,这部分<code>Cache</code>叫做快表(TLB)<br>  快表和Cache类似,地址转换原理和页表一样,就不赘述了.</p>
<h3 id="反置页表"><a href="#反置页表" class="headerlink" title="反置页表"></a>反置页表</h3><p>  利用反置页表进行地址变换的步骤:</p>
<blockquote>
<ul>
<li>用<strong>进程标志符</strong>和<strong>页号</strong>去搜索反置页表</li>
<li>如果没有找到说明没有调入内存,产生中断.</li>
<li>如果检索到对应表项,则表项的序号i就是物理地址.</li>
</ul>
</blockquote>
<p>反置页表之所以交反置页表,是因为普通页表是通过序号找内容,这是匹配内容找序号.</p>
<blockquote>
<ul>
<li><strong>缺点</strong>: 因为反置页表通过物理地址排序,而虚拟地址不一定是连续,所以查询可能需要找遍整个页表,时间场</li>
<li><strong>优点</strong>: 页表存储空间大大减少</li>
</ul>
</blockquote>
<h3 id="哈希页表"><a href="#哈希页表" class="headerlink" title="哈希页表"></a>哈希页表</h3><p>对于超过32位地址空间的常用方法是使用哈希页表,使用虚拟页号作为哈希是,哈希页表的每一条目都包裹一个链表,链表的每个结点哈希相同.每个元素包含三个域:</p>
<blockquote>
<ul>
<li>虚拟页号,也就是hash 的key</li>
<li>映射的页框号</li>
<li>指向下一个元素的指针因为可能存在<code>hash</code>冲突,所以要处理冲突.</li>
</ul>
</blockquote>
<h4 id="检索方法"><a href="#检索方法" class="headerlink" title="检索方法"></a>检索方法</h4><blockquote>
<ul>
<li>计算虚拟页号和进程标志符对应的<code>hashcode</code></li>
<li>域虚拟页号与链表中的每一个元素的第一个域比较</li>
<li>匹配则取出页框号</li>
<li>反之继续寻找</li>
</ul>
</blockquote>
<h3 id="页的保护"><a href="#页的保护" class="headerlink" title="页的保护"></a>页的保护</h3><p>页式存储管理系统提供了两种方式:</p>
<blockquote>
<ul>
<li>地址越界保护</li>
<li>在页表中设置保护位</li>
</ul>
</blockquote>
<h3 id="优缺点-3"><a href="#优缺点-3" class="headerlink" title="优缺点"></a>优缺点</h3><p><strong>优点</strong></p>
<blockquote>
<ul>
<li>不要求连续存储</li>
<li>解决外碎片</li>
</ul>
</blockquote>
<p><strong>缺点</strong></p>
<blockquote>
<ul>
<li>内碎片浪费</li>
<li>不适合大型应用</li>
</ul>
</blockquote>
<h2 id="多道程序的内存管理–分段"><a href="#多道程序的内存管理–分段" class="headerlink" title="多道程序的内存管理–分段"></a>多道程序的内存管理–分段</h2><p><strong>方便编程</strong>:</p>
<blockquote>
<ul>
<li>通常一个作业是由多个程序段和数据段组成(<code>.data</code>,<code>.bss</code>,<code>.text</code>),用户一般按照逻辑关系对作业分段,并能根据名字访问程序段和数据段</li>
</ul>
</blockquote>
<p><strong>信息共享</strong>:</p>
<blockquote>
<ul>
<li>共享是以信息的逻辑单位为基础.页是存储信息的物理单位,段是信息的逻辑单位.</li>
<li>页式管理中地址空间是一维的,主程序,子程序都顺序排列,共享共用子程序比较困难,一个共享过程可能需要几十个页面.(一个共享程序被多个进程共享,每个进程都有一个页表)</li>
</ul>
</blockquote>
<p><strong>信息保护</strong></p>
<blockquote>
<ul>
<li>页式管理中,一个页面可能装有两个不同的子程序段的指令代码,不能通过页面共享实现共享一个逻辑上完整的子程序或者数据块</li>
<li>段式管理中,可以以信息的逻辑单位进行保护</li>
</ul>
</blockquote>
<p><strong>动态增长</strong></p>
<blockquote>
<ul>
<li>实际应用中,某些段(数据段)会不断增长,分页能以实现</li>
</ul>
</blockquote>
<p><strong>动态链接</strong></p>
<blockquote>
<ul>
<li>动态链接在程序运行时才把主程序和要用到的目标程序链接起来</li>
</ul>
</blockquote>
<h3 id="地址结构"><a href="#地址结构" class="headerlink" title="地址结构"></a>地址结构</h3><p><strong>段表</strong></p>
<blockquote>
<ul>
<li>段表记录段与内存位置的对应关系</li>
<li>段表保存在内存中</li>
<li>段表的基址及长度由段表寄存器给出</li>
<li><ul>
<li>|段表基址|段表长度|or|STbase|STlen|</li>
</ul>
</li>
<li>访问一次物理内存需要方位两次内存(段表和内存)</li>
<li>逻辑地址由段和段内地址组成</li>
<li><ul>
<li>|段号|段内地址|or|SNo|Soffset|</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="地址变换机制"><a href="#地址变换机制" class="headerlink" title="地址变换机制"></a>地址变换机制</h3><p>  根据逻辑地址的段号访问段表对应的项,如果段号比段表长度长就抛出异常.在段表内检索到相应项,将项的基址和段内地址拼接得到物理地址.</p>
<p><strong>段地址变换</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E6%AE%B5%E5%9C%B0%E5%9D%80%E5%8F%98%E6%8D%A2.png"
                      alt="段地址变换"
                ></p>
<h3 id="信息共享"><a href="#信息共享" class="headerlink" title="信息共享"></a>信息共享</h3><p><strong>可重入代码</strong></p>
<p>可重入代码称为<strong>纯代码</strong>,是允许多个进程访问的代码,该段代码只允许读,不允许写,以保证每个进程使用的代码完全相同.</p>
<h3 id="段页式存储结构"><a href="#段页式存储结构" class="headerlink" title="段页式存储结构"></a>段页式存储结构</h3><p>逻辑地址包含段号,页号和页内地址,先访问段表得到页表始址,再访问页表获得块号,和页内地址和块号拼接得到物理地址.</p>
<p><strong>段页地址变换</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E6%AE%B5%E9%A1%B5%E5%9C%B0%E5%9D%80%E5%8F%98%E6%8D%A2.png"
                      alt="段页地址变换"
                ></p>
<h2 id="虚拟存储"><a href="#虚拟存储" class="headerlink" title="虚拟存储"></a>虚拟存储</h2><h3 id="局部性原理"><a href="#局部性原理" class="headerlink" title="局部性原理"></a>局部性原理</h3><blockquote>
<ul>
<li><strong>时间局部性</strong>: 即一条指令的一次执行和下次执行,一条数据的一次访问和下次访问都集中在一个较短的时期内</li>
<li><strong>空间局部性</strong>: 即当前指令和邻近的几条指令,当前访问的数据和邻近的数据都集中在一个较小的区域内</li>
</ul>
</blockquote>
<p>根据上述局部性原理,我们就可以在装入程序的时候,不将全部读入到内存,只需要将当前需要执行的部分页或段读入到内存,就可开始执行.如果访问缺失再从外存调入.</p>
<h3 id="虚拟存储技术的特征"><a href="#虚拟存储技术的特征" class="headerlink" title="虚拟存储技术的特征"></a>虚拟存储技术的特征</h3><blockquote>
<ul>
<li><strong>多次性</strong>:作业分成多次调入内存,因此在逻辑上,内存扩大了.</li>
<li><strong>对换性</strong>:允许在作业运行过程中进行换进换出,提高内存利用率(暂时用不到的数据换出内存,提高内存使用效率)</li>
<li><strong>离散型</strong>:物理内存分配的不连续,虚拟地址空间使用的不连续</li>
<li><strong>虚拟性</strong>:通过物理内存和快速外存相结合提供大范围的虚拟地址空间</li>
</ul>
</blockquote>
<h3 id="优缺点-4"><a href="#优缺点-4" class="headerlink" title="优缺点"></a>优缺点</h3><p><strong>优点</strong>:</p>
<blockquote>
<ul>
<li>可在较小的内存中执行较大的程序</li>
<li>可在内存中容纳更多程序并发执行</li>
<li>不必影响编程时的程序结构</li>
<li>提供给用户的可用虚拟内存空间大于物理内存</li>
</ul>
</blockquote>
<p><strong>缺点</strong>:</p>
<blockquote>
<ul>
<li>虚拟内存实际上是外存的一部分,所以牺牲了CPU的速度</li>
<li>虚拟内存也不能无限制加大,32位的机器一次性能访问的地址最大也就4GB</li>
</ul>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>虚拟存储技术就是将部分外存当作内存的中转站,将部分不常用的数据放进去,需要的时候直接拿出来,逻辑上内存就扩大了.使用覆盖的方法,将一个程序化为一个个相对独立的程序单位,再使用交换技术,保证常用的部分在内存中,不常用的覆盖就交换到外存里面.</p>
<h2 id="请求分页-段-系统"><a href="#请求分页-段-系统" class="headerlink" title="请求分页(段)系统"></a>请求分页(段)系统</h2><p>在分页(段)技术的基础上,增加了<strong>请求调页(段)功能</strong>,<strong>页面(段)置换功能</strong>所形成的页(段)式虚拟存储器系统.</p>
<p>它允许只装入若干页(段)就可运行程序,以后在硬件的支持下通过<strong>请求调页(段)功能</strong>和<strong>置换页(段)功能</strong>,陆续将要运行的页面(段)调入内存,同时把暂不运行的页面(段)交换到外存上,置换时以页(段)为单位.</p>
<h3 id="请求式分页系统"><a href="#请求式分页系统" class="headerlink" title="请求式分页系统"></a>请求式分页系统</h3><p>在运行作业之前,只需将当前需要的一部分页面装入内存,在需要其他页的时候,自动选择一些页交换到辅存去,再调入需要的页.</p>
<h3 id="页表项结构"><a href="#页表项结构" class="headerlink" title="页表项结构"></a>页表项结构</h3><p><strong>状态位</strong><br>用于指示该页是否已经进入内存,一般由操作系统来管理.如果对页表查询时,发现状态位为0,则发生缺页中断.</p>
<p><strong>修改位</strong><br>用于只是该页调入内存后是否被修改过,如果已经修改过,那么重新分配页框(物理内存)的时候,就必须将其写回辅存,如果没有修改过,丢弃即可.</p>
<p><strong>页框号</strong><br>指出该页对应的物理页框号</p>
<p><strong>访问字段</strong><br>当页面被访问过则置1,供后续页面置换算法再选择时作参考</p>
<p><strong>禁用高速缓存</strong><br>适用于内存映射I/O,如果禁用,则表示该地址对应I/O设备,CPU访问时循环等待外设的相应,而不是访问高速缓存.</p>
<p><strong>保护位</strong><br>指定所运行的访问,读,写,执行等,具体由设备自己决定.</p>
<h3 id="页面调入策略"><a href="#页面调入策略" class="headerlink" title="页面调入策略"></a>页面调入策略</h3><blockquote>
<ul>
<li><strong>请求调页</strong>:只调入发生缺页异常时候的页面,实现简单,但不适合在初始化的时候使用,会发生多次异常,导致程序效率低下</li>
<li><strong>预调页</strong>:在发生缺页的时候,一次性调入该页和邻近的几个页,常在程序装入的时候使用</li>
</ul>
</blockquote>
<h3 id="页面置换算法"><a href="#页面置换算法" class="headerlink" title="页面置换算法"></a>页面置换算法</h3><h4 id="最佳算法-OPT-optimal"><a href="#最佳算法-OPT-optimal" class="headerlink" title="最佳算法 (OPT optimal)"></a><strong>最佳算法 (OPT optimal)</strong></h4><p>选择”未来不再使用”或者”在离当前最远位置上出现的”页面置换.<br>这只是一个<strong>理想</strong>情况,实际很难实现,但可以作业思想知道和评估依据.</p>
<h4 id="NRU-最近未使用页面置换算法"><a href="#NRU-最近未使用页面置换算法" class="headerlink" title="NRU 最近未使用页面置换算法"></a><strong>NRU 最近未使用页面置换算法</strong></h4><p>在最近的一个时钟周期内,淘汰最近没有被访问的页面.<br>根据修改位和访问字段来选择.</p>
<h4 id="FIFO-先进先出算法"><a href="#FIFO-先进先出算法" class="headerlink" title="FIFO 先进先出算法"></a><strong>FIFO 先进先出算法</strong></h4><p>总是选择最先装入内存的一页调出.<br>该算法通过链表实现,链表指针指向第一个进入的页.<br>该方法存在将常使用的页面丢掉的情况,产生<code>Bleady</code>现象</p>
<h4 id="二次机会页面置换算法"><a href="#二次机会页面置换算法" class="headerlink" title="二次机会页面置换算法"></a><strong>二次机会页面置换算法</strong></h4><p>对FIFO算法的改进,检查最老页面的R位,如果R为0则淘汰,反之则R复位,然后将这个页面放到链表的最后(相当于修改了FIFO中页的装入时间)</p>
<h4 id="时钟算法-CLOCK"><a href="#时钟算法-CLOCK" class="headerlink" title="时钟算法 CLOCK"></a><strong>时钟算法 CLOCK</strong></h4><p>该算法使用环形队列,就不需要将页放到链表末尾,直接指针向下走一位就行.</p>
<h4 id="页面缓冲算法-page-buffering"><a href="#页面缓冲算法-page-buffering" class="headerlink" title="页面缓冲算法 page buffering"></a><strong>页面缓冲算法 page buffering</strong></h4><p>对FIFO算法的发展,创立缓冲区缓冲被置换页面,有机会找回刚被置换的页面.</p>
<blockquote>
<ul>
<li>对于被置换页表,根据其是否被修改,放入缓冲区中两个不同链表–<strong>空闲链表</strong>和<strong>已修改页面链表</strong>,如果被再次访问则放回内存.</li>
<li>当需要读入新的物理页面时,将新页面内容读入到空闲页面链表的第一项所指页面,然后将第一项删除</li>
<li>当已修改页面达到一定数目之后再将他们一起调入外存,,然后将他们归入空闲页面链表,减少I/O次数</li>
</ul>
</blockquote>
<p>相当于空闲页链表就是缓冲区,记录最近的页面交换历史,当需要访问时先去缓冲区访问.</p>
<h4 id="最近最少使用算法-LRU"><a href="#最近最少使用算法-LRU" class="headerlink" title="最近最少使用算法 LRU"></a><strong>最近最少使用算法 LRU</strong></h4><p>当需要置换一页面时，选择在最近一段时间内最久不用的页面予以淘汰.<br>该算法思路最接近最佳算法,但实现困难.<br>实现如下:</p>
<blockquote>
<ul>
<li>使用栈来维护信息,栈底是最久未使用的页面,如果页面使用则将其放置于栈顶.</li>
<li>全局保存一个自增计数器用来记录进程时间,每个页面配备一个计数器,当页面被访问,该页面的计数器被赋值成全局计数器的值,当淘汰页面的时候,淘汰最小的那个页面.</li>
</ul>
</blockquote>
<h4 id="最不常用算法-NFU"><a href="#最不常用算法-NFU" class="headerlink" title="最不常用算法 NFU"></a><strong>最不常用算法 NFU</strong></h4><p>与LRU类似,页面记录自己被访问次数,淘汰次数最少的页面</p>
<h4 id="Aging算法"><a href="#Aging算法" class="headerlink" title="Aging算法"></a><strong>Aging算法</strong></h4><p>与NFU类似,但是计数器每个周期右移一位,最高位填入R位,使得最近的访问权重最大</p>
<h3 id="缺页异常处理"><a href="#缺页异常处理" class="headerlink" title="缺页异常处理"></a>缺页异常处理</h3><p><strong>缺页异常处理</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/03/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E7%BC%BA%E9%A1%B5%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86.png"
                      alt="缺页异常处理"
                ></p>
<p>如果在访问页表的时候,该页没有装入内存,则抛出缺页异常,异常处理如下:</p>
<blockquote>
<ul>
<li>和正常的异常处理一样,先保护重要信息于栈中,进入异常处理入口</li>
<li>找出虚拟地址对应的页地址</li>
<li>查找是否有空页框,如果有,则直接调入其中并更新页表.</li>
<li>如果没有,则使用相应算法置换出一个页框</li>
<li>恢复现场,线程重新执行</li>
</ul>
</blockquote>
<h2 id="工作集与驻留集"><a href="#工作集与驻留集" class="headerlink" title="工作集与驻留集"></a>工作集与驻留集</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<ul>
<li><strong>工作集</strong>: 近期使用过的页面集合</li>
<li><strong>驻留集</strong>: 每个进程调入到内存的页面集合.</li>
</ul>
</blockquote>
<h3 id="策略"><a href="#策略" class="headerlink" title="策略"></a>策略</h3><p>进程再任一时间t,都存在一个集合,包含所有最近k次内存访问过的页面,这个集合称为工作集.</p>
<p>根据时间局部性原理,如果能预测未来某段时间将要访问的页面,并提前调入内存了,那么就能提高效率.工作集就是依据进程过去一段时间内访问的页面调整常驻集大小.</p>
<p>根据局部性原理,我们知道,随着访问次数的增减,内存访问的局部性区域趋向稳定,如果局部性区域改变,工作集也能逐渐过渡到下一个稳定值.</p>
<p>该集合的建立可以建立一个二元函数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="7.839ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3464.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1048,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1437,0)"><path data-c="1D6E5" d="M574 715L582 716Q589 716 595 716Q612 716 616 714Q621 712 621 709Q622 707 705 359T788 8Q786 5 785 3L781 0H416Q52 0 50 2T48 6Q48 9 305 358T567 711Q572 712 574 715ZM599 346L538 602L442 474Q347 345 252 217T157 87T409 86T661 88L654 120Q646 151 629 220T599 346Z"></path></g><g data-mml-node="mo" transform="translate(2270,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(2714.7,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3075.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 其中Δ为时间窗口大小,函数值表示再时间<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.548ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3778.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(861.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(1861.4,0)"><path data-c="1D6E5" d="M574 715L582 716Q589 716 595 716Q612 716 616 714Q621 712 621 709Q622 707 705 359T788 8Q786 5 785 3L781 0H416Q52 0 50 2T48 6Q48 9 305 358T567 711Q572 712 574 715ZM599 346L538 602L442 474Q347 345 252 217T157 87T409 86T661 88L654 120Q646 151 629 220T599 346Z"></path></g><g data-mml-node="mo" transform="translate(2694.4,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(3139.1,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3500.1,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g></g></g></svg></mjx-container>内访问的页面集合,函数W关于Δ只增不减,<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="9.097ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4020.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1326,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1715,0)"><path data-c="1D6E5" d="M574 715L582 716Q589 716 595 716Q612 716 616 714Q621 712 621 709Q622 707 705 359T788 8Q786 5 785 3L781 0H416Q52 0 50 2T48 6Q48 9 305 358T567 711Q572 712 574 715ZM599 346L538 602L442 474Q347 345 252 217T157 87T409 86T661 88L654 120Q646 151 629 220T599 346Z"></path></g><g data-mml-node="mo" transform="translate(2548,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(2992.7,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3353.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3742.7,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g></g></svg></mjx-container>指工作集大小即页面数目.</p>
<blockquote>
<ul>
<li>监视每个进程的工作集</li>
<li>周期性地从一个进程的驻留集中移去那些不在它的工作集中的页</li>
<li>只有当一个进程的工作集在内存中时，才可以执行</li>
</ul>
</blockquote>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>  碰到缺页异常的时候,遍历整个页表,如果页表最近没有用过,则判断其是否在工作集内,如果在则去找下一个页面,不然就替换调.</p>
<h3 id="WSClock算法"><a href="#WSClock算法" class="headerlink" title="WSClock算法"></a>WSClock算法</h3><p><code>Clock</code>算法加上工作集算法,使用循环链表,就不需要遍历整个页表了.<br>  工作流程:</p>
<blockquote>
<ul>
<li>发生缺页异常,检查当前指针指向的页面</li>
<li>如果最近使用过,则不淘汰,指针向下走</li>
<li>如果没有使用过,判断其是否在工作集,不在工作集,判断是否被修改过,没有修改过则直接替换,修改过则异步写入磁盘,然后寻找下一个没有改过的老页面.</li>
<li>如果一直没有找到老的干净页面,则说明都在工作集(有不在的话,因为异步写入,则其变成干净的老页面了),则随机替换一个.</li>
</ul>
</blockquote>
<h3 id="页面置换策略"><a href="#页面置换策略" class="headerlink" title="页面置换策略"></a>页面置换策略</h3><h4 id="全局置换"><a href="#全局置换" class="headerlink" title="全局置换"></a>全局置换</h4><p>出些缺页异常且进程空闲物理块用完,则从内存中选择一块调出,该块可能属于其他进程</p>
<h4 id="局部置换"><a href="#局部置换" class="headerlink" title="局部置换"></a>局部置换</h4><p>出些缺页异常且进程空闲物理块用完,则从进程的物理块中选一块替换</p>
<h3 id="抖动"><a href="#抖动" class="headerlink" title="抖动"></a>抖动</h3><p>随着进程的并发数增加,处理器的利用率先上升后下降,这种现象称为抖动.因为并发数太多,每一个进程的驻留集太小,缺页率太高,频繁抛出缺页异常,导致整个线程陷入了I/O,cpu工作占用很低.</p>
<h4 id="抖动的预防和消除"><a href="#抖动的预防和消除" class="headerlink" title="抖动的预防和消除"></a>抖动的预防和消除</h4><blockquote>
<ul>
<li>局部置换策略 (局部置换策略不会占用其他线程的空间)</li>
<li>引入工作集算法</li>
<li>预留部分页面</li>
<li>挂起若干线程</li>
</ul>
</blockquote>
<h1 id="链接与重定位"><a href="#链接与重定位" class="headerlink" title="链接与重定位"></a>链接与重定位</h1><h2 id="逻辑地址空间"><a href="#逻辑地址空间" class="headerlink" title="逻辑地址空间"></a>逻辑地址空间</h2><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>如果没有引入抽象的逻辑地址空间,直接使用物理地址,那么,没有重定位操作势必破坏系统和其他应用的内存,如果实现重定位,其实现复杂(每次运行都需要重新编译进行重定位),浪费时间,所以需要<strong>新增一层在程序</strong>和实际物理地址之间,这一层就是<strong>逻辑地址空间</strong>,这样只需要建立逻辑地址到物理地址的映射即可,不需要每次都修改文件.</p>
<h3 id="辨别"><a href="#辨别" class="headerlink" title="辨别"></a>辨别</h3><blockquote>
<ul>
<li>物理地址:</li>
<li><ul>
<li>内存中一系列存储信息的物理地址的集合</li>
</ul>
</li>
<li>逻辑地址</li>
<li><ul>
<li>对内存空间的抽象</li>
</ul>
</li>
<li><ul>
<li>是一个进程用来范文内存的一组地址</li>
</ul>
</li>
<li><ul>
<li>不同进程之间的地址空间相对独立,每个进程访问的地址是自己的逻辑地址,不会访问到其他进程的空间.</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="地址映射"><a href="#地址映射" class="headerlink" title="地址映射"></a>地址映射</h3><p>程序的逻辑地址空间只是针对进程而言,实际操作系统需要访问物理地址,逻辑地址到实际物理地址的转化就是地址映射,由存储管理单元(MMU)完成.</p>
<h3 id="动态重定位"><a href="#动态重定位" class="headerlink" title="动态重定位"></a>动态重定位</h3><p>在装载程序时,直接将程序装入到分配的内存中,执行的时候,基址寄存器存放程序的首地址,界限寄存器存放程序的长度,这样每一次地址访问都经过基址寄存器的转换,访问到真正的内存.</p>
<h2 id="装入和链接"><a href="#装入和链接" class="headerlink" title="装入和链接"></a>装入和链接</h2><p>代码源文件先经过编译,变成机器码文件,再把几个程序之间链接,以使用依赖的库,然后再一起装入内存.</p>
<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p>链接分为静态链接和动态链接,分别如下</p>
<blockquote>
<ul>
<li>静态链接:在编译阶段把静态库复制加入到可执行文件中,导致可执行文件较大.</li>
<li>动态链接:假装链接完毕,其实只是加入了描述信息,等到执行到这里的时候去访问相应动态库载入内存执行.</li>
</ul>
</blockquote>
<h1 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h1><h2 id="并发和并行"><a href="#并发和并行" class="headerlink" title="并发和并行"></a>并发和并行</h2><h3 id="并发-Concurrent"><a href="#并发-Concurrent" class="headerlink" title="并发(Concurrent)"></a>并发(Concurrent)</h3><p>设两个活动<code>a</code>和<code>b</code>,在某一个指定时间t后,只要<code>a</code>和<code>b</code>都处在起点和终点之间的某一处,那就称之为<strong>并发</strong>.</p>
<h3 id="并行-Parallel"><a href="#并行-Parallel" class="headerlink" title="并行(Parallel)"></a>并行(Parallel)</h3><p>设两个程序,如果在同一个时间度量下同时运行在不同的处理机上,则陈这两个程序是<strong>并行</strong>的.</p>
<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><p>并行一定并发,并发不一定并行.</p>
<h3 id="并发执行的特征"><a href="#并发执行的特征" class="headerlink" title="并发执行的特征"></a>并发执行的特征</h3><blockquote>
<ul>
<li>间断性: 并发程序具有”执行—暂停—执行”间断性的活动规律.</li>
<li>非封闭性: 多个程序会共享系统中的资源,该资源状态会被多个程序改变,程序之间会互相影响.</li>
<li>不可再现性: 在输入相同的情况下,输出还和执行次序有关.</li>
</ul>
</blockquote>
<h2 id="Bernstein条件"><a href="#Bernstein条件" class="headerlink" title="Bernstein条件"></a>Bernstein条件</h2><p>该条件是判断程序并发执⾏行结果是否可再现的充分条件。</p>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote>
<ul>
<li><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.604ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2477 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mo" transform="translate(759,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(1148,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2088,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>: <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.127ex" height="1.952ex" role="img" focusable="false" viewBox="0 -705 940 862.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>的读子集,表示在<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.127ex" height="1.952ex" role="img" focusable="false" viewBox="0 -705 940 862.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>中被引用的变量的集合.</li>
<li><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.258ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2766 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1048,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(1437,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2377,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>: <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.127ex" height="1.952ex" role="img" focusable="false" viewBox="0 -705 940 862.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>的写子集,表示在<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.127ex" height="1.952ex" role="img" focusable="false" viewBox="0 -705 940 862.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>中被修改的变量的集合.</li>
</ul>
</blockquote>
<p>两个进程可并发,当且仅当下列条件同时成立的时候:</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="19.452ex" height="2.312ex" role="img" focusable="false" viewBox="0 -772 8598 1022"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mo" transform="translate(759,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1148,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(1793,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(2293,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2904.2,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(3793.4,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(4841.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5230.4,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(5875.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(6375.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(7042.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(8098,0)"><g data-mml-node="mo"><path data-c="2205" d="M331 696Q335 708 339 722T345 744T350 759T357 769T367 772Q374 772 381 767T388 754Q388 746 377 712L366 673L378 661Q460 575 460 344Q460 281 456 234T432 126T373 27Q319 -22 250 -22Q214 -22 180 -7Q168 -3 168 -4L159 -33Q148 -71 142 -75Q138 -78 132 -78Q124 -78 118 -72T111 -60Q111 -52 122 -18L133 21L125 29Q39 111 39 344Q39 596 137 675Q187 716 251 716Q265 716 278 714T296 710T315 703T331 696ZM276 676Q264 679 246 679Q196 679 159 631Q134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16Q291 16 324 47Q354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"></path></g></g></g></g></svg></mjx-container><br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="19.452ex" height="2.312ex" role="img" focusable="false" viewBox="0 -772 8598 1022"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(1048,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1437,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(2082,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(2582,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3193.2,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(4082.4,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mo" transform="translate(4841.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5230.4,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(5875.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(6375.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(7042.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(8098,0)"><g data-mml-node="mo"><path data-c="2205" d="M331 696Q335 708 339 722T345 744T350 759T357 769T367 772Q374 772 381 767T388 754Q388 746 377 712L366 673L378 661Q460 575 460 344Q460 281 456 234T432 126T373 27Q319 -22 250 -22Q214 -22 180 -7Q168 -3 168 -4L159 -33Q148 -71 142 -75Q138 -78 132 -78Q124 -78 118 -72T111 -60Q111 -52 122 -18L133 21L125 29Q39 111 39 344Q39 596 137 675Q187 716 251 716Q265 716 278 714T296 710T315 703T331 696ZM276 676Q264 679 246 679Q196 679 159 631Q134 597 128 536T121 356Q121 234 127 174T151 80L234 366Q253 430 275 506T308 618L318 654Q318 656 294 669L276 676ZM181 42Q207 16 250 16Q291 16 324 47Q354 78 366 136T378 356Q378 470 372 528T349 616L348 613Q348 611 264 326L181 42Z"></path></g></g></g></g></svg></mjx-container></p>
<p>也可以理解为两个进程对于同一个共享变量的权力对等的时候才是可并发的,既二者都是读或者二者都是写.</p>
<h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>进程是程序在一个数据集合上运行的<strong>过程</strong>，它是系统进行资源分配和调度的一个<strong>独立单位</strong>。</p>
<h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><blockquote>
<ul>
<li><strong>动态性</strong>：进程是程序的一次执行过程。因创建而诞生，因调度而执行，因无资源而暂停，因撤销而消亡。</li>
<li><strong>并发性</strong>：多个进程实体同时存在于内存中，能在一段时间内同时运行。</li>
<li><strong>独立性</strong>：在传统<code>os</code>中，进程是独立运行的基本单位。</li>
<li><strong>异步性</strong>：进程之间相互制约，进程自己以各自独立的不可预知的速度向前推进。</li>
<li><strong>结构特征</strong>：程序段，数据段，进程控制块<code>PCB</code>。</li>
</ul>
</blockquote>
<p>进程应该包括：</p>
<blockquote>
<ul>
<li>程序代码</li>
<li>程序数据</li>
<li>PC值</li>
<li>一组通用寄存器的<strong>值</strong>（不是寄存器本身），堆，栈</li>
<li>一组系统资源（比如打开的文件）</li>
</ul>
</blockquote>
<h2 id="进程的状态与控制"><a href="#进程的状态与控制" class="headerlink" title="进程的状态与控制"></a>进程的状态与控制</h2><h3 id="进程的状态"><a href="#进程的状态" class="headerlink" title="进程的状态"></a>进程的状态</h3><p>进程有三种基本状态：就绪状态，执行状态，阻塞状态。</p>
<blockquote>
<ul>
<li>就绪状态：进程已经获得了除处理器资源外的所有资源，等待调度。</li>
<li>执行状态：占用处理器资源，处于此状态的进程数目小于等于处理器数量. 在没有其他进程可以执行时, 通常会自动执行系统的idle进程(相当于空操作)。</li>
<li>阻塞状态：正在执行的进程，因为某种原因无法继续执行，放弃处理器资源。</li>
</ul>
</blockquote>
<h3 id="进程控制块"><a href="#进程控制块" class="headerlink" title="进程控制块"></a>进程控制块</h3><p>  进程控制块在进程控制中的作用：</p>
<blockquote>
<ul>
<li>随着进程创建而创建，随着进程撤销而撤销</li>
<li>是进程的唯一标志</li>
<li>限制系统进程数目（有些操作系统PCID只有6bit，最多容纳64个进程）</li>
</ul>
</blockquote>
<p>进程控制块是进程管理与控制中最重要的数据结构，每一个进程均有一个PCB。其包含以下内容：</p>
<blockquote>
<ul>
<li><strong>进程标识符</strong>：每一个进程都必须有一个唯一的标识符, 可以是字符串, 也可以是数字. 在进程创建时被系统赋予。</li>
<li><strong>程序与数据地址</strong>：把PCB与其对应的程序与数据联系起来。</li>
<li><strong>进程状态</strong>：表示进程状态，为了方便管理，<code>os</code>将相同状态的进程统一管理。</li>
<li><strong>现场保留区</strong>：当进程放弃处理器的时候，应把处理器中的各种状态信息保存起来，待重新获得处理器之后恢复现场。</li>
<li><strong>同步互斥机制相关的域</strong>：用于实现进程间互斥，同步所需的信号量。</li>
<li><strong>进程通信机制相关的域</strong>：用于实现进程间通信所需的字段</li>
<li><strong>资源清单</strong>：列出所拥有的除处理器外的资源记录，如拥有的I/O设备，打开的文件列表。</li>
<li><strong>家族关系</strong>：关于父进程，子进程的信息。</li>
<li><strong>链接字</strong>：根据进程所处的现行状态，进程相应的PCB加入到不同的队列中，PCB链接字指出该进程所在队列中下一个PCB的首地址。（链表指向下一个结点的指针。）</li>
</ul>
</blockquote>
<h3 id="PCB的组织方式"><a href="#PCB的组织方式" class="headerlink" title="PCB的组织方式"></a>PCB的组织方式</h3><p><strong>线性表</strong><br>不论进程的状态如何，将所有的PCB连续地存放在内存的系统区。这种方式适用于系统中进程数目不多的情况。</p>
<p><strong>链接方式</strong><br>系统按照进程的状态将进程的PCB组成队列，从而形成就绪队列、阻塞队列、运行队列等。</p>
<p><strong>索引方式</strong><br>该方式是线性表方式的改进，系统按照进程的状态分别建立就绪索引表、阻塞索引表等。</p>
<h3 id="中断处理触发的进程切换流程"><a href="#中断处理触发的进程切换流程" class="headerlink" title="中断处理触发的进程切换流程"></a>中断处理触发的进程切换流程</h3><blockquote>
<ul>
<li>栈储存进程的PC</li>
<li>硬件从中断向量中载入新进程的PC</li>
<li>汇编程序保存寄存器的值</li>
<li>汇编程序建立新的栈</li>
<li>C语言中断服务运行</li>
<li>调度器决定下一个进程</li>
<li>C语言程序返回到汇编代码</li>
<li>汇编程序开启下一个新进程</li>
</ul>
</blockquote>
<h3 id="进程上下⽂文切换-vs-陷⼊入内核"><a href="#进程上下⽂文切换-vs-陷⼊入内核" class="headerlink" title="进程上下⽂文切换 vs 陷⼊入内核"></a>进程上下⽂文切换 vs 陷⼊入内核</h3><p>进程从用户态到内核态的切换和进程之间的切换不同，mode switch还是在本进程之内，所以上下文切换的时候主要是寄存器上下文切换，栈的切换（防止恶意程序读共享栈中的内核数据导致信息泄露）。</p>
<h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><h3 id="线程的引入"><a href="#线程的引入" class="headerlink" title="线程的引入"></a>线程的引入</h3><p>进程的不足：</p>
<blockquote>
<ul>
<li>一个进程只能在一个时间干一件事</li>
<li>多个进程直接切换开销很大</li>
<li>多个进程共享数据和通讯开销很大</li>
</ul>
</blockquote>
<p>因此引入了线程，线程可以看成轻量级的进程（但是线程和进程是两码事），线程之间的共享数据，并发执行，上下文切换更轻松。</p>
<h3 id="进程和线程"><a href="#进程和线程" class="headerlink" title="进程和线程"></a>进程和线程</h3><p>进程是系统进行资源分配和调度的一个<strong>独立单位</strong>，它同时包含两个概念：资源拥有者和可执行单元。<br>操作系统将资源拥有者称为<strong>进程</strong>（<code>process</code>，<code>task</code>），可执行单元称为<strong>线程</strong>（<code>Thread</code>）。</p>
<blockquote>
<ul>
<li>一个进程可以有多个线程，但是一个线程只能同时被一个进程拥有。</li>
<li>进程是资源分配的基本单位，线程是处理机调度的基本单位，所有线程共享其所属进程的所有资源和代码。</li>
<li>线程执行过程中很容易协作同步，而进程需要通过消息通信进行同步。</li>
<li>线程的划分制度更小，并发性更高。</li>
<li>线程既共享进程的数据，也有自己的堆栈。</li>
<li>线程不能单独执行，但是每一个线程都有程序的入口、执行序列以及程序出口。它必须组成进程才能被执行。</li>
</ul>
</blockquote>
<h3 id="线程实现"><a href="#线程实现" class="headerlink" title="线程实现"></a>线程实现</h3><h4 id="用户级线程"><a href="#用户级线程" class="headerlink" title="用户级线程"></a>用户级线程</h4><p>线程在用户空间, 通过<code>library</code>模拟的<code>thread</code>,不需要或仅需要极少的<code>kernel</code>支持。<br>其上下文切换比较快，不需要更改页表。</p>
<p><strong>主要功能</strong></p>
<blockquote>
<ul>
<li>创建和销毁线程</li>
<li>线程之间传递信息和数据</li>
<li>调度线程执行</li>
<li>保存和恢复线程上下文</li>
</ul>
</blockquote>
<blockquote>
<p>用户级线程库: POSIX Pthreads, Mach C-threads, Java Threads.<br>POSIX Pthreads:</p>
<ul>
<li>用于线程创建和同步的 POSIX 标准 API(IEEE 1003.1c).</li>
<li>可在用户级或内核级实现.</li>
<li>API 规定了线程库的行文, 但不限定实现方法.</li>
<li>类 Unix 操作系统中很常见: Solaris, Linux, MacOS X.</li>
</ul>
</blockquote>
<p><strong>优缺点</strong><br>优点:</p>
<blockquote>
<ul>
<li>线程切换与内核无关</li>
<li>线程的调度由应用决定,容易进行优化</li>
<li>可移植性强,只要线程库支持即可</li>
</ul>
</blockquote>
<p>缺点</p>
<blockquote>
<ul>
<li>很多系统调用会引起阻塞,内核因此会阻塞所有相关线程</li>
<li>内核<strong>只能将处理器分配给进程</strong>(进程是资源分配的基本单位)，即使有多个处理器，也无法实现一个进程中的多个线程的并行执行。</li>
</ul>
</blockquote>
<h4 id="内核级线程"><a href="#内核级线程" class="headerlink" title="内核级线程"></a>内核级线程</h4><p>线程在内核空间. 内核有多个分身, 每一个分身都可以用来处理一个任务. 这用来处理非同步事件很有效, 内核可以对每一个非同步事件产生一个分身来进行处理.</p>
<blockquote>
<p>支持内核线程的操作系统内核称作<strong>多线程内核</strong></p>
</blockquote>
<p><strong>优缺点</strong><br>优点:</p>
<blockquote>
<ul>
<li>内核可以在多个处理器上调度一个进程的多个线程实现同步并行执行</li>
<li>阻塞只发生在线程级别</li>
<li>内核中的一些处理可以通过多线程实现</li>
</ul>
</blockquote>
<p>缺点:</p>
<blockquote>
<ul>
<li>一个进程中的线程切换需要内核参与,线程的切换涉及到两个模式的切换(进程-进程、线程-线程)</li>
<li>效率低下</li>
</ul>
</blockquote>
<h4 id="线程比较"><a href="#线程比较" class="headerlink" title="线程比较"></a>线程比较</h4><blockquote>
<ul>
<li>内核支持线程是OS内核可感知的，而用户级线程是OS内核不可感知的</li>
<li>用户级线程的创建，撤销和调度不需要OS内核的支持；内核支持线程的创建，撤销和调度则需要OS内核支持</li>
<li>用户级线程执行系统调用的时候将中断当前进程，而内核支持线程系统调用的时候只中断线程。</li>
<li>在只有用户级线程的系统内，CPU调度还是以进程为单位，处于运行状态的进程中的多个线程，由用户程序控制线程的轮换运行</li>
<li>在有内核支持线程的系统内，CPU调度则以线程为单位，由OS的线程调度程序负责线程的调度。</li>
</ul>
</blockquote>
<h4 id="混合实现"><a href="#混合实现" class="headerlink" title="混合实现"></a>混合实现</h4><p>系统实现内核级线程<br>用户实现用户级线程<br>可以认为用户的进程是建立在内核线程上的</p>
<h3 id="线程模型"><a href="#线程模型" class="headerlink" title="线程模型"></a>线程模型</h3><p>有些系统同时支持用户线程和内核线程由此产生了不同的多线程模型，即实现用户级线程和内核级线程的连接方式。</p>
<h4 id="Many-to-One-模型"><a href="#Many-to-One-模型" class="headerlink" title="Many-to-One 模型"></a>Many-to-One 模型</h4><p>将多个用户级线程映射到一个内核级线程，线程管理在用户空间完成</p>
<p>该模型和纯的用户线程类似，线程的操作不需要经过内核，效率高，但是系统调用将中断整个进程</p>
<h4 id="One-to-One-模型"><a href="#One-to-One-模型" class="headerlink" title="One-to-One 模型"></a>One-to-One 模型</h4><p>每个用户级线程映射到一个内核级线程</p>
<p>该模型和纯的内核线程类似，系统调用效率高，线程之间可并发，但是线程的创建开销很大</p>
<h4 id="Many-to-Many-模型"><a href="#Many-to-Many-模型" class="headerlink" title="Many-to-Many 模型"></a>Many-to-Many 模型</h4><p>将<code>n</code>个用户级线程映射到<code>m</code>个内核级线程上，要求<code>m &lt;= n</code>。</p>
<p>在多对一模型和一对一模型中取了个折中，克服了多对一模型的并发度不高的缺点，又克服了一对一模型的一个用户进程占用太多内核级线程，开销太大的缺点。又拥有多对一模型和一对一模型各自的优点，可谓集两者之所长。</p>
<h2 id="进程调度"><a href="#进程调度" class="headerlink" title="进程调度"></a>进程调度</h2><p>进程调度就是CPU选择合适的就绪态进程(Runnable|Ready)获得CPU计算资源。</p>
<p>cpu调度再CPU资源稀缺，任务量繁重的时候很重要。合理的调度机制能保证每个进程都能再合适的时间处理完成。比如用户交互的进程对于延迟要求很高，如果调度的时候该进程很久能获得一次CPU资源，那么用户的使用体验及其糟糕。</p>
<p>其要解决的问题如下：</p>
<blockquote>
<ul>
<li>合适分配CPU</li>
<li>如何分配CPU（进程的上下文切换）</li>
<li>按照什么原则选择下面一个要执行的进程</li>
</ul>
</blockquote>
<h3 id="调度类型-CPU的三级调度"><a href="#调度类型-CPU的三级调度" class="headerlink" title="调度类型|CPU的三级调度"></a>调度类型|CPU的三级调度</h3><blockquote>
<ul>
<li><strong>高级调度</strong>：又称“宏观调度”，作业调度。从<strong>用户工作流程</strong>的角度，一次提交若干个作业，对每个作业进行调度。</li>
<li><strong>中级调度</strong>：又称“内外存交换”，从*<em>存储器资源</em>的角度，将进程的部分或全部换出到外存上，将当前所需部分换入内存。指令和数据必须再内存里才能被CPU访问。</li>
<li><strong>低级调度</strong>：又称“微观调度”，“进程或线程调度”，从<strong>CPU资源</strong>的角度的调度，调度频繁，要求高效率。</li>
</ul>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/04/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/%E4%B8%89%E7%BA%A7%E8%B0%83%E5%BA%A6.png"
                      alt="三级调度"
                ></p>
<p><strong>三级调度</strong></p>
<h3 id="进程的特性和分类"><a href="#进程的特性和分类" class="headerlink" title="进程的特性和分类"></a>进程的特性和分类</h3><blockquote>
<ul>
<li><strong><code>I/O Bound</code></strong>(I/O密集型)</li>
</ul>
</blockquote>
<p>频繁进行<code>I/O</code>,花费大量时间在等待I/O<br>计算花费时间短,计算少</p>
<blockquote>
<ul>
<li><strong><code>CPU Bound</code></strong>(CPU密集型)</li>
</ul>
</blockquote>
<p>计算量大</p>
<h3 id="进程-线程-调度的分类"><a href="#进程-线程-调度的分类" class="headerlink" title="进程(线程)调度的分类"></a>进程(线程)调度的分类</h3><h4 id="根据是否在时钟中断作出调度决策"><a href="#根据是否在时钟中断作出调度决策" class="headerlink" title="根据是否在时钟中断作出调度决策"></a>根据是否在时钟中断作出调度决策</h4><blockquote>
<ul>
<li>非抢占式: 该方法等待进程主动放弃CPU才做出调度决策,时钟中断不会做调度决策.</li>
<li>抢占式:给每个进程一个固定的最大时间段,如果到了最大时间段进程还在运行,则强行挂起进程,执行调度策略,在时钟中断的时候做调度决策.</li>
</ul>
</blockquote>
<h4 id="根据不同的应用领域"><a href="#根据不同的应用领域" class="headerlink" title="根据不同的应用领域"></a>根据不同的应用领域</h4><blockquote>
<ul>
<li>批处理系统:减少切换改善性能,尽力让每个作业完成工作,使用<strong>非抢占式算法或分配长时间周期的抢占算法</strong>.</li>
<li>交互式系统:该系统服务于多个用户,要避免一个用户霸占CPU,使用<strong>抢占式算法</strong></li>
<li>实时系统:该系统及时性要求很高,满足确定性的截止时间需求,抢占式为主,非抢占式也有应用.</li>
</ul>
</blockquote>
<h3 id="调度算法的目标"><a href="#调度算法的目标" class="headerlink" title="调度算法的目标"></a>调度算法的目标</h3><p><strong>普适性目标</strong></p>
<blockquote>
<ul>
<li>公平:给每个进程公平的CPU份额,相似的进程获得相似的份额,不同类型的进程可以有区别(每个进程都需要完成,但是完成途径不同,比如及时性要求高的进程优先级高,但每次给的块小,及时性要求低的进程,每次给的块大,但优先级低)</li>
<li>严格:<del>强制力</del> 保证策略严格执行</li>
<li>平衡: 尽量让系统每个部件忙碌,组合CPU密集型和I/O密集型进程</li>
<li>简单:易于实现</li>
<li>轻量:执行开销小</li>
</ul>
</blockquote>
<p><strong>不同系统的特异性目标</strong>:</p>
<h4 id="批处理系统"><a href="#批处理系统" class="headerlink" title="批处理系统"></a>批处理系统</h4><blockquote>
<ul>
<li>提升吞吐量(每小时完成的作业数)</li>
<li>减少周转时间(一批作业从提交到完成所经历的统计平均时间)</li>
<li>CPU利用率:接近100说明硬件不够用了</li>
</ul>
</blockquote>
<p>对批处理系统的度量指标:</p>
<blockquote>
<ul>
<li>吞吐量:作业数/总执行时间</li>
<li>周转时间:完成时间-提交时间</li>
<li>带权周转时间:周转时间/服务时间(执行时间) 反映作业等待执行的情况</li>
<li>平均周转时间:一组作业周转时间之和/作业数</li>
<li>平均带权周转时间:一组作业带权周转时间之和/作业数</li>
</ul>
</blockquote>
<h4 id="交互式系统"><a href="#交互式系统" class="headerlink" title="交互式系统"></a>交互式系统</h4><blockquote>
<ul>
<li>最小化响应时间:用户输入一个请求到系统首次相应</li>
<li>等比例变化:任务花费时间随着其复杂度应该线性增长</li>
<li>满足截止时间:满足所有或者大多数应用 的截止时间,保证及时性</li>
<li>可预测性:保证可预测性和规律性</li>
</ul>
</blockquote>
<h3 id="批处理系统的调度算法"><a href="#批处理系统的调度算法" class="headerlink" title="批处理系统的调度算法"></a>批处理系统的调度算法</h3><h4 id="FCFS-First-Come-First-Serveice-算法"><a href="#FCFS-First-Come-First-Serveice-算法" class="headerlink" title="FCFS(First Come First Serveice)算法"></a>FCFS(First Come First Serveice)算法</h4><p>按照作业进入就绪状态的次序分派CPU,占有CPU之后知道执行完成或者阻塞主动放弃CPU才调度下一个作业.</p>
<p><strong>特点</strong></p>
<blockquote>
<ul>
<li>公平,容易理解和实现</li>
<li>有利于长作业</li>
<li>有利于CPU密集型作业,不利于I/O密集型作业</li>
</ul>
</blockquote>
<h4 id="SJF-Shortest-Job-First-算法"><a href="#SJF-Shortest-Job-First-算法" class="headerlink" title="SJF(Shortest Job First)算法"></a>SJF(Shortest Job First)算法</h4><p>又称SPN(Shortest Proess Next)算法.对预期执行作业段的作业优先分配处理机,后面来的短作业不抢占正在执行的作业</p>
<p><strong>优点</strong></p>
<blockquote>
<ul>
<li>对FCFS的改进,提升了吞吐量</li>
<li>改善了平均周转时间和平均带权周转时间</li>
</ul>
</blockquote>
<p><strong>缺点</strong></p>
<blockquote>
<ul>
<li>对长作业不利</li>
<li>难以准确估计作业执行时间时</li>
<li>如果正在执行进程很慢,后面的短作业无法执行(因为是非抢占调度)</li>
</ul>
</blockquote>
<h4 id="SRTN-Shortest-Remaining-Time-Next"><a href="#SRTN-Shortest-Remaining-Time-Next" class="headerlink" title="SRTN(Shortest Remaining Time Next)"></a>SRTN(Shortest Remaining Time Next)</h4><p>对<code>SJF</code>的改进,变成了抢占式调度.当一个新就绪的进程到达时,如果它比当前运行进程具有更短的完成时间,系统抢占当前进程,选择新的进程执行.<br><strong>缺点</strong>:</p>
<blockquote>
<ul>
<li>长时间的进程可能被源源不断的短进程打断,进入进程饥饿.</li>
</ul>
</blockquote>
<h4 id="HRRN-Hightest-Response-Ratio-Next-最高响应比优先算法"><a href="#HRRN-Hightest-Response-Ratio-Next-最高响应比优先算法" class="headerlink" title="HRRN(Hightest Response Ratio Next)最高响应比优先算法"></a>HRRN(Hightest Response Ratio Next)最高响应比优先算法</h4><p>是FCFS和SJF算法的折中.既考虑作业的运行时间,又考虑作业的等待时间,照顾短作业又避免饿死长作业.<br>每次进行调度的时候,先计算后备作业队列每个作业的的<strong>响应优先级</strong>,优先级最大的作业运行.<br>Response Priority = 1 + 已等待时间/要求运行时间<br><strong>算法效果</strong>:<br>多作业容易等到很高的响应比,长作业等待时间足够长之后,也能获得足够高的响应比.<br><strong>缺点</strong>:<br>每次计算响应比又一定时间开销,性能略差</p>
<h3 id="交互式系统的调度算法"><a href="#交互式系统的调度算法" class="headerlink" title="交互式系统的调度算法"></a>交互式系统的调度算法</h3><h4 id="RR-Round-Robin-时间片轮转算法"><a href="#RR-Round-Robin-时间片轮转算法" class="headerlink" title="RR(Round Robin)时间片轮转算法"></a>RR(Round Robin)时间片轮转算法</h4><p>通过时间片轮转,提高进程并发性和响应时间特性,进而提高资源利用率.<br>各个就绪进程按照FCFS原则,排成一个队列,每次调度时将CPU分配给队首进程,时间片结束或者进程放弃CPU,则进行CPU切换,该队列进入就绪态队列末尾,或者进入阻塞态.</p>
<h4 id="PS-Priority-Scheduling-优先级调度"><a href="#PS-Priority-Scheduling-优先级调度" class="headerlink" title="PS( Priority Scheduling)优先级调度"></a>PS( Priority Scheduling)优先级调度</h4><p>该算法是对RR的改进.优先级调度赋予每个进程不同优先级,高优先级先运行,可以静态或者动态赋予进程优先级.<br><strong>静态优先级</strong><br>进程创建时指定,运行过程中不再改变.该优先级根据进程类型,资源需求,用户要求等创建.</p>
<p><strong>动态优先级</strong><br>在进程运行过程中可以动态改变优先级,以便获得更好的调度性能.</p>
<blockquote>
<ul>
<li>在队列中,等待时间越长则优先级提高,防止进程饥饿</li>
<li>进程每执行一个时间片就降低优先级,防止进程霸占CPU</li>
<li>I/O密集型进程优先级较高</li>
</ul>
</blockquote>
<h4 id="MQ-Multi-Queue-多级队列算法"><a href="#MQ-Multi-Queue-多级队列算法" class="headerlink" title="MQ(Multi Queue)多级队列算法"></a>MQ(Multi Queue)多级队列算法</h4><p>本算法引入多个就绪队列,通过对各队列的区别对待,达到一个综合的调度目标.</p>
<p>对多个进程按照优先级进行分类,每类一个队列,各个队列之间按照PS进行调度,队列里面按照FCFS调度.</p>
<h4 id="MFQ-多级反馈队列算法"><a href="#MFQ-多级反馈队列算法" class="headerlink" title="MFQ 多级反馈队列算法"></a>MFQ 多级反馈队列算法</h4><p>引入多级优先队列,队列优先级越高则时间片越短,越低则越高.进程在某个队列运行完时间片之后,会被移入下一级队列,队列内部FCFS,队列间PS.<br>MFQ = PS(动态优先级) + FCFS + MQ</p>
<h3 id="彩票调度"><a href="#彩票调度" class="headerlink" title="彩票调度"></a>彩票调度</h3><p>为了给不同进程不同的调度份额,CPU资源使用权以彩票的形式发给进程,每次进行随机抽奖,中奖的进程得到资源.通过控制一个进程得到的彩票数比例,可以控制其得到系统资源的概率.</p>
<h3 id="线程调度"><a href="#线程调度" class="headerlink" title="线程调度"></a>线程调度</h3><blockquote>
<ul>
<li>用户级线程:内核调度进程,进程调度线程</li>
<li>内核级线程:内核直接调度线程</li>
</ul>
</blockquote>
<h3 id="优先级倒转及其调度方法"><a href="#优先级倒转及其调度方法" class="headerlink" title="优先级倒转及其调度方法"></a>优先级倒转及其调度方法</h3><h4 id="优先级倒转现象"><a href="#优先级倒转现象" class="headerlink" title="优先级倒转现象"></a>优先级倒转现象</h4><p>例如有三个进程A,B,C,优先级依次降低.A和C共享资源X.这时C占有共享资源,一直没有放锁,A需要使用X,但因为C的优先级太低,A需要等待很久才能使用C.<br>这种高优先级进程（或线程）被低优先级进程（或线程）延迟或阻塞的现象叫<strong>优先级倒转现象</strong></p>
<h4 id="解决办法–优先级置项"><a href="#解决办法–优先级置项" class="headerlink" title="解决办法–优先级置项"></a>解决办法–优先级置项</h4><p>还是上面那个例子,当C进入临界区之后,C所占有的处理机不允许被抢占.<br><strong>缺点</strong></p>
<blockquote>
<ul>
<li>如果临界区过长,A进程还是会等很长时间</li>
</ul>
</blockquote>
<h4 id="优先级继承"><a href="#优先级继承" class="headerlink" title="优先级继承"></a>优先级继承</h4><p>当A因为临界区被阻塞的时候,C继承A的优先级,并一致保持到C退出临界区.</p>
<h3 id="实时系统的调度算法"><a href="#实时系统的调度算法" class="headerlink" title="实时系统的调度算法"></a>实时系统的调度算法</h3><p>实时系统分为<strong>硬实时系统</strong>和<strong>软实时系统</strong>,硬实时系统要求绝对满足截至时间要求,软实时系统可以偶尔不满足截至时间要求.</p>
<h4 id="静态表调度"><a href="#静态表调度" class="headerlink" title="静态表调度"></a>静态表调度</h4><p>通过对所有周期性任务的分析预测,事先确定一个固定的调度方案.<br><strong>优点</strong></p>
<blockquote>
<ul>
<li>无任何动态计算,开销小</li>
<li>无灵活性,只适用于完全固定的任务场景</li>
</ul>
</blockquote>
<h4 id="单调速率调度RMS"><a href="#单调速率调度RMS" class="headerlink" title="单调速率调度RMS"></a>单调速率调度RMS</h4><p>RMS是<strong>单处理器下</strong>的<strong>最优静态调度算法</strong></p>
<p><strong>定义</strong></p>
<blockquote>
<ul>
<li>任务周期越小,频率越高,其优先级越高,最先调度优先级最高的任务</li>
<li>如果两个任务的优先级一样,则随机选择</li>
</ul>
</blockquote>
<h4 id="最早截止期优先EDF"><a href="#最早截止期优先EDF" class="headerlink" title="最早截止期优先EDF"></a>最早截止期优先EDF</h4><p><strong>定义</strong></p>
<blockquote>
<ul>
<li>任务截止日期越早,其优先级越高,最先调度优先级最高的任务</li>
<li>如果两个任务的优先级一样,则随机选择</li>
</ul>
</blockquote>
<h3 id="多处理机调度"><a href="#多处理机调度" class="headerlink" title="多处理机调度"></a>多处理机调度</h3><h4 id="AMP-Asymmetric-Multi-Processor-非对称多处理系统"><a href="#AMP-Asymmetric-Multi-Processor-非对称多处理系统" class="headerlink" title="AMP(Asymmetric Multi-Processor)非对称多处理系统"></a>AMP(Asymmetric Multi-Processor)非对称多处理系统</h4><p>AMP指多处理器系统中各个处理器的地位不同,不同处理器负责不同分工,比如一个执行os功能,一个执行I/O.</p>
<p>该处理系统由主处理机管理一个公共就绪队列,并分派进程给从处理器执行.</p>
<h4 id="SMP-Symmetric-Multi-Processor-对称式多处理系统"><a href="#SMP-Symmetric-Multi-Processor-对称式多处理系统" class="headerlink" title="SMP(Symmetric Multi-Processor)对称式多处理系统"></a>SMP(Symmetric Multi-Processor)对称式多处理系统</h4><p>和AMP相反,SMP中各个处理器的地位相同.</p>
<blockquote>
<ul>
<li>静态分配</li>
</ul>
</blockquote>
<p>  每个CPU设立一个就绪队列，进程从开始执行到完成，都在同一个CPU上。</p>
<blockquote>
<ul>
<li><strong>优点</strong><br>  调度算法开销小</li>
<li><strong>缺点</strong><br>  难以准确预测执行时间,容易出现忙闲不均</li>
<li><strong>动态分配</strong><br>各个CPU采用一个公共就绪队列，队首进程每次分派到当前空闲的CPU上执行。可防止系统中多个处理器忙闲不均。</li>
<li>自调度</li>
</ul>
</blockquote>
<p>  各个CPU采用一个公共就绪队列，每个处理机都可以从队列中选择适当进来执行。需要对就绪队列的数据结构进行互斥访问控制。是最常用的算法,实现时易于移植。</p>
<blockquote>
<ul>
<li><strong>优点</strong><br>  不需要专门的处理机从事任务分派工作</li>
<li><strong>缺点</strong><br>  当处理机个数较多时,对就绪队列的访问可能成为系统的瓶颈</li>
<li>成组调度</li>
</ul>
</blockquote>
<p>  将一个进程中的一组线程,每次分配时到一组处理机上执行,在剥夺处理机时也同时对这一组线程进行.</p>
<blockquote>
<ul>
<li>优点</li>
<li>通常这样的一组线程在应用逻辑上相互何做,成组调度提高了这些线程的执行并行度,有利于减少阻塞和加快推进速度,最终提高系统吞吐量.</li>
<li>每次调度可以完成多个线程的分派,在系统内线程总数相同时能够减少调度次数,从而减少调度算法的开销.</li>
<li><strong>专用处理机调度</strong><br>为进程中的每个线程都固定分配一个CPU, 直到该线程执行完成.<br>只适用于CPU数量众多的高度并行系统, 单个CPU的利用率已经不太重要.</li>
</ul>
</blockquote>
<h2 id="进程同步"><a href="#进程同步" class="headerlink" title="进程同步"></a>进程同步</h2><p>进程同步主要体现于多个进程同时访问临界区(对共享资源进行访问的程序片段).<br>其原则为:</p>
<blockquote>
<ul>
<li>空闲让进:没人在临界区则进入</li>
<li>忙则等待:有进程在临界区则等待</li>
<li>有限等待:进入临界区的进程要及时离开临界区,防止死锁</li>
<li>让权等待:进程长时间不能进入临界区则应该放出处理器,防止轮询</li>
</ul>
</blockquote>
<h3 id="基于忙等待的互斥方法"><a href="#基于忙等待的互斥方法" class="headerlink" title="基于忙等待的互斥方法"></a>基于忙等待的互斥方法</h3><h4 id="严格轮换法"><a href="#严格轮换法" class="headerlink" title="严格轮换法"></a>严格轮换法</h4><p>设立公用变量<code>turn</code>,描述允许进入临界区的进程标识.</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>){</span><br><span class="line">    <span class="keyword">while</span>(turn != <span class="number">0</span>); <span class="comment">// until the turn = 0,into  the critical region</span></span><br><span class="line">        doSomething();</span><br><span class="line">        turn = <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>

<p>问题:<br>一个进程可能被一个不在临界区的进程阻塞</p>
<h4 id="Peterson算法"><a href="#Peterson算法" class="headerlink" title="Peterson算法"></a>Peterson算法</h4><p>进入临界区判断其他进程对其有没有兴趣,如果有则等待</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">enter_region</span><span class="params">(<span class="type">int</span> process)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> other = <span class="number">1</span> &gt; - process;</span><br><span class="line"></span><br><span class="line">    interested[process] = <span class="number">1</span>;</span><br><span class="line">    turn = process;</span><br><span class="line">    <span class="keyword">while</span>(turn == process &amp;&amp; interested[other] == <span class="number">1</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>

<p>特点:<br>如果同一个时刻两个进程都进入临界区，interested和turn是竞争访问，后设置turn的进程会循环，先设置的进入</p>
<h4 id="硬件指令机制"><a href="#硬件指令机制" class="headerlink" title="硬件指令机制"></a>硬件指令机制</h4><p>Test and Set Lock指令简称TSL,执行该指令的CPU会通过锁住内存总线,禁止其他CPU访问内存<br>XCHG:原子性的交换两个位置的内容</p>
<h4 id="Bakery-Algorithm"><a href="#Bakery-Algorithm" class="headerlink" title="Bakery Algorithm"></a>Bakery Algorithm</h4><p>设置静态变量,每进入一个进程分配一个序号,如果多个进程分配到同一个序号,则根据进程号再排序.最后进程根据序号和进程号排序,最小的先进.</p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>在没有进入临界区,进程会等待,消耗CPU资源,对于这些进程应该将其阻塞,带到空闲再进入Runnable队列.</p>
<h3 id="信号量机制"><a href="#信号量机制" class="headerlink" title="信号量机制"></a>信号量机制</h3><p>信号量是一种新的变量类型 Semaphore , 只能通过初始化和标准原语 P/V 来访问, 作为OS核心代码执行, 不受进程调度打断.</p>
<blockquote>
<ul>
<li>P(s):表示将要操作共享资源</li>
</ul>
</blockquote>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(s==<span class="number">0</span>); <span class="comment">//阻塞</span></span><br><span class="line">s--;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>V(s):表示释放操作资源</li>
</ul>
</blockquote>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s++;</span><br></pre></td></tr></table></figure></div>

<p>对于不同的操作系统,初值设置可以不一样.</p>
<h4 id="互斥"><a href="#互斥" class="headerlink" title="互斥"></a>互斥</h4><p>A:P(s)→临界区→V(s)<br>B:P(s)→临界区→V(s)</p>
<h4 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h4><p>A:代码A→P(s)→代码A<br>B:代码B→V(s)<br>s初始值为0,A进程等待B完成之后才能继续进行</p>
<h4 id="汇合"><a href="#汇合" class="headerlink" title="汇合"></a>汇合</h4><p>A:a1→V(a)→P(b)→a2<br>B:b1→V(b)→P(a)→b2</p>
<h4 id="屏障"><a href="#屏障" class="headerlink" title="屏障"></a>屏障</h4><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">VAR n //numofProcess</span><br><span class="line">VAR count = 0</span><br><span class="line"></span><br><span class="line">P(a)</span><br><span class="line">count++</span><br><span class="line">V(a)</span><br><span class="line">if count == n: 直到所有进程都完成了,才能继续b操作</span><br><span class="line">    V(b)</span><br><span class="line">P(b)</span><br><span class="line">V(b)</span><br></pre></td></tr></table></figure></div>

<h4 id="多路复用"><a href="#多路复用" class="headerlink" title="多路复用"></a>多路复用</h4><p>s = n,就能保证最多n个线程同时进行</p>
<h3 id="信号量集"><a href="#信号量集" class="headerlink" title="信号量集"></a>信号量集</h3><h4 id="AND型信号量集"><a href="#AND型信号量集" class="headerlink" title="AND型信号量集"></a>AND型信号量集</h4><p><strong>基本思想</strong>: 一次性分配全部所需共享资源给进程, 待进程使用完后, 再一次性释放.</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SP (S1, S2, ..., Sn) :</span><br><span class="line">    while(1) {</span><br><span class="line">        if ( S1 &gt;= 1 &amp;&amp; S2 &gt;= 1 &amp;&amp; ... &amp;&amp; Sn &gt;= 1){}</span><br><span class="line">            S1 = S1 &gt; - 1;</span><br><span class="line">            S2 = S2 &gt; - 1;</span><br><span class="line">            ...</span><br><span class="line">            Sn = Sn &gt; - 1;</span><br><span class="line">            break;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">SV (S1, S2, ..., Sn) :</span><br><span class="line">    S1 = S1 + 1;</span><br><span class="line">    S2 = S2 + 1;</span><br><span class="line">    ...</span><br><span class="line">    Sn = Sn + 1;</span><br></pre></td></tr></table></figure></div>

<h4 id="一般信号量集"><a href="#一般信号量集" class="headerlink" title="一般信号量集"></a>一般信号量集</h4><p><strong>基本思想</strong>: 在AND型信号量集的基础上进行扩充. 进程对信号量 Si 的测试值为 ti, 占用值为 di.</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SP (S1, t1, d1, S2, t2, d2, ..., Sn, tn, dn) :</span><br><span class="line">    while(1) {</span><br><span class="line">        if (S1 &gt;= t1 &amp;&amp; S2 &gt;= t2 &amp;&amp; ... &amp;&amp; Sn &gt;= tn ){</span><br><span class="line">            S1 = S1 &gt; - d1</span><br><span class="line">            S2 = S2 &gt; - d2</span><br><span class="line">            ...</span><br><span class="line">            Sn = Sn &gt; - dn</span><br><span class="line">            break;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">SV (S1, d1, S2, d2, ..., Sn, dn) :</span><br><span class="line">    S1 = S1 + d1</span><br><span class="line">    S2 = S2 + d2</span><br><span class="line">    ...</span><br><span class="line">    Sn = Sn + dn</span><br></pre></td></tr></table></figure></div>

<h4 id="特殊情况"><a href="#特殊情况" class="headerlink" title="特殊情况"></a>特殊情况</h4><blockquote>
<ul>
<li>SP(S,d,d):表示每次申请d个资源，当资源数量少于d个时，便不<br>予分配</li>
<li>SP(S,1,1):表示互斥信号量</li>
<li>SP(S,1,0):S≥1是允许多个进程,S=1禁止任何进程</li>
</ul>
</blockquote>
<h4 id="优缺点-5"><a href="#优缺点-5" class="headerlink" title="优缺点"></a>优缺点</h4><blockquote>
<ul>
<li>优点:</li>
<li><ul>
<li>简单,表达能力强</li>
</ul>
</li>
<li>缺点:</li>
<li><ul>
<li>不够安全,可能死锁.</li>
</ul>
</li>
<li><ul>
<li>实际编程中,多个共享数据,加重了编程负担</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="管程-Monitor"><a href="#管程-Monitor" class="headerlink" title="管程(Monitor)"></a>管程(Monitor)</h3><p>为了应付信号量不够安全,和编程负担过重的问题,提出了管程用于<strong>集中分散的临界区</strong>,<strong>统一管理个进程对可共享资源的访问</strong>.</p>
<p>管程可以由函数库的形式实现,是一种高级同步原语.</p>
<p>为每个共享资源设立一个管程,由用户编写,对共享变量的访问通过其共有接口实现,有点像面向对象的思路.</p>
<h4 id="管程的实现"><a href="#管程的实现" class="headerlink" title="管程的实现"></a>管程的实现</h4><p>下面是java 对管程实现的思路</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Monitor</span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> buffer[] = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>,lo = <span class="number">0</span>,hi = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span> val)</span>{ <span class="comment">//对生产者的接口</span></span><br><span class="line">        <span class="keyword">if</span>(count == N){</span><br><span class="line">            go_to_sleep();</span><br><span class="line">        }</span><br><span class="line">        buffer[hi] = val;</span><br><span class="line">        hi = (hi+<span class="number">1</span>)%N;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">1</span>) notify();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> val)</span> { <span class="comment">//对消费者的接口</span></span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">0</span>){</span><br><span class="line">            go_to_sleep();</span><br><span class="line">        }</span><br><span class="line">        <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> buffer[lo];</span><br><span class="line">        lo = (lo+<span class="number">1</span>)%N;</span><br><span class="line">        count--;</span><br><span class="line">        <span class="keyword">if</span>(count == N-<span class="number">1</span>) notify();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div>

<p>如上面代码的思路,管程就是将零碎的共享资源进行封装,提供统一的接口进行操作,在管程里面对共享资源的操作都是互斥的.<br>管程中有如下信息:</p>
<blockquote>
<ul>
<li><strong>临界资源</strong>:管程管理的共享资源,每一个临界资源的创立都有一个对应的等待队列.</li>
<li><strong>控制变量</strong>:管程内部,用于控制进程运行状态的变量(上述代码中的N,hi,lo)</li>
<li><strong>操作原语</strong>:对控制变量和临界资源进行操作的一组代码,是提供给外部的唯一指定途径</li>
</ul>
</blockquote>
<h4 id="优缺点-6"><a href="#优缺点-6" class="headerlink" title="优缺点"></a>优缺点</h4><blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>统一管理临界资源,更加安全</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>依赖语言</li>
</ul>
</li>
<li><ul>
<li>不适用于分布式系统</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="进程通信的主要方法"><a href="#进程通信的主要方法" class="headerlink" title="进程通信的主要方法"></a>进程通信的主要方法</h3><h4 id="通信的分类"><a href="#通信的分类" class="headerlink" title="通信的分类"></a>通信的分类</h4><blockquote>
<ul>
<li>低级通信:只能传递状态和整数值</li>
<li>缺点:</li>
<li><ul>
<li>传输信息量小</li>
</ul>
</li>
<li><ul>
<li>用户直接实现通信的细节,容易出错</li>
</ul>
</li>
<li>高级通信:能够传送任意数量的数据,包括三类:管道,共享内存,信息系统</li>
<li>管道通信(Pipe):管道是用于连接读进程和写进程以实现两个进程通信的<strong>共享文件</strong>,又称管道文件.在UNIX系统中分为无名管道和有名管道</li>
</ul>
</blockquote>
<h4 id="无名管道-Pipe"><a href="#无名管道-Pipe" class="headerlink" title="无名管道(Pipe)"></a>无名管道(Pipe)</h4><p>该管道是单向管道,数据只能向一个方向流动,而且该管道只能用于父子进程和兄弟进程之间.单独构成一种<strong>独立的文件系统</strong></p>
<blockquote>
<p>管道对于管道两端的进程而言，就是一个文件，但它不是普通的文件，它不属于某种文件系统，而是自立门户，单独构成一种文件系统，并且只<strong>存在在内存中</strong>。</p>
</blockquote>
<p>数据的读出和写入:</p>
<blockquote>
<p>一个进程向管道中写的内容被管道另一端的进程读出。写入的内容每次都添加在管道缓冲区的末尾，并且每次都是从缓冲区的头部读出数据。</p>
</blockquote>
<p>由此可见,两个进程对管道文件的权限不同,一个只读,一个只写(无名管道是<strong>单向管道</strong>)</p>
<h4 id="有名管道-Named-Pipe-或-FIFO"><a href="#有名管道-Named-Pipe-或-FIFO" class="headerlink" title="有名管道(Named Pipe 或 FIFO)"></a>有名管道(Named Pipe 或 FIFO)</h4><p>有名管道克服了无名管道只能用于亲缘关系之间通信的问题.</p>
<p>该管道通过提供一个路径名与之关联,只要通过访问该路径,就能凭借该管道通信.</p>
<p>该管道对于不同进程的数据管理是FIFO,先进先出.</p>
<h4 id="信息传递"><a href="#信息传递" class="headerlink" title="信息传递"></a>信息传递</h4><p>信息传递的方式提供了两个通信原语(是一个系统调用):</p>
<blockquote>
<ul>
<li><code>send(destination,&amp;message)</code></li>
<li><code>receive(source,&amp;message)</code></li>
</ul>
</blockquote>
<p><strong>调用方式</strong>:</p>
<blockquote>
<ul>
<li>阻塞调用</li>
<li>非阻塞调用(maybe内核线程)</li>
</ul>
</blockquote>
<p><strong>主要问题</strong>:</p>
<blockquote>
<ul>
<li>解决信息丢失,延迟问题</li>
<li>编址问题</li>
</ul>
</blockquote>
<p><strong>传递过程</strong>:<br>调用send()之后,首先<strong>陷入内核态</strong>,然后<strong>复制message于消息缓冲区</strong>.之后将消息缓冲区<strong>挂载到接受进程的消息队列</strong>.之后调用receive()函数则将消息队列的消息<strong>复制</strong>过来.</p>
<h4 id="共享内存"><a href="#共享内存" class="headerlink" title="共享内存"></a>共享内存</h4><p>该方式是最有用的进程通信方式,因为省去了开销很大的缓冲复制过程.</p>
<p>共享内存意味着同一块物理内存被映射到了两个不同进程的进程地址空间.通过信号量等方法实现共享内存的互斥和同步.</p>
<h3 id="经典进程同步问题"><a href="#经典进程同步问题" class="headerlink" title="经典进程同步问题"></a>经典进程同步问题</h3><h4 id="生产者消费者模型"><a href="#生产者消费者模型" class="headerlink" title="生产者消费者模型"></a>生产者消费者模型</h4><p>基础生产者消费者问题:</p>
<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SEMAPHORE</span> full = <span class="number">0</span></span><br><span class="line"><span class="variable constant_">SEMAPHORE</span> empty = N</span><br><span class="line"><span class="variable constant_">SEMAPHORE</span> mutex = <span class="number">1</span>         <span class="comment">// protect buffer</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">VAR</span> buffer[N]</span><br><span class="line"><span class="variable constant_">VAR</span> buf_in = <span class="number">0</span></span><br><span class="line"><span class="variable constant_">VAR</span> buf_out = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">PRODUCER</span> () :</span><br><span class="line">    <span class="variable constant_">WHILE</span> <span class="variable constant_">TRUE</span> :</span><br><span class="line">        next = <span class="comment">// produce `next` //</span></span><br><span class="line">        <span class="title function_">P</span>(empty)</span><br><span class="line">        <span class="title function_">P</span>(mutex)</span><br><span class="line">        buffer[buf_in] = next</span><br><span class="line">        buf_in = (buf_in + <span class="number">1</span>) % N</span><br><span class="line">        <span class="title function_">V</span>(mutex)</span><br><span class="line">        <span class="title function_">V</span>(full)</span><br><span class="line"><span class="variable constant_">CONSUMER</span> () :</span><br><span class="line">    <span class="variable constant_">WHILE</span> <span class="variable constant_">TRUE</span> :</span><br><span class="line">        <span class="title function_">P</span>(full)</span><br><span class="line">        <span class="title function_">P</span>(mutex)</span><br><span class="line">        next = buffer[buf_out]</span><br><span class="line">        buf_out = (buf_out + <span class="number">1</span>) % N</span><br><span class="line">        <span class="title function_">V</span>(mutex)</span><br><span class="line">        <span class="title function_">V</span>(empty)</span><br><span class="line">        <span class="comment">// consume `next` //</span></span><br></pre></td></tr></table></figure></div>

<p>扩展问题:设有一个可以装A, B两种物品的仓库, 其容量无限大, 但要求仓库中A, B两种物品的数量 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.345ex;" xmlns="http://www.w3.org/2000/svg" width="3.005ex" height="1.94ex" role="img" focusable="false" viewBox="0 -705 1328.3 857.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(748,-152.7) scale(0.707)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></g></svg></mjx-container> 和 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="3.02ex" height="1.934ex" role="img" focusable="false" viewBox="0 -705 1334.7 855"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(748,-150) scale(0.707)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g></g></g></g></svg></mjx-container> 满足下述不等式:</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="34.287ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 15154.8 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(2106.8,0)"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="msub" transform="translate(3162.6,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(748,-152.7) scale(0.707)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g><g data-mml-node="mo" transform="translate(4713.1,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(5713.3,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(748,-150) scale(0.707)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g></g><g data-mml-node="mo" transform="translate(7325.8,0)"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mi" transform="translate(8381.6,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(9269.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(9658.6,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(10709.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(11154.2,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(12320,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path></g><g data-mml-node="mi" transform="translate(13264.8,0)"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mo" transform="translate(13987.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(14765.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p>
<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SEMAPHORE</span> mutex = <span class="number">1</span></span><br><span class="line"><span class="variable constant_">SEMAPHORE</span> sem_a = N</span><br><span class="line"><span class="variable constant_">SEMAPHORE</span> sem_b = M</span><br><span class="line"></span><br><span class="line">A () :</span><br><span class="line">    <span class="variable constant_">WHILE</span> <span class="variable constant_">TRUE</span> :</span><br><span class="line">        <span class="title function_">P</span>(sem_a)   </span><br><span class="line">        <span class="title function_">P</span>(mutex)</span><br><span class="line">        <span class="comment">// A --&gt; warehouse //</span></span><br><span class="line">        <span class="title function_">V</span>(mutex)</span><br><span class="line">        <span class="title function_">V</span>(sem_b) <span class="comment">//增加B的上限</span></span><br><span class="line">B () :</span><br><span class="line">    <span class="variable constant_">WHILE</span> <span class="variable constant_">TRUE</span> :</span><br><span class="line">        <span class="title function_">P</span>(sem_b)</span><br><span class="line">        <span class="title function_">P</span>(mutex)</span><br><span class="line">        <span class="comment">// B --&gt; warehouse //</span></span><br><span class="line">        <span class="title function_">V</span>(mutex)</span><br><span class="line">        <span class="title function_">V</span>(sem_a)</span><br></pre></td></tr></table></figure></div>

<h4 id="读者写者问题"><a href="#读者写者问题" class="headerlink" title="读者写者问题"></a>读者写者问题</h4><p>读者优先:</p>
<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">int readers = <span class="number">0</span></span><br><span class="line"><span class="title class_">Semaphore</span> mutex = <span class="number">1</span> <span class="comment">//互斥</span></span><br><span class="line"><span class="title class_">Semaphore</span> roomEmpty = <span class="number">1</span> <span class="comment">//是否能容下其他人</span></span><br><span class="line"><span class="title class_">Semaphore</span> turnstile = <span class="number">1</span> <span class="comment">//闸机控制</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Reader</span>:</span><br><span class="line"><span class="comment">//进入</span></span><br><span class="line"><span class="title function_">P</span>(turnstile)</span><br><span class="line"><span class="title function_">V</span>(turnstile)</span><br><span class="line"><span class="title function_">P</span>(mutex)</span><br><span class="line">    readers ++;</span><br><span class="line">    <span class="keyword">if</span> readers == <span class="number">1</span>:</span><br><span class="line">        <span class="title function_">P</span>(roomEmpty) <span class="comment">//不允许写者进入</span></span><br><span class="line"><span class="title function_">V</span>(mutex)</span><br><span class="line"><span class="comment">//read critical region</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//离开</span></span><br><span class="line"><span class="title function_">P</span>(mutex)</span><br><span class="line">    readers--</span><br><span class="line">    <span class="keyword">if</span> readers == <span class="number">0</span>:</span><br><span class="line">        <span class="title function_">V</span>(roomEmpty)</span><br><span class="line"><span class="title function_">V</span>(mutex)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Writer</span>:</span><br><span class="line"><span class="title function_">P</span>(turnstile) <span class="comment">//禁止其他读者进入</span></span><br><span class="line">    <span class="title function_">P</span>(roomEmpty) <span class="comment">//等待里面的读者出来</span></span><br><span class="line">    <span class="comment">//write critical region</span></span><br><span class="line"><span class="title function_">V</span>(roomEmpty)</span><br><span class="line"><span class="title function_">V</span>(turnstile)</span><br></pre></td></tr></table></figure></div>

<p>公平</p>
<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">int readers = <span class="number">0</span></span><br><span class="line"><span class="title class_">Semaphore</span> roomEmpty = <span class="number">1</span> <span class="comment">//是否能容下其他人</span></span><br><span class="line"><span class="title class_">Semaphore</span> turnstile = <span class="number">1</span> <span class="comment">//闸机控制</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Reader</span>:</span><br><span class="line"><span class="comment">//进入</span></span><br><span class="line"><span class="title function_">P</span>(turnstile)</span><br><span class="line"><span class="title function_">V</span>(turnstile)</span><br><span class="line"><span class="title function_">P</span>(roomEmpty)</span><br><span class="line"><span class="comment">//read critical region</span></span><br><span class="line"><span class="title function_">V</span>(roomEmpty)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Writer</span>:</span><br><span class="line"><span class="title function_">P</span>(turnstile) <span class="comment">//禁止其他读者进入</span></span><br><span class="line">    <span class="title function_">P</span>(roomEmpty) <span class="comment">//等待里面的读者出来</span></span><br><span class="line">    <span class="comment">//write critical region</span></span><br><span class="line"><span class="title function_">V</span>(roomEmpty)</span><br><span class="line"><span class="title function_">V</span>(turnstile)</span><br></pre></td></tr></table></figure></div>

<h2 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h2><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><p><strong>死锁</strong>:如果一个进程集合中的<strong>每个进程</strong>都在等待只能由该进程集合中其他进程才能<strong>引发的事件</strong>，那么该进程集合就是死锁的。</p>
<p><strong>资源死锁</strong>:如果<strong>每个进程</strong>等待的事件是释放该进程集合中其他进程所占有的<strong>资源</strong>。</p>
<h3 id="必要条件"><a href="#必要条件" class="headerlink" title="必要条件"></a>必要条件</h3><blockquote>
<ul>
<li><strong>互斥条件</strong>:指进程对所分配到的资源进行排他性使用,即在一段时间内资源只能有一个进程占用</li>
<li><strong>保持和请求条件</strong>:已经获得资源的线程可以请求新的资源</li>
<li><strong>不剥夺条件</strong>:指进程已获得的资源,再未使用完之前不能被强制剥夺,只能在使用完时由自己释放</li>
<li><strong>环路等待条件</strong>:指在发生死锁时,必然存在两个或多个进程组成的环形链,每个进程都在等待环形链中下一个节点占用的资源.</li>
</ul>
</blockquote>
<h3 id="死锁处理方法"><a href="#死锁处理方法" class="headerlink" title="死锁处理方法"></a>死锁处理方法</h3><h4 id="鸵鸟算法"><a href="#鸵鸟算法" class="headerlink" title="鸵鸟算法"></a>鸵鸟算法</h4><p>OS无所作为,全部交给程序员来负责</p>
<h4 id="死锁检测与死锁恢复"><a href="#死锁检测与死锁恢复" class="headerlink" title="死锁检测与死锁恢复"></a>死锁检测与死锁恢复</h4><p>允许死锁发生,当检测死锁放生之后,采取措施恢复<br>死锁检测算法:</p>
<blockquote>
<ul>
<li>基于资源分配图,每类一个资源</li>
<li>基于资源向量计算,每类多个资源</li>
</ul>
</blockquote>
<h4 id="死锁预防"><a href="#死锁预防" class="headerlink" title="死锁预防"></a>死锁预防</h4><p>破坏死锁的四个必要条件.</p>
<h4 id="死锁避免"><a href="#死锁避免" class="headerlink" title="死锁避免"></a>死锁避免</h4><p>在资源分配之前判断是否安全,仅当安全才进行分配.需要依赖执行前获取额外信息.</p>
<h3 id="资源分配图"><a href="#资源分配图" class="headerlink" title="资源分配图"></a>资源分配图</h3><p>每类资源一个的死锁检测<br>按照资源请求和释放的序列对图进行操作，并在每步操作后检查是否存在环。<br>可用作分析是否存在死锁的工具</p>
<h3 id="资源向量计算"><a href="#资源向量计算" class="headerlink" title="资源向量计算"></a>资源向量计算</h3><p>矩阵介绍:</p>
<blockquote>
<ul>
<li>E:存在资源向量:表示每类资源的总量</li>
<li>A:可用资源向量:表示当前未分配可使用的资源数</li>
<li>C:当前分配矩阵:表示第i个行向量对应第i个进程已经分配到的各类资源数量</li>
<li>R:请求矩阵:第i个行向量表示进程i所需要的资源数量<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.666ex;" xmlns="http://www.w3.org/2000/svg" width="16.626ex" height="2.363ex" role="img" focusable="false" viewBox="0 -750 7348.6 1044.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="msub" transform="translate(1222.7,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="TeXAtom" transform="translate(748,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(345,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2778.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(3778.4,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(783,-150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g><g data-mml-node="mo" transform="translate(5180.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(6236.3,0)"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g><g data-mml-node="mi" transform="translate(771,-150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g></g></svg></mjx-container></li>
</ul>
</blockquote>
<p>算法步骤:</p>
<blockquote>
<ul>
<li>寻找进程<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.192ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 969 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(675,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>,其在R矩阵中对应的第i行小于等于A</li>
<li>如果找到,将C矩阵的第i行加入A,标记该进程执行完毕,转到第一步</li>
<li>如果找不到,结束</li>
</ul>
</blockquote>
<h3 id="死锁恢复"><a href="#死锁恢复" class="headerlink" title="死锁恢复"></a>死锁恢复</h3><blockquote>
<ul>
<li>资源抢占法:<br>挂起一些占有资源的进程，剥夺它们的资源以解除死锁，将资源分配给另一个死锁进程使其能够执行完毕，然后再激活被挂起的进程</li>
<li>杀死进程法:</li>
<li>杀死一个或者若干个进程,杀死的线程应该是重新执行无副作用的进程,根据资源情况,杀死环内或者环外的进程</li>
<li>回滚法:</li>
<li>设置检查点,根据死锁时所需要的资源,将一个拥有资源的进程滚回一个未占用资源的检查点状态,从而使得其他死锁进程能够获得响应的资源</li>
</ul>
</blockquote>
<h3 id="死锁预防-1"><a href="#死锁预防-1" class="headerlink" title="死锁预防"></a>死锁预防</h3><blockquote>
<ul>
<li><strong>打破互斥</strong>:允许进程同时访问某些资源</li>
<li><strong>打破保持和请求条件</strong>:在进程开始执行前请求所需的全部资源。只有当系统能够满足当前进程的全部资源需求时，才一次性地将所申请的资源全部分配给该进程，否则不分配任何资源。或者请求之前先释放资源,再尝试获得所有资源</li>
<li>缺点:</li>
<li><ul>
<li>资源不可预测</li>
</ul>
</li>
<li><ul>
<li>资源利用率低</li>
</ul>
</li>
<li><ul>
<li>降低进程并发</li>
</ul>
</li>
<li><strong>打破不可抢占条件</strong>:<br>允许进程强行从占有者哪里夺取那些资源.</li>
<li><strong>打破循环等待条件</strong>:实行资源有序分配策略。即把资源事先分类编号，所有进程对资源的请求必须严格按资源序号递增的顺序提出，使进程在申请，占用资源时不会形成环路，从而预防了死锁。</li>
<li>缺点:增加开销,增加了进程对资源的占用时间</li>
</ul>
</blockquote>
<h3 id="哲学家就餐问题"><a href="#哲学家就餐问题" class="headerlink" title="哲学家就餐问题"></a>哲学家就餐问题</h3><p>5个哲学家围绕一张圆桌而坐，桌子上放着5支筷子(叉子)，每两个哲学家之间放一支；哲学家必须拿到左右两只筷子才能吃饭。<br><strong>方法</strong>:</p>
<blockquote>
<ul>
<li>破除循环等待:</li>
<li><ul>
<li>至多允许四个哲学家同时拿起筷子,保证至少一个哲学家就餐.</li>
</ul>
</li>
<li><ul>
<li>奇数号哲学家先拿左再拿右,偶数人反之</li>
</ul>
</li>
<li><ul>
<li>同时拿起两根筷子,或者不拿起</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h1><h2 id="I-x2F-O硬件"><a href="#I-x2F-O硬件" class="headerlink" title="I/O硬件"></a>I/O硬件</h2><h3 id="总线"><a href="#总线" class="headerlink" title="总线"></a>总线</h3><p>这是在对总线的抽象,<code>CPU</code>,<code>Memory</code>,<code>I/O</code>部件挂载在总线上,通过总线交流</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/Bus.drawio.svg"
                      alt="Bus"
                ></p>
<p><strong>Bus</strong></p>
<p>地址总线传递地址，数据总线传递数据，控制总线传递控制信号。<br>以<code>CPU</code>读入数据为例,<code>CPU</code>发出请求,<code>address bus</code>传递地址,读到的数据通过<code>data bus</code>传递给<code>CPU</code>。</p>
<h3 id="I-x2F-O系统"><a href="#I-x2F-O系统" class="headerlink" title="I/O系统"></a>I/O系统</h3><p>这是对<code>I/O</code>的抽象,可见<code>I/O</code>被拆分开,<code>channel processor</code>可以看成分发器,<code>System Bus</code>传来的请求在这里处理,然后发送信号到<code>I/O bus</code>,控制不同的<code>I/O</code>设备.<br><strong>IO</strong>:<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/IO_bus.svg"
                      alt="IO"
                ></p>
<p><code>I/O Bus</code>连接了不同的<code>I/O</code>设备,不同<code>I/O</code>设备的传输数量差了很多倍数量级,键盘打字的速度再快也比不上硬盘的读入,因此,需要对不同设备分别管理.</p>
<h3 id="I-x2F-O设备与管理"><a href="#I-x2F-O设备与管理" class="headerlink" title="I/O设备与管理"></a>I/O设备与管理</h3><h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p><strong>按照类型分类</strong>:</p>
<blockquote>
<ul>
<li>传输速度不同:低俗设备,中速设备,高速设备</li>
<li>数据组织不同:</li>
<li><ul>
<li>块设备:以数据块为单位存储、传输信息。传输速率较高、可寻址(随机读写)</li>
</ul>
</li>
<li><ul>
<li>字符设备:以字符为单位存储、传输信息。传输速率低、不可寻址。</li>
</ul>
</li>
<li>共享属性不同:</li>
<li><ul>
<li>独占设备:一次只能由一个进程访问,比如打印机</li>
</ul>
</li>
<li><ul>
<li>共享设备:可以多个进程访问的设备</li>
</ul>
</li>
<li><ul>
<li>虚拟设备:在一类设备上模拟另一类设备，常用的方法是，用共享设备模拟独占设备，用高速设备模拟低速设备。</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="设备管理-1"><a href="#设备管理-1" class="headerlink" title="设备管理"></a>设备管理</h4><p><strong>目标</strong>:</p>
<blockquote>
<ul>
<li>按照请求,操作设备,完成数据交换,最终完成用户请求</li>
<li>建立方便,统一的独立于设备的接口(抽象)</li>
<li>充分利用技术,提高CPU与设备,设备与设备之间的并行工作能力,提高利用率</li>
<li>保护信息</li>
</ul>
</blockquote>
<h3 id="设备控制器"><a href="#设备控制器" class="headerlink" title="设备控制器"></a>设备控制器</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/IO_Controller.svg"
                      alt="设备控制器"
                ></p>
<p><strong>设备控制器</strong></p>
<h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><blockquote>
<ul>
<li>接收和识别CPU给来的命令</li>
<li>数据交换：CPU与控制器、控制器与设备</li>
<li>设备状态的了解和报告</li>
<li>设备地址识别</li>
<li>缓冲区</li>
<li>对设备传来的数据进行差错检测</li>
</ul>
</blockquote>
<h4 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h4><blockquote>
<ul>
<li>控制器与<code>CPU</code>的接口: 数据寄存器,控制寄存器,状态寄存器,采用内存映射或专门的<code>I/O</code>指令</li>
<li>控制器与设备的接口: 数据信号,控制信号,状态信号</li>
<li><code>I/O</code>逻辑: 用于实现<code>CPU</code>对<code>I/O</code>设备控制</li>
</ul>
</blockquote>
<h3 id="I-x2F-O端口地址"><a href="#I-x2F-O端口地址" class="headerlink" title="I/O端口地址"></a>I/O端口地址</h3><p><code>I/O</code>端口地址指的是接口电路中每个寄存器具有唯一的地址</p>
<p>每个设备的<code>I/O</code>端口地址形成<code>I/O</code>地址空间,由OS保护</p>
<p><code>I/O</code>指令形式和<code>I/O</code>地址相关联,分类如下:</p>
<blockquote>
<ul>
<li>内存映像编址(内存映像<code>I/O</code>模式):</li>
<li><ul>
<li>控制器的寄存器作为物理空间的一部分,可以直接通过地址访问</li>
</ul>
</li>
<li><code>I/O</code>独立编址(<code>I/O</code>专用指令):</li>
<li><ul>
<li>由专门的指令访问<code>I/O</code>端口,就像<code>CP0</code>中的寄存器通过<code>mfc0,mtc0</code>访问类似,<code>add</code>等指令无法访问<code>CP0</code>寄存器,<code>intel</code>架构中有<code>in/out</code>指令</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="内存映像I-O模式特点"><a href="#内存映像I-O模式特点" class="headerlink" title="内存映像I/O模式特点:"></a>内存映像<code>I/O</code>模式特点:</h4><p><strong>优点</strong>:</p>
<blockquote>
<ul>
<li>不需要特殊的保护机制来组织用于进程访问,只需要当成内核地址一样即可.</li>
<li>不需要额外指令集,减轻编程负担</li>
</ul>
</blockquote>
<p><strong>缺点</strong>:</p>
<blockquote>
<ul>
<li>不允许把控制寄存器放入高速缓存,因为该寄存器的值会改变</li>
</ul>
</blockquote>
<h4 id="I-O独立编址特点"><a href="#I-O独立编址特点" class="headerlink" title="I/O独立编址特点:"></a><code>I/O</code>独立编址特点:</h4><p><strong>优点</strong>:</p>
<blockquote>
<ul>
<li>外设不占用地址空间</li>
<li>编程时易区分是对内存操作还是<code>I/O</code>操作</li>
</ul>
</blockquote>
<p><strong>缺点</strong>:</p>
<blockquote>
<ul>
<li><code>I/O</code>指令少,操作不灵活</li>
</ul>
</blockquote>
<h3 id="I-x2F-O控制方式"><a href="#I-x2F-O控制方式" class="headerlink" title="I/O控制方式"></a>I/O控制方式</h3><blockquote>
<ul>
<li>程序控制<code>I/O</code>:也称轮询或者查询方式<code>I/O</code>.</li>
<li>中断驱动:当<code>I/O</code>操作结束后由设备控制器主动来通知驱动程序说这次结束.</li>
<li><code>DMA(Direct Memory Access)</code>:直接存储器访问方式,由一个专门的控制器完成数据到内存和设备或者是从设备到内存的传输工作</li>
<li>通道:与<code>DMA</code>很类似,但是<code>DMA</code>依然离不开<code>CPU</code>,需要<code>CPU</code>的控制信号,通道则更加独立.它有自己的指令和程序专门负责数据输入输出的传输控制.CPU将“传输控制”的功能下放给通道后只负责“数据处理”功能.这样,通道与CPU分时使用内存，实现了CPU内部运算与I/O设备的并行工作.</li>
</ul>
</blockquote>
<h4 id="程序控制I-O"><a href="#程序控制I-O" class="headerlink" title="程序控制I/O"></a>程序控制<code>I/O</code></h4><p>  <strong>程序控制I/O</strong>:<br>  <img src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6IO.svg" alt="程序控制I/O"></p>
<h4 id="中断驱动"><a href="#中断驱动" class="headerlink" title="中断驱动"></a>中断驱动</h4><p>  <strong>中断驱动</strong>:<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/%E4%B8%AD%E6%96%AD%E9%A9%B1%E5%8A%A8.svg"
                      alt="中断驱动"
                ></p>
<h4 id="DMA"><a href="#DMA" class="headerlink" title="DMA"></a>DMA</h4><blockquote>
<ul>
<li>命令/状态寄存器(<code>CR</code>):用于接受从CPU发送来的I/O命令,或有关控制信息,或设备状态.</li>
<li>内存地址寄存器(<code>MAR</code>):在输入时,它存放把数据从设备传送到内存的起始目标地址,在输出的时候,它存方由内存到设备的内存源地址.</li>
<li>数据寄存器(<code>DR</code>):用于暂存从设备到内存,或从内存到设备的数据.</li>
<li>数据计数器(<code>DC</code>):存放本次<code>CPU</code>要读或写的字节数.<br><strong>DMA</strong>:<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/DMA.svg"
                      alt="DMA"
                ></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>优点:</li>
<li><ul>
<li><code>CPU</code>只需要干预<code>I/O</code>操作的开始和结束,后续数据读写无需CPU控制</li>
</ul>
</li>
<li>缺点:</li>
<li><ul>
<li>数据传输方向,地址,数据大小都由CPU控制,占用<code>CPU</code>时间</li>
</ul>
</li>
<li><ul>
<li>每个设备占用一个<code>DMA</code>控制器,当设备增加的时候,需要增加新的<code>DMA</code>控制器</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="I-x2F-O通道"><a href="#I-x2F-O通道" class="headerlink" title="I/O通道"></a>I/O通道</h4><p><strong>基本思想</strong>:<br>进一步减少<code>CPU</code>的干预.</p>
<p><code>I/O</code>通道有自己的处理器和指令体系,独立于<code>CPU</code>,可进行更复杂的<code>I/O</code>控制.通道程序通常由操作系统构造,放在内存.</p>
<blockquote>
<ul>
<li>优点:</li>
<li><ul>
<li>执行一个通道程序可以完成机组I/O操作,减少<code>CPU</code>干预.</li>
</ul>
</li>
<li>缺点:</li>
<li><ul>
<li>费用高</li>
</ul>
</li>
</ul>
</blockquote>
<p><strong>I/O通道分类</strong></p>
<blockquote>
<ul>
<li>字节多路通道</li>
<li>以字节为单位交叉工作:当为一台设备传送一个字节后,立即转去为另一台设备传送一个字节,是用于低速或中速<code>I/O</code>设备.</li>
<li>选择通道</li>
<li>以组方式工作:每次传送一批数据,传送速率很高,但一段时间只能为一个设备服务.当当前<code>I/O</code>请求处理完之后,就选择另一台设备服务,适用于高速设备.</li>
<li>数组多路通道</li>
<li>综合字节多路通道<strong>分时工作</strong>和<strong>选择通道</strong>传输速率高的特点,实质是:对通道程序采用多道程序设计技术,使得与通道连接而设备可以并行工作.</li>
</ul>
</blockquote>
<h4 id="DMA与通道区别"><a href="#DMA与通道区别" class="headerlink" title="DMA与通道区别"></a>DMA与通道区别</h4><blockquote>
<ul>
<li>通道更加独立,<code>DMA</code>数据传输方向,地址,大小还脱离不了<code>CPU</code>,通道则有自己的指令体系,执行通道程序就能实现对数据传输控制.</li>
<li>DMA通常只能控制一台或者少数几台同类设备,而一个通道可以同时控制多种设备</li>
</ul>
</blockquote>
<h2 id="I-x2F-O软件"><a href="#I-x2F-O软件" class="headerlink" title="I/O软件"></a>I/O软件</h2><p><strong>层次关系</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/%E5%B1%82%E6%AC%A1%E5%85%B3%E7%B3%BB.svg"
                      alt="层次关系"
                ></p>
<h3 id="设备独立性"><a href="#设备独立性" class="headerlink" title="设备独立性"></a>设备独立性</h3><p>类似于逻辑地址和物理地址的结构,对于设备而言也有逻辑设备和物理设备.应用程序访问的是逻辑设备,经过逻辑设备表转换为物理设备.这样的好处是:</p>
<blockquote>
<ul>
<li>设备分配的灵活性:当计算机连接多台相同设备的时候,如果进程直接访问物理设备,而该物理设备繁忙,那么就会阻塞.如果访问逻辑设备,则是请求的一类设备,由<code>OS</code>完成分配.</li>
<li>易于<code>I/O</code>重定向,用于<code>I/O</code>操作的设备通过修改逻辑设备表即可实现更换,而不需要更换应用程序,同时也提升了程序的可移植性</li>
</ul>
</blockquote>
<h3 id="逻辑设备表-LUT"><a href="#逻辑设备表-LUT" class="headerlink" title="逻辑设备表(LUT)"></a>逻辑设备表(LUT)</h3><p>为了实现设备独立性,系统设置的一张由逻辑设备映射到物理设备的表,该表表项包含三项:<strong>逻辑设备名</strong>,<strong>物理设备名</strong>,<strong>驱动程序入口地址</strong>.</p>
<p><code>LUT</code>的设置课采用两种方式:</p>
<blockquote>
<ul>
<li>整个系统设置一张<code>LUT</code>:该表中不能出现重复的逻辑设备名,因此用户不能使用相同的逻辑设备名(保证用户的独立性)</li>
<li>每个用户一张<code>LUT</code>:每个用户登录时,便为该用户建立一个进程,同时设置一张<code>LUT</code>放入进程的<code>PCB</code>中.</li>
</ul>
</blockquote>
<h3 id="设备驱动程序"><a href="#设备驱动程序" class="headerlink" title="设备驱动程序"></a>设备驱动程序</h3><p>与设备密切相关的代码放在设备驱动程序中,<strong>每个设备驱动程序处理一种设备类型</strong>.<br>设备驱动程序的任务时<strong>接受来自于设备无关的上层软件的抽象请求</strong>,并执行请求.<br>每一个控制器都设有一个或多个设备寄存器,用于存放向设备发送的命令和参数,<strong>设备驱动程序负责释放这些命令,监督正确执行</strong>.<br>它是I/O设备和设备控制器之间的通信程序<br>驱动程序与I/O设备的<strong>特性</strong>,<strong>控制方式</strong>,<strong>硬件</strong>密切相关,特殊优化.</p>
<h4 id="设备驱动程序的组成"><a href="#设备驱动程序的组成" class="headerlink" title="设备驱动程序的组成"></a>设备驱动程序的组成</h4><blockquote>
<ul>
<li><strong>自动配置和初始化子程序</strong>:检测对应的硬件设备是否存在且正常,并完成对该设备及其相关设备驱动程序所需要的软件状态的初始化.在初始化时被调用一次</li>
<li><strong>I/O操作子程序</strong>:调用该子程序是系统调用的结果,执行该部分程序时仍属于调用它的进程,只是进入了核心态.</li>
<li><strong>中断服务子程序</strong>:系统来接受系统中断,再有系统调用中断服务子程序.因为设备驱动程序一般支持同一类型的若干设备,所以一般在系统调用中断服务子程序的时候,都带有一个或多个参数,以标识请求服务的设备.</li>
</ul>
</blockquote>
<h4 id="设备驱动属于内核"><a href="#设备驱动属于内核" class="headerlink" title="设备驱动属于内核"></a>设备驱动属于内核</h4><p>前面提到,<strong>设备驱动是系统调用的结果</strong>,因此,设备驱动享有内核的一切服务和责任,包括:</p>
<blockquote>
<ul>
<li>设备驱动时内核的一部分,出错将导致系统的严重错误</li>
<li>设备驱动必须为内核提供一个标准接口</li>
<li><ul>
<li>驱动程序初始化函数</li>
</ul>
</li>
<li><ul>
<li>驱动卸载函数,申请设备函数,释放设备函数</li>
</ul>
</li>
<li><ul>
<li><code>I/O</code>操作函数</li>
</ul>
</li>
<li><ul>
<li>中断处理函数</li>
</ul>
</li>
<li>可以使用内核服务,如内存分配,中断发送,等待队列</li>
<li>动态可加载</li>
</ul>
</blockquote>
<h3 id="I-x2F-O缓冲管理"><a href="#I-x2F-O缓冲管理" class="headerlink" title="I/O缓冲管理"></a>I/O缓冲管理</h3><p>缓冲技术可提高外设利用率</p>
<blockquote>
<ul>
<li>匹配<code>CPU</code>和外设的不同处理速度</li>
<li>减少对<code>CPU</code>的中断次数</li>
<li>提高<code>CPU</code>和<code>I/O</code>设备之间的并行性</li>
</ul>
</blockquote>
<h4 id="单缓冲-Single-Buffer"><a href="#单缓冲-Single-Buffer" class="headerlink" title="单缓冲(Single Buffer)"></a>单缓冲(Single Buffer)</h4><p>每当用户进程发出一个I/O请求时,操作系统便在<strong>主存</strong>之中分配一个缓冲区,因为<code>CPU</code>和<code>I/O</code>之间并行,因此数据处理时间为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="16.091ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7112.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1051,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1580,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(2152,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2541,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(3301,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(3745.7,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(4449.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5060.9,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6061.1,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g></svg></mjx-container></p>
<p><strong>单缓冲</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/single_buffer.svg"
                      alt="单缓冲"
                ></p>
<h4 id="双缓冲-Double-Buffer"><a href="#双缓冲-Double-Buffer" class="headerlink" title="双缓冲(Double Buffer)"></a>双缓冲(Double Buffer)</h4><p>两个缓冲区,<code>CPU</code>和外设都可以连续处理而无需等待对方.要求<code>CPU</code>和外设的速度相近.在双缓冲时,系统处理一块数据的时间可以粗略认为是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="16.091ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7112.1 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1051,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1580,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(2152,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2541,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(3523.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(4523.4,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(5574.4,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(6019.1,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(6723.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>,如果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.09ex;" xmlns="http://www.w3.org/2000/svg" width="6.329ex" height="1.686ex" role="img" focusable="false" viewBox="0 -705 2797.6 745"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="mi" transform="translate(2093.6,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></svg></mjx-container>,可使块设备连续输入,如果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.09ex;" xmlns="http://www.w3.org/2000/svg" width="6.329ex" height="1.686ex" role="img" focusable="false" viewBox="0 -705 2797.6 745"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path></g><g data-mml-node="mi" transform="translate(2093.6,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></svg></mjx-container>,则可是CPU不必等待设备输入</p>
<p><strong>双缓冲</strong>:<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/double_buffer.svg"
                      alt="双缓冲"
                ></p>
<h4 id="环形缓冲-Circular-Buffer"><a href="#环形缓冲-Circular-Buffer" class="headerlink" title="环形缓冲(Circular Buffer)"></a>环形缓冲(Circular Buffer)</h4><p>针对<code>CPU</code>和外设处理速度差较大,引入环形缓冲,可将多个缓冲组织成循环缓冲形式.<br><strong>组成</strong>:</p>
<blockquote>
<ul>
<li>多个缓冲区:在循环中有多个大小相同的缓冲区.缓冲区可分为三类:<strong>空缓冲区R</strong>,<strong>满缓冲区G</strong>,计算机进程<strong>正在使用的空缓冲区C</strong>.</li>
<li>多个指针:作为输入的缓冲区可设置三个指针,指示计算进程下一个可用缓冲区G的<strong>指针Nextg</strong>,指示输入进程下一个可用的空缓冲区R的<strong>指针Nexti</strong>,指示计算进程正在使用的缓冲区C的指针<strong>Current</strong></li>
</ul>
</blockquote>
<h4 id="缓冲池"><a href="#缓冲池" class="headerlink" title="缓冲池"></a>缓冲池</h4><p>当系统较大的时候,不可能给每一个进程开一个缓冲区,这会消耗大量内存,因此为了提高利用率,引入了缓冲池,池中设置了多个可供若干个进程共享的缓冲区.池内至少有下面三种缓冲区:</p>
<blockquote>
<ul>
<li>空闲缓冲区,其形成的队列叫做<code>emq</code></li>
<li>装满输入数据的缓冲区,其形成的队列叫做<code>inq</code></li>
<li>装满输出数据的缓冲区,其形成的队列叫做<code>outq</code></li>
</ul>
</blockquote>
<p><strong>缓冲池</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/buffer_pool.svg"
                      alt="缓冲池"
                ></p>
<h3 id="I-x2F-O设备管理"><a href="#I-x2F-O设备管理" class="headerlink" title="I/O设备管理"></a>I/O设备管理</h3><p>由于外设资源有限,需解决进程间的外设共享问题,以提高外设资源的利用率,有常见一下两种做法:</p>
<blockquote>
<ul>
<li>在进程间切换使用外设</li>
<li>通过一个虚拟设备把外设和应用进程隔开,只由虚拟设备来使用外设.</li>
</ul>
</blockquote>
<h4 id="DCT-Device-Control-Table-设备控制表"><a href="#DCT-Device-Control-Table-设备控制表" class="headerlink" title="DCT(Device Control Table)设备控制表"></a>DCT(Device Control Table)设备控制表</h4><p>每个设备一张,描述设备特性和状态.</p>
<blockquote>
<ul>
<li>类型</li>
<li>标识符</li>
<li>状态:表示设备使用状态</li>
<li>指向控制器表的指针:指向该设备所连接的控制器的控制表</li>
<li>重复执行次数或时间:发生传送错误时应重复执行的次数</li>
<li>设备队列的队首指针:指向申请本设备而没有满足的进程排成的表</li>
</ul>
</blockquote>
<h4 id="COCT-Controller-Control-Table-控制器控制表"><a href="#COCT-Controller-Control-Table-控制器控制表" class="headerlink" title="COCT(Controller Control Table)控制器控制表"></a>COCT(Controller Control Table)控制器控制表</h4><p>每个设备控制器一张,描述控制器的配置和状态</p>
<h4 id="CHCT-Channel-Control-Table-通道控制表"><a href="#CHCT-Channel-Control-Table-通道控制表" class="headerlink" title="CHCT(Channel Control Table)通道控制表"></a>CHCT(Channel Control Table)通道控制表</h4><p>每个通道一张,描述通道工作状态</p>
<h4 id="SDT-System-Device-Table-系统设备表"><a href="#SDT-System-Device-Table-系统设备表" class="headerlink" title="SDT(System Device Table)系统设备表"></a>SDT(System Device Table)系统设备表</h4><p>反映系统中设备资源的状态,记录所有设备的状态及其设备控制表的入口</p>
<blockquote>
<ul>
<li>DCT指针:指向相应设备的DCT</li>
<li>设备使用进程表示:正在使用该设备的进程标识</li>
<li>DCT信息:为引用方便而保存的DCT信息,如设备标识,设备类型</li>
</ul>
</blockquote>
<h4 id="设备分配考虑因素"><a href="#设备分配考虑因素" class="headerlink" title="设备分配考虑因素"></a>设备分配考虑因素</h4><blockquote>
<ul>
<li>设备固有属性</li>
<li>设备分配算法</li>
<li>设备分配中的安全性:死锁</li>
<li>安全分配(同步):进程分配之后进入阻塞,直到I/O完成,但是<code>CPU</code>和<code>I/O</code>串行,效率低</li>
<li>不安全分配(异步):进程发出请求后,仍然继续运行,可申请其他设备,可能产生死锁,需进行检查,但是效率高.</li>
</ul>
</blockquote>
<h4 id="单-多-通路I-x2F-O系统的设备分配"><a href="#单-多-通路I-x2F-O系统的设备分配" class="headerlink" title="单(多)通路I/O系统的设备分配"></a>单(多)通路I/O系统的设备分配</h4><p>单(多)通路:一个设备对应一(多)个控制器,一个控制器对应一(多)个通道.</p>
<blockquote>
<ul>
<li>分配设备</li>
<li>根据物理设备名查找SDT,找到DCT,如果忙,则等待,否则计算是否产生死锁,进行分配</li>
<li>分配设备控制器</li>
<li>进程得到DCT之后,找到对应的COCT,如果空闲则分配,否则进入等待队列</li>
<li>分配通道</li>
<li>进程得到COCT之后,找到对应的CHCT,如果空闲则分配,否则进入等待队列</li>
</ul>
</blockquote>
<h4 id="SPOOLing技术-x2F-假脱机技术"><a href="#SPOOLing技术-x2F-假脱机技术" class="headerlink" title="SPOOLing技术/假脱机技术"></a>SPOOLing技术/假脱机技术</h4><p><code>SPOOLing(Simultaneous Peripheral Operation On Line)</code>也称为虚拟设备技术,可把独享设备转换成具有共享特征的虚拟设备,提高设备利用率</p>
<p><strong>引入</strong><br>在多道程序系统中,专门利用移到程序(<code>SPOOLing</code>程序)来完成对设备的I/O操作,无需使用外围I/O处理机</p>
<blockquote>
<ul>
<li><code>SPOOLing</code>程序和外设进行数据交换:实际I/O:</li>
<li><ul>
<li>输入:程序预先从外设读入数据并且加以缓冲,在需要的时候输入到应用程序</li>
</ul>
</li>
<li><ul>
<li>输出:程序预先接受应用程序的输出数据加以缓冲,在适当时机输出到外设</li>
</ul>
</li>
<li><code>SPOOLing</code>程序和用户程序进行数据交换:虚拟I/O</li>
</ul>
</blockquote>
<p><strong>系统组成</strong></p>
<blockquote>
<ul>
<li><strong>输入井和输出井</strong>:磁盘上开辟的两个大存储空间.输入井用于模拟脱机输入时的磁盘设备,<strong>暂存输入数据</strong>,输出井模拟脱机输出时的磁盘,用于<strong>暂存用户程序和输出数据</strong>.</li>
<li><strong>输入缓冲区和输出缓冲区</strong>:由于<code>CPU</code>和磁盘速度不匹配而在内存开辟的缓冲区,攒出数据</li>
<li><strong>输入进程<code>SPi</code>和输出进程<code>SPo</code></strong>:利用两个进程模拟脱机<code>I/O</code>时的外围控制机.SPi将输入数据从输入机通过输入缓冲区输入输入金,需要的时候再从输入井读入内存,输出线程将要求输出的数据从内存读入输出井,空闲时将其传送到输出设备.</li>
</ul>
</blockquote>
<p><strong>SPOOLing</strong>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/12/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/images/SPOOLing.svg"
                      alt="SPOOLing"
                ></p>
<p><strong>特点</strong></p>
<blockquote>
<ul>
<li>告诉虚拟I/O操作:缓冲区提速</li>
<li>实现对独享设备的共享:设备繁忙时,先把数据放入输出井,对于进程来说已经完成了输出.</li>
</ul>
</blockquote>
<h3 id="I-x2F-O性能问题"><a href="#I-x2F-O性能问题" class="headerlink" title="I/O性能问题"></a>I/O性能问题</h3><p>解决<code>I/O</code>性能的途径:</p>
<blockquote>
<ul>
<li>使<code>I/O</code>尽可能独立于<code>CPU</code>:通过<code>DMA</code>,通道</li>
<li>使<code>CPU</code>的速度尽可能不被<code>I/O</code>拉低:通过缓冲区</li>
</ul>
</blockquote>
<h4 id="I-x2F-O操作过程"><a href="#I-x2F-O操作过程" class="headerlink" title="I/O操作过程"></a>I/O操作过程</h4><p><code>I/O</code>操作可以分成两部分:</p>
<blockquote>
<ul>
<li>第一阶段:</li>
<li>磁盘把数据装载进内核的内存空间</li>
<li>第二阶段:</li>
<li>内核的内存空间的数据<code>copy</code>到用户的内存空间</li>
</ul>
</blockquote>
<p><code>I/O</code>操作总的步骤:</p>
<blockquote>
<ul>
<li>进程向内核发起系统调用</li>
<li>内核接搜到系统调用,将磁盘中文件读出来</li>
<li>磁盘将文件载入到内核的地址空间</li>
<li>内核的内存空间接收到之后,将其copy到用户进程的内存空间</li>
<li>进程内核内存空间接收到文件,向内核通知</li>
<li>内核唤醒进程</li>
</ul>
</blockquote>
<h4 id="阻塞I-x2F-O"><a href="#阻塞I-x2F-O" class="headerlink" title="阻塞I/O"></a>阻塞I/O</h4><p>在最后一步之前,整个进程都会被挂起,待到唤醒之后才继续执行</p>
<h4 id="多路复用I-x2F-O"><a href="#多路复用I-x2F-O" class="headerlink" title="多路复用I/O"></a>多路复用I/O</h4><p>工作进程调用一个管理I/O的特殊库函数,此库函数可以接受并管理多个I/O请求,工作进程则可以同时等待多个I/O请求.提高了效率.<br>第二阶段依然需要工作进程参与库函数,把内核空间数据复制到用户空间,第二阶段依然阻塞.</p>
<h4 id="非阻塞I-x2F-O"><a href="#非阻塞I-x2F-O" class="headerlink" title="非阻塞I/O"></a>非阻塞I/O</h4><p>进程发起I/O调用,I/O直到需要一段时间,让进程进行其他操作(忙等).</p>
<h4 id="事件-信号-驱动I-x2F-O"><a href="#事件-信号-驱动I-x2F-O" class="headerlink" title="事件(信号)驱动I/O"></a>事件(信号)驱动I/O</h4><p>进程发起调用,内核会记住那个进程申请的,一旦第一个阶段完成,内核向进程发起通知,进程第二段开始阻塞.因此,这样进程第一阶段既不阻塞,也不忙等.</p>
<h4 id="异步I-x2F-O"><a href="#异步I-x2F-O" class="headerlink" title="异步I/O"></a>异步I/O</h4><p>无论第一第二段, 不再向系统调用提出任何反馈, 只有数据完全复制到服务进程内存中后, 才向服务进程返回ok的信息,其它时间,进程可以随意做自己的事情,直到内核通知ok信息。</p>
<h1 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h1><h2 id="磁盘介绍"><a href="#磁盘介绍" class="headerlink" title="磁盘介绍"></a>磁盘介绍</h2><h3 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h3><blockquote>
<ul>
<li>扇区(Sector):盘片被分为若干个扇区</li>
<li>磁道(Track):盘片上以盘片中心为圆心,不同半径的同心圆环</li>
<li>柱面(Cylinder):磁盘中,不同盘片相同半径的磁道组成的圆柱</li>
<li>磁头(Head):每个磁盘有两个面,每个面一个磁头</li>
</ul>
</blockquote>
<p>定位一个扇区需要三个信息:柱面号,磁头号,扇区号</p>
<h3 id="磁盘结构"><a href="#磁盘结构" class="headerlink" title="磁盘结构"></a>磁盘结构</h3><p>磁盘实际扇区数比硬盘标签上标定的大,其中一部分用于存储硬盘的固件(硬盘控制器使用)<br>一部分是用户存储数据的区域,即工作区,也就是硬盘标定容量的扇区.<br>剩下的是保留区,超过在固件里定义的硬盘容量的那些扇区就称为保留扇区.<br>对于坏扇区(不管是生产缺陷,还是使用过程中磁介质老化缺陷),都存在一张表用于映射坏扇区到空闲扇区.对于生产缺陷,这张表叫 P 表,对于老化缺陷,这张表叫 G 表.</p>
<h3 id="磁盘参数"><a href="#磁盘参数" class="headerlink" title="磁盘参数"></a>磁盘参数</h3><blockquote>
<ul>
<li>寻道时间:<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="14.978ex" height="1.717ex" role="img" focusable="false" viewBox="0 -677 6620.4 759"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(1450.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2506.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(3606.8,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(4329,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5151.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6151.4,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g></g></svg></mjx-container> (m是一个常数,可以认为是磁道的移动速度)<br>把磁头从当前位置移动到指定磁道上所经历的时间,该时间是启动磁盘时间 s 与磁头移动 n 条磁道所花费的时间之和</li>
<li>旋转延迟时间<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="8.147ex" height="2.755ex" role="img" focusable="false" viewBox="0 -864.9 3601 1217.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1432.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2488.6,0)"><g data-mml-node="mn" transform="translate(379.5,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><rect width="872.5" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container> (r 是旋转速度)</li>
<li>传输时间<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="8.564ex" height="2.8ex" role="img" focusable="false" viewBox="0 -884.7 3785.4 1237.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1342.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2398.6,0)"><g data-mml-node="mi" transform="translate(541.7,394) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(451,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g></g><rect width="1146.8" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container> (b是每次读写操作的字节数,N是一个磁道上的字节数,r是旋转速度)</li>
<li>访问时间<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="19.015ex" height="1.717ex" role="img" focusable="false" viewBox="0 -677 8404.4 759"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(1510.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2566.6,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(3270.6,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(3961.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(4962,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(5666,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(6339.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(7339.4,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(8043.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container></li>
</ul>
</blockquote>
<h2 id="磁盘组织"><a href="#磁盘组织" class="headerlink" title="磁盘组织"></a>磁盘组织</h2><h3 id="主引导扇区-MBR"><a href="#主引导扇区-MBR" class="headerlink" title="主引导扇区(MBR)"></a>主引导扇区(MBR)</h3><p>  硬盘的0柱面,0磁头,1扇区称为主引导扇区,该记录占用512个字节,用于在硬盘启动的时候将系统控制权转给用户控制权.<br>  其结构为:</p>
<blockquote>
<ul>
<li><strong>前446byte</strong>:包含启动代码和数据</li>
<li><strong>后64byte</strong>:四个分区项组成的分区表,记录了启动时需要的分区参数</li>
<li><strong>末2byte</strong>:魔数<br>对于四个分区至少有一个主分区用于存储系统,其余盘为扩展磁盘分区用于存储数据,扩展磁盘分区可以分出多个逻辑分区.</li>
</ul>
</blockquote>
<h2 id="磁盘调度"><a href="#磁盘调度" class="headerlink" title="磁盘调度"></a>磁盘调度</h2><h3 id="FCFS"><a href="#FCFS" class="headerlink" title="FCFS"></a>FCFS</h3><p><strong>算法思想</strong>:<br>按照请求到达的先后次序服务</p>
<blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>简单,公平</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>效率不高</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="SSTF"><a href="#SSTF" class="headerlink" title="SSTF"></a>SSTF</h3><p><strong>算法思想</strong>:<br>优先选择距当前磁头最近的访问请求进行服务</p>
<blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>改善了磁盘的平均服务时间</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>可能产生饥饿现象</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="SCAN"><a href="#SCAN" class="headerlink" title="SCAN"></a>SCAN</h3><p><strong>算法思想</strong>:<br>当有访问请求时，磁头按一个方向移动，在移动过程中对遇到的访问请求进行服务，然后判断该方向上是否还有访问请求，如果有则继续扫描；否则改变移动方向，并为经过的访问请求服务，如此反复.</p>
<blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>克服了最短寻道优先的缺点，既考虑了距离，同时又考虑了方向</li>
</ul>
</li>
<li>缺点:</li>
<li><ul>
<li>但由于是摆动式的扫描方法，两侧磁道被访问的频率仍低于中间磁道。</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="CSCAN"><a href="#CSCAN" class="headerlink" title="CSCAN"></a>CSCAN</h3><p><strong>算法思想</strong>:</p>
<blockquote>
<ul>
<li>按照所要访问的柱面位置的次序去选择访问者</li>
<li>移动臂到达最后一个柱面后,立即带动读写磁头快速返回到 0 号柱面</li>
<li>返回时不为任何的等待访问者服务.</li>
<li>返回后可再次进行扫描</li>
</ul>
</blockquote>
<p><strong>优点</strong>:<br>改进了 SCAN 算法偏向于处理那些接近最里或最外的磁道的请求的问题.</p>
<h3 id="LOOK和C-LOOK"><a href="#LOOK和C-LOOK" class="headerlink" title="LOOK和C-LOOK"></a>LOOK和C-LOOK</h3><p>和SCAN,CSCAN类似,但是区别<strong>是当移动方向上不再有请求时, 就调转方向</strong>.</p>
<h2 id="空间的管理"><a href="#空间的管理" class="headerlink" title="空间的管理"></a>空间的管理</h2><h3 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h3><p>用一串二进制位反映磁盘空间中分配使用情况，每个物理块对应一位，分配的物理块为0，否则为1。</p>
<h3 id="空闲表"><a href="#空闲表" class="headerlink" title="空闲表"></a>空闲表</h3><p>将所有空闲块记录在一个表中，即空闲表.<br>表项记录两个内容:起始块号，块数.</p>
<h3 id="空闲链表法"><a href="#空闲链表法" class="headerlink" title="空闲链表法"></a>空闲链表法</h3><p>把所有空闲块链成一个表.</p>
<h3 id="成组链接法"><a href="#成组链接法" class="headerlink" title="成组链接法"></a>成组链接法</h3><p>把空白物理块分成组，在通过指针把组与组之间链接起来，这种管理空白块的方法称为<strong>成组链接法</strong>。<br><strong>成组链接法</strong>:<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/images/%E6%88%90%E7%BB%84%E9%93%BE%E6%8E%A5%E6%B3%95.svg"
                      alt="成组链接法"
                ></p>
<h2 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a>RAID</h2><p>RAID(Redundant Arrays of Inexpensive Disks),也叫廉价冗余磁盘阵列,用低成本增加磁盘的容错能力</p>
<h3 id="RAID1"><a href="#RAID1" class="headerlink" title="RAID1"></a>RAID1</h3><p>镜像存储,在成对的独立磁盘上产生互为备份的数据.两个磁盘都可读取,提高了读取的性能,安全性很高,出现问题直接切换磁盘即可,但是成本也很高.</p>
<h3 id="RAID2"><a href="#RAID2" class="headerlink" title="RAID2"></a>RAID2</h3><p>海明码(汉明码)校验条带存储.将数据条块化地分布于不同的硬盘,条块单位为位或字节,使用海明码来提供错误检查及恢复.这种编码技术需要多个磁盘存放检查及恢复信息.</p>
<blockquote>
<ul>
<li>并行存取,各个驱动器同步工作</li>
<li>使用海明编码进行错误检测和纠正,数据传输率高</li>
<li>是一种在多磁盘易出错环境中的有效选择,并未被广泛应用,目前还没有商业化产品</li>
</ul>
</blockquote>
<h4 id="海明校验"><a href="#海明校验" class="headerlink" title="海明校验"></a>海明校验</h4><p>海明校验的基本原理是异或运算.由异或运算的性质可以知道a⊕a=0,因此如果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.375ex;" xmlns="http://www.w3.org/2000/svg" width="22.864ex" height="1.694ex" role="img" focusable="false" viewBox="0 -583 10105.8 748.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mn" transform="translate(562,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mo" transform="translate(1243.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(2299.1,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mn" transform="translate(562,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(3486.9,0)"><path data-c="2295" d="M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM364 542Q308 539 251 509T148 418T96 278V270H369V542H364ZM681 278Q675 338 650 386T592 462T522 509T458 535T412 542H409V270H681V278ZM96 222Q104 150 139 95T219 12T302 -29T366 -42H369V230H96V222ZM681 222V230H409V-42H412Q429 -42 456 -36T521 -10T590 37T649 113T681 222Z"></path></g><g data-mml-node="msub" transform="translate(4487.1,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mn" transform="translate(562,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(5674.9,0)"><path data-c="2295" d="M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM364 542Q308 539 251 509T148 418T96 278V270H369V542H364ZM681 278Q675 338 650 386T592 462T522 509T458 535T412 542H409V270H681V278ZM96 222Q104 150 139 95T219 12T302 -29T366 -42H369V230H96V222ZM681 222V230H409V-42H412Q429 -42 456 -36T521 -10T590 37T649 113T681 222Z"></path></g><g data-mml-node="mo" transform="translate(6675.1,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(8069.3,0)"><path data-c="2295" d="M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM364 542Q308 539 251 509T148 418T96 278V270H369V542H364ZM681 278Q675 338 650 386T592 462T522 509T458 535T412 542H409V270H681V278ZM96 222Q104 150 139 95T219 12T302 -29T366 -42H369V230H96V222ZM681 222V230H409V-42H412Q429 -42 456 -36T521 -10T590 37T649 113T681 222Z"></path></g><g data-mml-node="msub" transform="translate(9069.5,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(562,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>则<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.666ex;" xmlns="http://www.w3.org/2000/svg" width="44.005ex" height="2.363ex" role="img" focusable="false" viewBox="0 -750 19450.1 1044.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(562,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1133.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(2189.5,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="TeXAtom" transform="translate(562,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mn" transform="translate(445,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(3623.7,0)"><path data-c="2295" d="M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM364 542Q308 539 251 509T148 418T96 278V270H369V542H364ZM681 278Q675 338 650 386T592 462T522 509T458 535T412 542H409V270H681V278ZM96 222Q104 150 139 95T219 12T302 -29T366 -42H369V230H96V222ZM681 222V230H409V-42H412Q429 -42 456 -36T521 -10T590 37T649 113T681 222Z"></path></g><g data-mml-node="mo" transform="translate(4624,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(6018.2,0)"><path data-c="2295" d="M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM364 542Q308 539 251 509T148 418T96 278V270H369V542H364ZM681 278Q675 338 650 386T592 462T522 509T458 535T412 542H409V270H681V278ZM96 222Q104 150 139 95T219 12T302 -29T366 -42H369V230H96V222ZM681 222V230H409V-42H412Q429 -42 456 -36T521 -10T590 37T649 113T681 222Z"></path></g><g data-mml-node="msub" transform="translate(7018.4,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="TeXAtom" transform="translate(562,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mi" transform="translate(445,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(8280.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(8669.4,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(9014.4,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(9459.1,0)"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mn" transform="translate(445,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mo" transform="translate(10307.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(10752.3,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(12091,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(12535.7,0)"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mi" transform="translate(445,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(13732.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(14788.5,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(15288.5,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(15733.1,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(16233.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(16677.8,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(18016.5,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(18461.1,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(19061.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p>
<p>对于海明校验的数据,令 P 为海明校验码的维数,D 为数据的维数,则<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="15.773ex" height="2.099ex" role="img" focusable="false" viewBox="0 -846 6971.5 928"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g></g><g data-mml-node="mo" transform="translate(1391.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2447.6,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(3420.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(4421,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mo" transform="translate(5471.3,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(6471.5,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></p>
<h3 id="RAID3"><a href="#RAID3" class="headerlink" title="RAID3"></a>RAID3</h3><p>使用奇偶校验条带存储,共享校验盘,数据条带存储单位为字节.同 RAID2 类似,但是RAID 3使用的是简单的奇偶校验,并用单块磁盘存放奇偶校验信息.<br><strong>特点</strong></p>
<blockquote>
<ul>
<li>将磁盘分组，读写要访问组中所有盘，每组中有一个盘作为校验盘。</li>
<li>校验盘一般采用奇偶校验.</li>
<li>简单理解：先将分布在各个数据盘上的一组数据加起来，将和存放在冗余盘上。一旦某一个盘出错，只要将冗余盘上的和减去所有正确盘上的数据，得到的差就是出错的盘上的数据。</li>
<li>缺点:恢复时间长</li>
</ul>
</blockquote>
<h3 id="RAID4"><a href="#RAID4" class="headerlink" title="RAID4"></a>RAID4</h3><p>RAID4 和 RAID3 类似,只是 RAID4 以数据块为单位分布于不同磁盘,单位更大,方便了读操作.但是每次写都需要访问奇偶盘,限制了速度,因此在商业中用的也很少<br><strong>特点</strong>:</p>
<blockquote>
<ul>
<li>冗余代价与 RAID3 相同</li>
<li>访问数据的方法与 RAID3 不同,RAID3 每次读都需要访问阵列中所有磁盘</li>
</ul>
</blockquote>
<h3 id="RAID5"><a href="#RAID5" class="headerlink" title="RAID5"></a>RAID5</h3><p>和RAID4类似,奇偶校验,存储单位为块,只是不单独设计奇偶校验盘符,而是在磁盘上交叉地存取数据及奇偶校验信息.在 RAID5 上,读/写指针可同时对阵列设备进行操作,提供了更高的数据流量.<br><strong>特点</strong></p>
<blockquote>
<ul>
<li>适合小数据块和随机读写的数据</li>
<li>因为块更大,所以操作涉及的磁盘少,可并行</li>
<li>写损失,每一次写产生四次读/写错做,其中两次读旧数据和奇偶信息,两次写新的数据和奇偶信息</li>
<li>如果两块盘坏掉,RAID失效</li>
</ul>
</blockquote>
<h3 id="RAID6"><a href="#RAID6" class="headerlink" title="RAID6"></a>RAID6</h3><p>和RAID5类似,只是增加了第二个奇偶校验信息块,两者使用不同的算法,数据可靠性高,即使两块磁盘失效,也不影响数据.<br><strong>特点</strong>:</p>
<blockquote>
<ul>
<li>空间开销比 RAID5 大</li>
<li>每次写非常差,要对两个校验盘操作</li>
<li>可容忍双盘出错</li>
<li>实际应用少:性能和成本问题</li>
</ul>
</blockquote>
<h2 id="提高I-x2F-O速度"><a href="#提高I-x2F-O速度" class="headerlink" title="提高I/O速度"></a>提高I/O速度</h2><p>主要途径:</p>
<blockquote>
<ul>
<li>提高磁盘性能</li>
<li>提高并行度</li>
<li>采用适当的调度算法</li>
<li>设置高速缓冲</li>
</ul>
</blockquote>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><blockquote>
<ul>
<li>磁盘高速缓存形式</li>
<li>独立缓存(固定大小)</li>
<li>虚拟内存(可变大小)</li>
<li>数据交付</li>
<li>直接交付(copy开销大)</li>
<li>指针交付(内存管理麻烦)</li>
<li>置换算法</li>
<li>周期性写回</li>
</ul>
</blockquote>
<h3 id="优化数据布局"><a href="#优化数据布局" class="headerlink" title="优化数据布局"></a>优化数据布局</h3><blockquote>
<ul>
<li>优化物理块分布</li>
<li>连续摆放</li>
<li>优化索引节点分布</li>
<li>减少与数据块的距离</li>
<li>与数据块结合</li>
</ul>
</blockquote>
<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><blockquote>
<ul>
<li>提前读:</li>
<li>顺序访问的时候,把下一块提前读入缓冲区</li>
<li>延迟写</li>
<li>先写入缓冲区,直到缓冲区写满再写回磁盘</li>
<li>虚拟盘</li>
<li>利用内存空间仿真磁盘</li>
<li>Virtual disk 和 disk cache 区别:</li>
<li>Vitual disk的存放的内容由用户完全控制</li>
<li>Disk cache中的内容完全是由操作系统控制</li>
</ul>
</blockquote>
<h1 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h1><h2 id="基本概念-2"><a href="#基本概念-2" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p>文件是指一组带表示(文件名),在逻辑上有完整意义的信息项序列.信息项时构成文件内容的基本单位,各个信息项之间具有一定的顺序关系.文件包含两部分内容.:</p>
<blockquote>
<ul>
<li>文件体:文件本身的数据</li>
<li>文件说明:文件存储和管理的相关信息(名字,地址,访问权想,创建时间,修改时间等).</li>
</ul>
</blockquote>
<p>文件是一种对数据的<strong>抽象</strong>,它使得用户不必关心信息保存在磁盘上的方法和访问细节.</p>
<p>其本质是一组字节序列,源于用户程序对所要输入处理的原始数据和输出结果的<strong>长期保存</strong>,并按照一定格式呈现.</p>
<p>所有 I/O 设备都可以看作为字节序列的载体,因此 I/O 设备也可以抽象成文件,这就是<strong>一切皆文件</strong>的含义.</p>
<h3 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h3><blockquote>
<ul>
<li>用户视角(使用逻辑文件)</li>
<li>用户关心文件中所要使用的数据,不关系具体的存放形式和位置</li>
<li>关心文件系统对外接口</li>
<li>操作系统视角(组织和管理物理文件)</li>
<li>关心如何实现与文件有关的各个功能模块,包括存储,布局,管理,接口等.</li>
</ul>
</blockquote>
<h3 id="文件系统-1"><a href="#文件系统-1" class="headerlink" title="文件系统"></a>文件系统</h3><p>文件系统时操作系统中统一管理信息资源的一种软件,管理文件的存储,检索,更新.提供安全可靠的共享和保护手段,并且方便用户使用.<br>文件系统的任务:</p>
<blockquote>
<ul>
<li>统一管理磁盘空间,实施磁盘空间的分配和回收</li>
<li>实现文件的按名存取</li>
<li>实现文件信息的共享</li>
<li>向用户提供一个方便使用的几口</li>
<li>提高文件系统性能</li>
<li>提供与 IO 系统的统一接口</li>
</ul>
</blockquote>
<h3 id="文件名"><a href="#文件名" class="headerlink" title="文件名"></a>文件名</h3><p>当文件创建的时候必须有一个名字方便用户访问.</p>
<blockquote>
<ul>
<li>命名规则</li>
<li>文件名一定是一个有限长度字符串</li>
<li>文件名由两部分组成,模式如下: 文件名.扩展名</li>
</ul>
</blockquote>
<h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><blockquote>
<ul>
<li>按性质和用途: 系统文件,库文件,用户文件</li>
<li>按数据形式:源文件,目标文件,可执行文件</li>
<li>按对文件实施的保护级别:只读文件,读写文件,执行文件,不保护文件</li>
<li>按逻辑结构:有结构文件,无结构文件</li>
<li>按文件中物理结构分:顺序文件,链接文件,索引文件</li>
</ul>
</blockquote>
<h3 id="文件逻辑结构"><a href="#文件逻辑结构" class="headerlink" title="文件逻辑结构"></a>文件逻辑结构</h3><p>这是从用户角度看文件,由用户进程对文件的访问方式决定.</p>
<blockquote>
<ul>
<li>字节为单位的流式结构:文件是由有逻辑意义,无结构的一串字符组成的集合</li>
<li>记录式文件结构:文件由记录组成,可以按照记录读写,每条记录由其内部的结构</li>
<li>树形结构:类似B-树</li>
</ul>
</blockquote>
<h3 id="目录管理"><a href="#目录管理" class="headerlink" title="目录管理"></a>目录管理</h3><p>目录是由文件说明索引组成的用于文件检索的特殊文件.<br>文件目录的内容主要是文件访问和控制的信息.</p>
<h4 id="目录内容"><a href="#目录内容" class="headerlink" title="目录内容"></a>目录内容</h4><blockquote>
<ul>
<li>基本信息:</li>
<li>文件名</li>
<li>别名:有些操作系统允许文件有别名(alias)</li>
<li>文件类型</li>
<li>地址信息</li>
<li>访问控制信息</li>
<li>使用信息</li>
</ul>
</blockquote>
<h4 id="文件目录的分类"><a href="#文件目录的分类" class="headerlink" title="文件目录的分类"></a>文件目录的分类</h4><blockquote>
<ul>
<li>单级文件目录:只有一个目录:根目录</li>
<li>结构简单</li>
<li>文件多的时候,检索时间长</li>
<li>命名冲突:不同用户的相同作用文件可能是同一个名字,不同用户对同一个文件的命名可能不同</li>
<li>不便于共享</li>
<li>二级文件目录:在根目录之后给每个用户一个目录</li>
<li>多级文件目录:多个目录,几乎所有现代操作系统都采用这个.</li>
<li>绝对路径:从根目录开始依次经由的各级目录名，再加上最终的文件名</li>
<li>相对路径:结合当前路径进行使用</li>
<li>特点:</li>
<li>层次清楚</li>
<li>解决重命名问题</li>
<li>查找速度块</li>
<li>目录级别太多,增加路径检索时间</li>
</ul>
</blockquote>
<h3 id="文件系统-2"><a href="#文件系统-2" class="headerlink" title="文件系统"></a>文件系统</h3><h4 id="定义和目的"><a href="#定义和目的" class="headerlink" title="定义和目的"></a>定义和目的</h4><p>定义:<br>操作系统中与文件管理有关的那部分<strong>软件</strong>和被管理的<strong>文件</strong>以及实施管理所需要的<strong>数据结构</strong>的<strong>总体</strong>.<br>目的:</p>
<blockquote>
<ul>
<li>方便文件访问</li>
<li>并发文件访问和控制</li>
<li>统一的用户接口</li>
<li>多种文件访问权限</li>
<li>执行效率高</li>
<li>差错恢复强</li>
</ul>
</blockquote>
<h4 id="文件系统模型的三个层次"><a href="#文件系统模型的三个层次" class="headerlink" title="文件系统模型的三个层次"></a>文件系统模型的三个层次</h4><blockquote>
<ul>
<li>文件系统的接口(最接近用户的)</li>
<li>命令行接口:用户和文件系统的交互的接口</li>
<li>程序接口:用户程序和文件系统的接口</li>
<li>对象操作管理的软件集合</li>
<li>对存储空间的管理</li>
<li>对文件目录的管理</li>
<li>将文件逻辑地址转换成物理地址的机制</li>
<li>读写管理</li>
<li>共享和保护功能</li>
<li>对象及其属性</li>
<li>文件:直接管理对象</li>
<li>目录</li>
<li>磁盘存储空间</li>
</ul>
</blockquote>
<h2 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h2><h3 id="文件控制块和文件属性"><a href="#文件控制块和文件属性" class="headerlink" title="文件控制块和文件属性"></a>文件控制块和文件属性</h3><p><strong>文件控制块</strong>:<br>为管理文件而设置的数据结构,保存管理文件所需的所有有关信息</p>
<blockquote>
<ul>
<li>基本信息</li>
<li>文件名</li>
<li>物理位置</li>
<li>文件逻辑结构:有无结构(记录文件,流式文件)</li>
<li>文件物理结构:索引,顺序等</li>
<li>访问控制信息</li>
<li>文件所有者</li>
<li>访问权限</li>
<li>使用信息</li>
<li>创建时间,上一次修改时间,当前使用信息</li>
</ul>
</blockquote>
<p><strong>文件逻辑结构</strong><br>提高检索效率,便于修改,降低文件存储费用<br><strong>文件物理结构</strong><br>文件在存储介质上的存放方式,表示一个文件在文件存储介质上的位置,链接和编目的方法.</p>
<p>主要结构:连续结构,索引结构,串联结构</p>
<h3 id="文件物理结构"><a href="#文件物理结构" class="headerlink" title="文件物理结构"></a>文件物理结构</h3><h4 id="顺序结构"><a href="#顺序结构" class="headerlink" title="顺序结构"></a>顺序结构</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/20/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/images/%E9%A1%BA%E5%BA%8F%E7%BB%93%E6%9E%84.svg"
                      alt="顺序结构"
                ></p>
<p><strong>顺序结构</strong></p>
<blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>结构简单,实现容易,没有额外的空间开销</li>
</ul>
</li>
<li><ul>
<li>支持顺序存取和随机存取</li>
</ul>
</li>
<li><ul>
<li>连续存取数据块</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>文件长度固定后不容易改变</li>
</ul>
</li>
<li><ul>
<li>不利于文件动态增加和修改</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="串联-x2F-链接文件结构"><a href="#串联-x2F-链接文件结构" class="headerlink" title="串联/链接文件结构"></a>串联/链接文件结构</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/20/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/images/%E4%B8%B2%E8%81%94%E7%BB%93%E6%9E%84.svg"
                      alt="串联结构"
                ></p>
<p><strong>串联结构</strong></p>
<blockquote>
<ul>
<li>优点</li>
<li><ul>
<li>空间利用率高</li>
</ul>
</li>
<li><ul>
<li>文件动态扩充和修改容易</li>
</ul>
</li>
<li><ul>
<li>顺序存取效率高</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>随机存取效率低</li>
</ul>
</li>
<li><ul>
<li>可靠性问题,容易指针出错</li>
</ul>
</li>
<li><ul>
<li>指针占据空间</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="索引结构"><a href="#索引结构" class="headerlink" title="索引结构"></a>索引结构</h4><p>系统为每个文件建立一个数据结构:索引表<br>索引表是磁盘块地址数组,其中第 i 个目录项指向文件的第i块<br>索引表存在于文件目录,文件开头等位置<br><strong>索引结构</strong>：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://the-tarnished.github.io/2022/05/20/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/images/%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84.svg"
                      alt="索引结构"
                ></p>
<p>访问索引文件:</p>
<blockquote>
<ul>
<li>查文件索引号</li>
<li>查此磁盘物理块</li>
<li>优点</li>
<li><ul>
<li>既能顺序存取,又能随机存取</li>
</ul>
</li>
<li><ul>
<li>满足了动态增长</li>
</ul>
</li>
<li><ul>
<li>充分利用外存空间</li>
</ul>
</li>
<li>缺点</li>
<li><ul>
<li>空间开销和时间开销</li>
</ul>
</li>
</ul>
</blockquote>
<p><strong>索引表的组织</strong></p>
<blockquote>
<ul>
<li>链接模式:多个索引表链接</li>
<li>多级索引:讲所有索引表的地址放在另一个索引表</li>
<li>综合模式:综合上面二者</li>
</ul>
</blockquote>
<h3 id="目录的主要功能和显示"><a href="#目录的主要功能和显示" class="headerlink" title="目录的主要功能和显示"></a>目录的主要功能和显示</h3><p>目录实现需要解决:</p>
<blockquote>
<ul>
<li>目录项内容</li>
<li><ul>
<li>直接法:目录项 = 文件名 + PCB</li>
</ul>
</li>
<li><ul>
<li>间接法:目录项 = 文件名 + PCB的地址</li>
</ul>
</li>
<li>长文件名的问题</li>
<li><ul>
<li>固定长度</li>
</ul>
</li>
<li><ul>
<li>长度可变,分为三部分:目录项长度(固定),文件的属性信息(固定),文件名(改变),问题是删除之后,文件名占的内存不好回收</li>
</ul>
</li>
<li><ul>
<li>目录项本身的长度固定，把长度可变的文件名统一放在目录文件的末尾。</li>
</ul>
</li>
<li>目录的搜索方式</li>
<li><ul>
<li>顺序查询法</li>
</ul>
</li>
<li><ul>
<li>Hash</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="保护文件的方法"><a href="#保护文件的方法" class="headerlink" title="保护文件的方法"></a>保护文件的方法</h3><blockquote>
<ul>
<li>建立副本:把同一个文件保存在不同存储介质</li>
<li><ul>
<li>优点: 简单</li>
</ul>
</li>
<li><ul>
<li>缺点:设备费用和开销大</li>
</ul>
</li>
<li>定时转储</li>
<li><ul>
<li>每隔一定时间把文件转储到其他存储介质上，当文件发生故障，就用转储的文件来复原，把有故障的文件恢复到转储时刻文件的状态</li>
</ul>
</li>
<li>规定文件的权限:保护文件不被非法篡改</li>
<li><ul>
<li>防止未被批准的用户存取文件</li>
</ul>
</li>
<li><ul>
<li>防止用户冒充其他用户存取文件</li>
</ul>
</li>
<li><ul>
<li>防止核准用户(包括文件属主)误用文件.</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="文件的一致性检查"><a href="#文件的一致性检查" class="headerlink" title="文件的一致性检查"></a>文件的一致性检查</h3><blockquote>
<ul>
<li>磁盘块的一致性:</li>
<li>每个磁盘块设置两个计数器，一个记录在文件中出现的次数，另一个记录在空闲块中出现的次数，最终检查两个计数器是否存在不一致问题。</li>
<li>文件的一致性:</li>
<li>每个文件设置两个计数器，一个记录其i节点被引用的次数，另一个记录文件目录中引用它的次数，最终检查两个计数器是否存在不一致问题。</li>
</ul>
</blockquote>
<h3 id="文件的并发访问"><a href="#文件的并发访问" class="headerlink" title="文件的并发访问"></a>文件的并发访问</h3><p>文件并发访问控制的目的是提供多个进程并发访问同一文件的机制。</p>
<p>可以利用文件锁定(file lock)协调对文件指定区域的互斥访问</p>
<p>利用进程间通信,协调对文件的访问</p>
<h2 id="文件系统性能提升"><a href="#文件系统性能提升" class="headerlink" title="文件系统性能提升"></a>文件系统性能提升</h2><p>磁盘速度限制了文件系统的速度,所以文件系统要尽可能减少对磁盘的访问,常用方法:</p>
<blockquote>
<ul>
<li>目录项（FCB）分解、当前目录、磁盘碎片整理、块高速缓存、磁盘调度、提前读取、合理分配磁盘空间、信息的优化分布、RAID技术等</li>
</ul>
</blockquote>
<h3 id="块高速缓存"><a href="#块高速缓存" class="headerlink" title="块高速缓存"></a>块高速缓存</h3><p>在内存中为磁盘块设置的一个缓冲区，保存了磁盘中某些块的副本。</p>
<h3 id="磁盘块大小"><a href="#磁盘块大小" class="headerlink" title="磁盘块大小"></a>磁盘块大小</h3><p>磁盘块大小需要权衡</p>
<blockquote>
<ul>
<li>太大了访问次数少,但是碎片多</li>
<li>太小了碎片少,访问次数多</li>
</ul>
</blockquote>
<h2 id="基于日志系统的文件系统-LFS"><a href="#基于日志系统的文件系统-LFS" class="headerlink" title="基于日志系统的文件系统 LFS"></a>基于日志系统的文件系统 LFS</h2><h3 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h3><p>将磁盘看作一个日志对待,每次添加文件总是顺序添加到磁盘,每次添加先放入缓存,再一次性读入</p>
<h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><blockquote>
<ul>
<li>段:包含数据块和元数据的日志</li>
<li>inode:包含文件的物理块指针</li>
<li>inode map: 一个存放inode节点在磁盘上位置的表</li>
<li>段摘要:段中数据信息</li>
<li>段使用情况:段数据块中有效数据的量</li>
</ul>
</blockquote>
<h3 id="读写操作"><a href="#读写操作" class="headerlink" title="读写操作"></a>读写操作</h3><p>先操作缓冲区,再操作磁盘</p>
<h3 id="失效恢复"><a href="#失效恢复" class="headerlink" title="失效恢复"></a>失效恢复</h3><p>不需要检查整个磁盘,日志回退即可,最近的一次操作就会被覆盖</p>
<h3 id="清理"><a href="#清理" class="headerlink" title="清理"></a>清理</h3><p>为了提供连续的空闲磁盘空间,所以需要清理段.</p>
<blockquote>
<p>对于访问频繁的段,填充到达0.75之后就会清理,释放出空闲空间<br>对于访问不频繁的段,达到0.15之后,释放空闲空间</p>
</blockquote>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li>Post title：OS_theory_Summary</li>
        <li>Post author：Charles</li>
        <li>Create time：2023-01-31 13:14:55</li>
        <li>
            Post link：https://charles2530.github.io/2023/01/31/os-theory-summary/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/OS/">#OS</a>&nbsp;
                        </li>
                    
                </ul>
            

            <div class="recommended-article">
  <div class="recommended-article-header">
    <i class="fa-solid fa-bookmark fa-fw" aria-hidden="true"></i><span>recommend_articles</span>
  </div>
  <div class="recommended-article-group"><a class="recommended-article-item" href="/2022/12/28/regular-expression/" title="regular expression" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p2.jfif" alt="regular expression">
  <span class="title">regular expression</span>
</a><a class="recommended-article-item" href="/2023/02/01/latex-note-2/" title="Latex_note_2" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p4.jpg" alt="Latex_note_2">
  <span class="title">Latex_note_2</span>
</a><a class="recommended-article-item" href="/2022/12/27/co-verilog/" title="CO-Verilog" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p5.jfif" alt="CO-Verilog">
  <span class="title">CO-Verilog</span>
</a></div>
</div>

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/01/31/latex-note/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">Latex_note_summary</span>
                                    <span class="post-nav-item">Prev posts</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/01/31/oo-pre-9/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">OO_pre_9</span>
                                    <span class="post-nav-item">Next posts</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
  <div id="comment-anchor"></div>
  <div class="comment-area-title">
    <i class="fa-solid fa-comments">&nbsp;Comments</i>
  </div>
  

  <!-- 
            
    <div id="gitalk-container"></div>
    <script data-pjax
            src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
    <script data-pjax>

        function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
                __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
                Gitalk && new Gitalk({
                    clientID: '8083299a8ee2aaf23879',
                    clientSecret: 'a8161e81d4872181e884fdb69f7be24916b6a9d0',
                    repo: 'charles2530_issues',
                    owner: 'Charles2530',
                    admin: ['Charles2530'],
                    id: __gitalk__pathname,
                    language: 'en'
                }).render('gitalk-container');

            } catch (e) {
                window.Gitalk = null;
            }
        }

        if ('true') {
            const loadGitalkTimeout = setTimeout(() => {
                loadGitalk();
                clearTimeout(loadGitalkTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
        }
    </script>



         -->
  <script src="https://utteranc.es/client.js" repo="Charles2530/Charles2530.github.io" issue-term="pathname"
    label="Comment" theme="preferred-color-scheme" crossorigin="anonymous" async>
  </script>

  
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">OS_theory_Summary</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%88%92%E5%88%86"><span class="nav-text">内存划分</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8"><span class="nav-text">启动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E4%BB%B6%E6%A3%80%E6%B5%8B"><span class="nav-text">硬件检测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96MBR"><span class="nav-text">读取MBR</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MBR%E4%BB%8B%E7%BB%8D"><span class="nav-text">MBR介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E4%BB%8B%E7%BB%8D"><span class="nav-text">分区介绍</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Run-BootLoader"><span class="nav-text">Run BootLoader</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F"><span class="nav-text">运行引导程序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8"><span class="nav-text">加载内核</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E5%B1%82init%E4%BE%9D%E6%8D%AEinittab%E6%96%87%E4%BB%B6%E8%AE%BE%E5%AE%9A%E8%BF%90%E8%A1%8C%E7%AD%89%E7%BA%A7"><span class="nav-text">用户层init依据inittab文件设定运行等级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8Crc-sysinit"><span class="nav-text">执行rc.sysinit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97"><span class="nav-text">启动内核模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%A8%8B%E5%BA%8F"><span class="nav-text">执行脚本程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8Crc-local-%E5%8F%AF%E9%80%89"><span class="nav-text">执行rc.local(可选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8Clogin%E7%A8%8B%E5%BA%8F-%E8%BF%9B%E5%85%A5%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81"><span class="nav-text">执行login程序,进入登录状态</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="nav-text">内存管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%9B%A0%E5%92%8C%E9%9C%80%E6%B1%82"><span class="nav-text">原因和需求</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E5%9B%A0"><span class="nav-text">原因</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82"><span class="nav-text">需求</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="nav-text">存储管理的功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5%E8%A7%A3%E6%9E%90"><span class="nav-text">概念解析:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E9%81%93%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="nav-text">单道程序的内存管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6"><span class="nav-text">条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%9C%B0%E5%9D%80%E7%BF%BB%E8%AF%91"><span class="nav-text">静态地址翻译</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">优缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E9%81%93%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E2%80%93%E5%88%86%E5%8C%BA"><span class="nav-text">多道程序的内存管理–分区</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E9%97%B4%E7%9A%84%E5%88%86%E9%85%8D"><span class="nav-text">空间的分配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BA%E5%AE%9A%E5%BC%8F%E5%88%86%E5%8C%BA%E5%88%86%E9%85%8D"><span class="nav-text">固定式分区分配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95"><span class="nav-text">方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1"><span class="nav-text">优缺点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E9%85%8D%E6%96%B9%E5%BC%8F"><span class="nav-text">分配方式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%BC%8F%E5%88%86%E5%8C%BA"><span class="nav-text">可变式分区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95-1"><span class="nav-text">方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2"><span class="nav-text">优缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%B2%E7%BD%AE%E7%A9%BA%E9%97%B4%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-text">闲置空间的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E5%9B%BE%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="nav-text">位图表示法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%93%BE%E8%A1%A8%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="nav-text">链表表示法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E5%88%86%E6%9E%90"><span class="nav-text">两种方法分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%88%86%E5%8C%BA%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-text">可变分区的管理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E5%88%86%E9%85%8D%E6%93%8D%E4%BD%9C"><span class="nav-text">分区分配操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98"><span class="nav-text">分配内存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9E%E6%94%B6%E5%86%85%E5%AD%98"><span class="nav-text">回收内存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95"><span class="nav-text">搜索算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E9%A1%BA%E5%BA%8F%E6%90%9C%E7%B4%A2%E7%9A%84%E5%88%86%E9%85%8D%E7%AE%97%E6%B3%95"><span class="nav-text">基于顺序搜索的分配算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E7%B4%A2%E5%BC%95%E6%90%9C%E7%B4%A2%E7%9A%84%E5%88%86%E9%85%8D%E7%AE%97%E6%B3%95"><span class="nav-text">基于索引搜索的分配算法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E9%80%82%E5%BA%94%E7%AE%97%E6%B3%95"><span class="nav-text">快速适应算法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%99%E4%BC%B4%E7%B3%BB%E7%BB%9F"><span class="nav-text">伙伴系统</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E9%81%93%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E2%80%93%E5%88%86%E9%A1%B5"><span class="nav-text">多道程序的内存管理–分页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="nav-text">基本思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%AF%E5%88%86%E9%A1%B5%E7%B3%BB%E7%BB%9F"><span class="nav-text">纯分页系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BA%A7%E9%A1%B5%E8%A1%A8"><span class="nav-text">多级页表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E7%BA%A7%E9%A1%B5%E8%A1%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">一级页表的问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%BA%A7%E9%A1%B5%E8%A1%A8"><span class="nav-text">两级页表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BA%A7%E9%A1%B5%E8%A1%A8-1"><span class="nav-text">多级页表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E8%A1%A8TLB"><span class="nav-text">快表TLB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E7%BD%AE%E9%A1%B5%E8%A1%A8"><span class="nav-text">反置页表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%88%E5%B8%8C%E9%A1%B5%E8%A1%A8"><span class="nav-text">哈希页表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%96%B9%E6%B3%95"><span class="nav-text">检索方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E7%9A%84%E4%BF%9D%E6%8A%A4"><span class="nav-text">页的保护</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-3"><span class="nav-text">优缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E9%81%93%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E2%80%93%E5%88%86%E6%AE%B5"><span class="nav-text">多道程序的内存管理–分段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E7%BB%93%E6%9E%84"><span class="nav-text">地址结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E5%8F%98%E6%8D%A2%E6%9C%BA%E5%88%B6"><span class="nav-text">地址变换机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E5%85%B1%E4%BA%AB"><span class="nav-text">信息共享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AE%B5%E9%A1%B5%E5%BC%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="nav-text">段页式存储结构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8"><span class="nav-text">虚拟存储</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E6%80%A7%E5%8E%9F%E7%90%86"><span class="nav-text">局部性原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF%E7%9A%84%E7%89%B9%E5%BE%81"><span class="nav-text">虚拟存储技术的特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-4"><span class="nav-text">优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%88%86%E9%A1%B5-%E6%AE%B5-%E7%B3%BB%E7%BB%9F"><span class="nav-text">请求分页(段)系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%BC%8F%E5%88%86%E9%A1%B5%E7%B3%BB%E7%BB%9F"><span class="nav-text">请求式分页系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E8%A1%A8%E9%A1%B9%E7%BB%93%E6%9E%84"><span class="nav-text">页表项结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E8%B0%83%E5%85%A5%E7%AD%96%E7%95%A5"><span class="nav-text">页面调入策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="nav-text">页面置换算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E7%AE%97%E6%B3%95-OPT-optimal"><span class="nav-text">最佳算法 (OPT optimal)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NRU-%E6%9C%80%E8%BF%91%E6%9C%AA%E4%BD%BF%E7%94%A8%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="nav-text">NRU 最近未使用页面置换算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FIFO-%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E7%AE%97%E6%B3%95"><span class="nav-text">FIFO 先进先出算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E6%9C%BA%E4%BC%9A%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="nav-text">二次机会页面置换算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E9%92%9F%E7%AE%97%E6%B3%95-CLOCK"><span class="nav-text">时钟算法 CLOCK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E7%BC%93%E5%86%B2%E7%AE%97%E6%B3%95-page-buffering"><span class="nav-text">页面缓冲算法 page buffering</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E8%BF%91%E6%9C%80%E5%B0%91%E4%BD%BF%E7%94%A8%E7%AE%97%E6%B3%95-LRU"><span class="nav-text">最近最少使用算法 LRU</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95-NFU"><span class="nav-text">最不常用算法 NFU</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Aging%E7%AE%97%E6%B3%95"><span class="nav-text">Aging算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E9%A1%B5%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="nav-text">缺页异常处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E9%9B%86%E4%B8%8E%E9%A9%BB%E7%95%99%E9%9B%86"><span class="nav-text">工作集与驻留集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%96%E7%95%A5"><span class="nav-text">策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95"><span class="nav-text">算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WSClock%E7%AE%97%E6%B3%95"><span class="nav-text">WSClock算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AD%96%E7%95%A5"><span class="nav-text">页面置换策略</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E7%BD%AE%E6%8D%A2"><span class="nav-text">全局置换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E7%BD%AE%E6%8D%A2"><span class="nav-text">局部置换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%96%E5%8A%A8"><span class="nav-text">抖动</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%96%E5%8A%A8%E7%9A%84%E9%A2%84%E9%98%B2%E5%92%8C%E6%B6%88%E9%99%A4"><span class="nav-text">抖动的预防和消除</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5%E4%B8%8E%E9%87%8D%E5%AE%9A%E4%BD%8D"><span class="nav-text">链接与重定位</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4"><span class="nav-text">逻辑地址空间</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5"><span class="nav-text">引入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%A8%E5%88%AB"><span class="nav-text">辨别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84"><span class="nav-text">地址映射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E9%87%8D%E5%AE%9A%E4%BD%8D"><span class="nav-text">动态重定位</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A3%85%E5%85%A5%E5%92%8C%E9%93%BE%E6%8E%A5"><span class="nav-text">装入和链接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5"><span class="nav-text">链接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="nav-text">进程管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E5%92%8C%E5%B9%B6%E8%A1%8C"><span class="nav-text">并发和并行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91-Concurrent"><span class="nav-text">并发(Concurrent)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C-Parallel"><span class="nav-text">并行(Parallel)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E6%AF%94"><span class="nav-text">对比</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8C%E7%9A%84%E7%89%B9%E5%BE%81"><span class="nav-text">并发执行的特征</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bernstein%E6%9D%A1%E4%BB%B6"><span class="nav-text">Bernstein条件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-text">定义</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B"><span class="nav-text">进程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81"><span class="nav-text">特征</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81%E4%B8%8E%E6%8E%A7%E5%88%B6"><span class="nav-text">进程的状态与控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81"><span class="nav-text">进程的状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%9D%97"><span class="nav-text">进程控制块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PCB%E7%9A%84%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F"><span class="nav-text">PCB的组织方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E6%96%AD%E5%A4%84%E7%90%86%E8%A7%A6%E5%8F%91%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%88%87%E6%8D%A2%E6%B5%81%E7%A8%8B"><span class="nav-text">中断处理触发的进程切换流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E4%B8%8A%E4%B8%8B%E2%BD%82%E6%96%87%E5%88%87%E6%8D%A2-vs-%E9%99%B7%E2%BC%8A%E5%85%A5%E5%86%85%E6%A0%B8"><span class="nav-text">进程上下⽂文切换 vs 陷⼊入内核</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B"><span class="nav-text">线程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%BC%95%E5%85%A5"><span class="nav-text">线程的引入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B"><span class="nav-text">进程和线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="nav-text">线程实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E7%BA%A7%E7%BA%BF%E7%A8%8B"><span class="nav-text">用户级线程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E6%A0%B8%E7%BA%A7%E7%BA%BF%E7%A8%8B"><span class="nav-text">内核级线程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%AF%94%E8%BE%83"><span class="nav-text">线程比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%B7%E5%90%88%E5%AE%9E%E7%8E%B0"><span class="nav-text">混合实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">线程模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Many-to-One-%E6%A8%A1%E5%9E%8B"><span class="nav-text">Many-to-One 模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#One-to-One-%E6%A8%A1%E5%9E%8B"><span class="nav-text">One-to-One 模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Many-to-Many-%E6%A8%A1%E5%9E%8B"><span class="nav-text">Many-to-Many 模型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6"><span class="nav-text">进程调度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E5%BA%A6%E7%B1%BB%E5%9E%8B-CPU%E7%9A%84%E4%B8%89%E7%BA%A7%E8%B0%83%E5%BA%A6"><span class="nav-text">调度类型|CPU的三级调度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%89%B9%E6%80%A7%E5%92%8C%E5%88%86%E7%B1%BB"><span class="nav-text">进程的特性和分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B-%E7%BA%BF%E7%A8%8B-%E8%B0%83%E5%BA%A6%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-text">进程(线程)调度的分类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E6%98%AF%E5%90%A6%E5%9C%A8%E6%97%B6%E9%92%9F%E4%B8%AD%E6%96%AD%E4%BD%9C%E5%87%BA%E8%B0%83%E5%BA%A6%E5%86%B3%E7%AD%96"><span class="nav-text">根据是否在时钟中断作出调度决策</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E4%B8%8D%E5%90%8C%E7%9A%84%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F"><span class="nav-text">根据不同的应用领域</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%E7%9A%84%E7%9B%AE%E6%A0%87"><span class="nav-text">调度算法的目标</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E5%A4%84%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-text">批处理系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%B3%BB%E7%BB%9F"><span class="nav-text">交互式系统</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%B9%E5%A4%84%E7%90%86%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95"><span class="nav-text">批处理系统的调度算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FCFS-First-Come-First-Serveice-%E7%AE%97%E6%B3%95"><span class="nav-text">FCFS(First Come First Serveice)算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SJF-Shortest-Job-First-%E7%AE%97%E6%B3%95"><span class="nav-text">SJF(Shortest Job First)算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SRTN-Shortest-Remaining-Time-Next"><span class="nav-text">SRTN(Shortest Remaining Time Next)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HRRN-Hightest-Response-Ratio-Next-%E6%9C%80%E9%AB%98%E5%93%8D%E5%BA%94%E6%AF%94%E4%BC%98%E5%85%88%E7%AE%97%E6%B3%95"><span class="nav-text">HRRN(Hightest Response Ratio Next)最高响应比优先算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95"><span class="nav-text">交互式系统的调度算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RR-Round-Robin-%E6%97%B6%E9%97%B4%E7%89%87%E8%BD%AE%E8%BD%AC%E7%AE%97%E6%B3%95"><span class="nav-text">RR(Round Robin)时间片轮转算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PS-Priority-Scheduling-%E4%BC%98%E5%85%88%E7%BA%A7%E8%B0%83%E5%BA%A6"><span class="nav-text">PS( Priority Scheduling)优先级调度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MQ-Multi-Queue-%E5%A4%9A%E7%BA%A7%E9%98%9F%E5%88%97%E7%AE%97%E6%B3%95"><span class="nav-text">MQ(Multi Queue)多级队列算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MFQ-%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97%E7%AE%97%E6%B3%95"><span class="nav-text">MFQ 多级反馈队列算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%A9%E7%A5%A8%E8%B0%83%E5%BA%A6"><span class="nav-text">彩票调度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6"><span class="nav-text">线程调度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7%E5%80%92%E8%BD%AC%E5%8F%8A%E5%85%B6%E8%B0%83%E5%BA%A6%E6%96%B9%E6%B3%95"><span class="nav-text">优先级倒转及其调度方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7%E5%80%92%E8%BD%AC%E7%8E%B0%E8%B1%A1"><span class="nav-text">优先级倒转现象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%E2%80%93%E4%BC%98%E5%85%88%E7%BA%A7%E7%BD%AE%E9%A1%B9"><span class="nav-text">解决办法–优先级置项</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7%E7%BB%A7%E6%89%BF"><span class="nav-text">优先级继承</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%97%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95"><span class="nav-text">实时系统的调度算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E8%A1%A8%E8%B0%83%E5%BA%A6"><span class="nav-text">静态表调度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%B0%83%E9%80%9F%E7%8E%87%E8%B0%83%E5%BA%A6RMS"><span class="nav-text">单调速率调度RMS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E6%97%A9%E6%88%AA%E6%AD%A2%E6%9C%9F%E4%BC%98%E5%85%88EDF"><span class="nav-text">最早截止期优先EDF</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%A4%84%E7%90%86%E6%9C%BA%E8%B0%83%E5%BA%A6"><span class="nav-text">多处理机调度</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#AMP-Asymmetric-Multi-Processor-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%A4%9A%E5%A4%84%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-text">AMP(Asymmetric Multi-Processor)非对称多处理系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SMP-Symmetric-Multi-Processor-%E5%AF%B9%E7%A7%B0%E5%BC%8F%E5%A4%9A%E5%A4%84%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-text">SMP(Symmetric Multi-Processor)对称式多处理系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5"><span class="nav-text">进程同步</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%BF%99%E7%AD%89%E5%BE%85%E7%9A%84%E4%BA%92%E6%96%A5%E6%96%B9%E6%B3%95"><span class="nav-text">基于忙等待的互斥方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A5%E6%A0%BC%E8%BD%AE%E6%8D%A2%E6%B3%95"><span class="nav-text">严格轮换法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Peterson%E7%AE%97%E6%B3%95"><span class="nav-text">Peterson算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A1%AC%E4%BB%B6%E6%8C%87%E4%BB%A4%E6%9C%BA%E5%88%B6"><span class="nav-text">硬件指令机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bakery-Algorithm"><span class="nav-text">Bakery Algorithm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E6%9C%BA%E5%88%B6"><span class="nav-text">信号量机制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%92%E6%96%A5"><span class="nav-text">互斥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5"><span class="nav-text">同步</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%87%E5%90%88"><span class="nav-text">汇合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%8F%E9%9A%9C"><span class="nav-text">屏障</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="nav-text">多路复用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F%E9%9B%86"><span class="nav-text">信号量集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#AND%E5%9E%8B%E4%BF%A1%E5%8F%B7%E9%87%8F%E9%9B%86"><span class="nav-text">AND型信号量集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E8%88%AC%E4%BF%A1%E5%8F%B7%E9%87%8F%E9%9B%86"><span class="nav-text">一般信号量集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5"><span class="nav-text">特殊情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-5"><span class="nav-text">优缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E7%A8%8B-Monitor"><span class="nav-text">管程(Monitor)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%A1%E7%A8%8B%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">管程的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9-6"><span class="nav-text">优缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1%E7%9A%84%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95"><span class="nav-text">进程通信的主要方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E4%BF%A1%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-text">通信的分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E5%90%8D%E7%AE%A1%E9%81%93-Pipe"><span class="nav-text">无名管道(Pipe)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%90%8D%E7%AE%A1%E9%81%93-Named-Pipe-%E6%88%96-FIFO"><span class="nav-text">有名管道(Named Pipe 或 FIFO)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E4%BC%A0%E9%80%92"><span class="nav-text">信息传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text">共享内存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5%E9%97%AE%E9%A2%98"><span class="nav-text">经典进程同步问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E6%A8%A1%E5%9E%8B"><span class="nav-text">生产者消费者模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E8%80%85%E5%86%99%E8%80%85%E9%97%AE%E9%A2%98"><span class="nav-text">读者写者问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%BB%E9%94%81"><span class="nav-text">死锁</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-2"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%85%E8%A6%81%E6%9D%A1%E4%BB%B6"><span class="nav-text">必要条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95"><span class="nav-text">死锁处理方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%B8%B5%E9%B8%9F%E7%AE%97%E6%B3%95"><span class="nav-text">鸵鸟算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E6%A3%80%E6%B5%8B%E4%B8%8E%E6%AD%BB%E9%94%81%E6%81%A2%E5%A4%8D"><span class="nav-text">死锁检测与死锁恢复</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E9%A2%84%E9%98%B2"><span class="nav-text">死锁预防</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E9%81%BF%E5%85%8D"><span class="nav-text">死锁避免</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E5%88%86%E9%85%8D%E5%9B%BE"><span class="nav-text">资源分配图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E5%90%91%E9%87%8F%E8%AE%A1%E7%AE%97"><span class="nav-text">资源向量计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E6%81%A2%E5%A4%8D"><span class="nav-text">死锁恢复</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%BB%E9%94%81%E9%A2%84%E9%98%B2-1"><span class="nav-text">死锁预防</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%B2%E5%AD%A6%E5%AE%B6%E5%B0%B1%E9%A4%90%E9%97%AE%E9%A2%98"><span class="nav-text">哲学家就餐问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86"><span class="nav-text">设备管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#I-x2F-O%E7%A1%AC%E4%BB%B6"><span class="nav-text">I&#x2F;O硬件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BA%BF"><span class="nav-text">总线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E7%B3%BB%E7%BB%9F"><span class="nav-text">I&#x2F;O系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E8%AE%BE%E5%A4%87%E4%B8%8E%E7%AE%A1%E7%90%86"><span class="nav-text">I&#x2F;O设备与管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-text">分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86-1"><span class="nav-text">设备管理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-text">设备控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD"><span class="nav-text">功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E6%88%90"><span class="nav-text">组成</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E7%AB%AF%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="nav-text">I&#x2F;O端口地址</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%98%A0%E5%83%8FI-O%E6%A8%A1%E5%BC%8F%E7%89%B9%E7%82%B9"><span class="nav-text">内存映像I&#x2F;O模式特点:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#I-O%E7%8B%AC%E7%AB%8B%E7%BC%96%E5%9D%80%E7%89%B9%E7%82%B9"><span class="nav-text">I&#x2F;O独立编址特点:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E6%8E%A7%E5%88%B6%E6%96%B9%E5%BC%8F"><span class="nav-text">I&#x2F;O控制方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6I-O"><span class="nav-text">程序控制I&#x2F;O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%AD%E9%A9%B1%E5%8A%A8"><span class="nav-text">中断驱动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DMA"><span class="nav-text">DMA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#I-x2F-O%E9%80%9A%E9%81%93"><span class="nav-text">I&#x2F;O通道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DMA%E4%B8%8E%E9%80%9A%E9%81%93%E5%8C%BA%E5%88%AB"><span class="nav-text">DMA与通道区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-x2F-O%E8%BD%AF%E4%BB%B6"><span class="nav-text">I&#x2F;O软件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="nav-text">设备独立性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%AE%BE%E5%A4%87%E8%A1%A8-LUT"><span class="nav-text">逻辑设备表(LUT)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-text">设备驱动程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-text">设备驱动程序的组成</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E5%B1%9E%E4%BA%8E%E5%86%85%E6%A0%B8"><span class="nav-text">设备驱动属于内核</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E7%BC%93%E5%86%B2%E7%AE%A1%E7%90%86"><span class="nav-text">I&#x2F;O缓冲管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E7%BC%93%E5%86%B2-Single-Buffer"><span class="nav-text">单缓冲(Single Buffer)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8C%E7%BC%93%E5%86%B2-Double-Buffer"><span class="nav-text">双缓冲(Double Buffer)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%AF%E5%BD%A2%E7%BC%93%E5%86%B2-Circular-Buffer"><span class="nav-text">环形缓冲(Circular Buffer)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%93%E5%86%B2%E6%B1%A0"><span class="nav-text">缓冲池</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86"><span class="nav-text">I&#x2F;O设备管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DCT-Device-Control-Table-%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E8%A1%A8"><span class="nav-text">DCT(Device Control Table)设备控制表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#COCT-Controller-Control-Table-%E6%8E%A7%E5%88%B6%E5%99%A8%E6%8E%A7%E5%88%B6%E8%A1%A8"><span class="nav-text">COCT(Controller Control Table)控制器控制表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CHCT-Channel-Control-Table-%E9%80%9A%E9%81%93%E6%8E%A7%E5%88%B6%E8%A1%A8"><span class="nav-text">CHCT(Channel Control Table)通道控制表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SDT-System-Device-Table-%E7%B3%BB%E7%BB%9F%E8%AE%BE%E5%A4%87%E8%A1%A8"><span class="nav-text">SDT(System Device Table)系统设备表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%88%86%E9%85%8D%E8%80%83%E8%99%91%E5%9B%A0%E7%B4%A0"><span class="nav-text">设备分配考虑因素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95-%E5%A4%9A-%E9%80%9A%E8%B7%AFI-x2F-O%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AE%BE%E5%A4%87%E5%88%86%E9%85%8D"><span class="nav-text">单(多)通路I&#x2F;O系统的设备分配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SPOOLing%E6%8A%80%E6%9C%AF-x2F-%E5%81%87%E8%84%B1%E6%9C%BA%E6%8A%80%E6%9C%AF"><span class="nav-text">SPOOLing技术&#x2F;假脱机技术</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-x2F-O%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98"><span class="nav-text">I&#x2F;O性能问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#I-x2F-O%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="nav-text">I&#x2F;O操作过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%98%BB%E5%A1%9EI-x2F-O"><span class="nav-text">阻塞I&#x2F;O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8I-x2F-O"><span class="nav-text">多路复用I&#x2F;O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E9%98%BB%E5%A1%9EI-x2F-O"><span class="nav-text">非阻塞I&#x2F;O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8B%E4%BB%B6-%E4%BF%A1%E5%8F%B7-%E9%A9%B1%E5%8A%A8I-x2F-O"><span class="nav-text">事件(信号)驱动I&#x2F;O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5I-x2F-O"><span class="nav-text">异步I&#x2F;O</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86"><span class="nav-text">磁盘管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E4%BB%8B%E7%BB%8D"><span class="nav-text">磁盘介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E7%BB%93%E6%9E%84"><span class="nav-text">磁盘结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%8F%82%E6%95%B0"><span class="nav-text">磁盘参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E7%BB%84%E7%BB%87"><span class="nav-text">磁盘组织</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BA-MBR"><span class="nav-text">主引导扇区(MBR)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6"><span class="nav-text">磁盘调度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FCFS"><span class="nav-text">FCFS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSTF"><span class="nav-text">SSTF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SCAN"><span class="nav-text">SCAN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSCAN"><span class="nav-text">CSCAN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LOOK%E5%92%8CC-LOOK"><span class="nav-text">LOOK和C-LOOK</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E9%97%B4%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-text">空间的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E5%9B%BE"><span class="nav-text">位图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E9%97%B2%E8%A1%A8"><span class="nav-text">空闲表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E9%97%B2%E9%93%BE%E8%A1%A8%E6%B3%95"><span class="nav-text">空闲链表法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E7%BB%84%E9%93%BE%E6%8E%A5%E6%B3%95"><span class="nav-text">成组链接法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RAID"><span class="nav-text">RAID</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID1"><span class="nav-text">RAID1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID2"><span class="nav-text">RAID2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%B7%E6%98%8E%E6%A0%A1%E9%AA%8C"><span class="nav-text">海明校验</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID3"><span class="nav-text">RAID3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID4"><span class="nav-text">RAID4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID5"><span class="nav-text">RAID5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAID6"><span class="nav-text">RAID6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E9%AB%98I-x2F-O%E9%80%9F%E5%BA%A6"><span class="nav-text">提高I&#x2F;O速度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%93%E5%AD%98"><span class="nav-text">缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E6%95%B0%E6%8D%AE%E5%B8%83%E5%B1%80"><span class="nav-text">优化数据布局</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="nav-text">其他方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-text">文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-2"><span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6"><span class="nav-text">文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="nav-text">文件管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-1"><span class="nav-text">文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%90%8D"><span class="nav-text">文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">文件类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84"><span class="nav-text">文件逻辑结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86"><span class="nav-text">目录管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E5%86%85%E5%AE%B9"><span class="nav-text">目录内容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-text">文件目录的分类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-2"><span class="nav-text">文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%92%8C%E7%9B%AE%E7%9A%84"><span class="nav-text">定义和目的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%B8%89%E4%B8%AA%E5%B1%82%E6%AC%A1"><span class="nav-text">文件系统模型的三个层次</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95"><span class="nav-text">实现方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%8E%A7%E5%88%B6%E5%9D%97%E5%92%8C%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="nav-text">文件控制块和文件属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%89%A9%E7%90%86%E7%BB%93%E6%9E%84"><span class="nav-text">文件物理结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%BA%E5%BA%8F%E7%BB%93%E6%9E%84"><span class="nav-text">顺序结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%B2%E8%81%94-x2F-%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-text">串联&#x2F;链接文件结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84"><span class="nav-text">索引结构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%9A%84%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD%E5%92%8C%E6%98%BE%E7%A4%BA"><span class="nav-text">目录的主要功能和显示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E6%8A%A4%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">保护文件的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E6%A3%80%E6%9F%A5"><span class="nav-text">文件的一致性检查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91%E8%AE%BF%E9%97%AE"><span class="nav-text">文件的并发访问</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><span class="nav-text">文件系统性能提升</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9D%97%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98"><span class="nav-text">块高速缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%9D%97%E5%A4%A7%E5%B0%8F"><span class="nav-text">磁盘块大小</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-LFS"><span class="nav-text">基于日志系统的文件系统 LFS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="nav-text">基本思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">数据结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C"><span class="nav-text">读写操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%B1%E6%95%88%E6%81%A2%E5%A4%8D"><span class="nav-text">失效恢复</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E7%90%86"><span class="nav-text">清理</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>



        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-regular fa-computer-classic"></i>&nbsp;&nbsp;<a href="/">Charles</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        Total Page Views&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">Powered by Charles</span>
                <br> 
            <span class="theme-version-container">Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v1.1.2</a>
        </div>
        
        
        
            <div id="start_time_div" style="display:none">
                2022/12/27 00:00:00
            </div>
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
                

                    
                        <script data-pjax type="text/javascript" src="/js/love.js"></script>
                    
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="unfolded-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="fa-regular fa-arrow-up"></i>
            </li>
        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="folded-tools-list">
        <li class="right-bottom-tools tool-toggle-show flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>



  
<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/layouts/menu-shrink.js"></script>

<script src="/js/tools/go-top-bottom.js"></script>

<script src="/js/tools/dark-light-toggle.js"></script>



    
<script src="/js/tools/local-search.js"></script>




    
<script src="/js/tools/code-block.js"></script>




    
<script src="/js/layouts/lazyload.js"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/layouts/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">



<div class="post-scripts pjax">
    
        
<script src="/js/tools/toc-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/layouts/toc.js"></script>

<script src="/js/plugins/tabs.js"></script>

    
    
        
<script src="/js/libs/mermaid.min.js"></script>

        
<script src="/js/plugins/mermaid.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            REDEFINE.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            REDEFINE.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            REDEFINE.refresh();
        });
    });
</script>



</body>

</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
