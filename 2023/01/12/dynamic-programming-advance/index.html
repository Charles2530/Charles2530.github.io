<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Charles">
    
    <meta name="author" content="Charles">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://charles2530.github.io/2023/01/12/dynamic-programming-advance/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="post by Charles in 2023-01-12 20:59:46">
<meta property="og:type" content="article">
<meta property="og:title" content="dynamic-programming-advance">
<meta property="og:url" content="http://charles2530.github.io/2023/01/12/dynamic-programming-advance/index.html">
<meta property="og:site_name" content="Charles&#39;s Castle">
<meta property="og:description" content="post by Charles in 2023-01-12 20:59:46">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_d8f144a59f4c0ce9322ag-11.jpg">
<meta property="og:image" content="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_d8f144a59f4c0ce9322ag-12.jpg">
<meta property="og:image" content="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_68f9131d5c14c1f27e68g-12.jpg">
<meta property="article:published_time" content="2023-01-12T12:59:46.000Z">
<meta property="article:modified_time" content="2023-02-11T13:10:11.485Z">
<meta property="article:author" content="Du Jinyang">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_d8f144a59f4c0ce9322ag-11.jpg">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://charles2530.github.io/image/background/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://charles2530.github.io/image/background/favicon.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://charles2530.github.io/image/background/favicon.png">
    <!--- Page Info-->
    
    <title>
        
            dynamic-programming-advance -
        
        Charles&#39;s Castle
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/assets/fonts.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"charles2530.github.io","root":"/","language":"en","path":"search.xml"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":true,"list":["lol","Neo","God"]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":true,"title":"recommend_articles","limit":3,"placeholder":"https://charles2530.github.io/image/background/p3.jfif","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":"#1890ff"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://charles2530.github.io/image/background/background-light1.jpg","dark":"https://charles2530.github.io/image/background/background-dark1.jpg"},"title":"Charles's Castle","subtitle":{"text":["Happiness is best!","Never give up!","Everyday is a gift!"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#000000","dark":"#d1d1b6"},"text_style":{"title_size":"3.2rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/Charles2530/","zhihu":"https://www.zhihu.com/people/yang-guang-xiao-zi-55-55","email":"charles2530@163.com"}}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null},{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.1.4","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Categories":{"path":"/categories","icon":"fas fa-bookmark"},"Tags":{"path":"/tags","icon":"fas fa-tags"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/Charles2530/","Blog":"https://charles2530.github.io"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"This is Charles's Castle","links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Photos":{"icon":"fa-solid fa-image","path":"/masonry/"},"Essays":{"icon":"fa-solid fa-message-lines","path":"/essay/"},"Friends":{"icon":"fa-solid fa-user-group","path":"/friends/"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}}};
    Global.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    Global.data_config = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Charles's Castle" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>



<body>
  <div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Charles&#39;s Castle
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fas fa-bookmark"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags"  >
                                    
                                        
                                            <i class="fas fa-tags"></i>
                                        
                                        TAGS
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://charles2530.github.io">BLOG
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/categories"  >
                             
                                
                                    <i class="fas fa-bookmark"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/tags"  >
                             
                                
                                    <i class="fas fa-tags"></i>
                                
                                TAGS
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="https://charles2530.github.io">BLOG</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
                      
                <div class="article-title">
                    <img src="https://charles2530.github.io/image/background/p3.jfif" alt="dynamic-programming-advance" />
                    <h1 class="article-title-cover">dynamic-programming-advance</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://charles2530.github.io/image/background/logo.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Charles</span>
                            
                                <span class="author-label">Lv6</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-01-12 20:59:46</span>
        <span class="mobile">2023-01-12 20:59</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-02-11 21:10:11</span>
            <span class="mobile">2023-02-11 21:10</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/algorithm/">algorithm</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/algorithm/">algorithm</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>4k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>17 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1 id="dynamic-programming-advance"><a href="#dynamic-programming-advance" class="headerlink" title="dynamic-programming-advance"></a>dynamic-programming-advance</h1><h2 id="动态规划进阶"><a href="#动态规划进阶" class="headerlink" title="动态规划进阶"></a>动态规划进阶</h2><h3 id="1-区间dp"><a href="#1-区间dp" class="headerlink" title="1.区间dp"></a>1.区间dp</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>区间dp就是在区间上进行动态规划，求解一段区间上的最优解。主要是通过合并小区间的最优解进而得出整个大区间上最优解的dp算法。</p>
</blockquote>
<h4 id="核心思路"><a href="#核心思路" class="headerlink" title="核心思路"></a>核心思路</h4><blockquote>
<p>既然让我求解在一个区间上的最优解，那么我把这个区间分割成一个个小区间，求解每个小区间的最优解，再合并小区间得到大区间即可。所以在代码实现上，我可以枚举区间长度len为每次分割成的小区间长度（由短到长不断合并），内层枚举该长度下可以的起点，自然终点也就明了了。然后在这个起点终点之间枚举分割点，求解这段小区间在某个分割点下的最优解。</p>
</blockquote>
<p>板子如下：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> len = <span class="number">1</span>; len &lt;= n; len++) &#123;          <span class="comment">// 枚举长度</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j + len - <span class="number">1</span> &lt;= n; j++) &#123;  <span class="comment">// 枚举起点，ends&lt;=n</span></span><br><span class="line">        <span class="type">int</span> ends = j + len - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = j; i &lt; ends; i++) &#123;  <span class="comment">// 枚举分割点，更新小区间最优解</span></span><br><span class="line">            dp[j][ends] =</span><br><span class="line">                <span class="built_in">min</span>(dp[j][ends], dp[j][i] + dp[i + <span class="number">1</span>][ends] + something);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>我们以下方（石子归并）一题为代表进行简单解释区间dp（区间dp应该是最简单的一类dp了）</p>
<p>转移方程：<br>$dp[j][ends] = min(dp[j][ends],dp[j][i]+dp[i+1][ends]+weigth[i][ends]);$<br>j~ends堆合并 = 较小的（原来,分割点i坐部分重量 + 分割点i右边部分重量 + 合并后两堆总重量）<br>注：可以用sum[j] - sum[i - 1]表示i~j堆的重量！<br>然后套上面讲解的板子即可！！！</p>
</blockquote>
<h5 id="环形区间dp的处理"><a href="#环形区间dp的处理" class="headerlink" title="环形区间dp的处理"></a>环形区间dp的处理</h5><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    cin &gt;&gt; a[i];</span><br><span class="line">    a[i + n] = a[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="典型例题"><a href="#典型例题" class="headerlink" title="典型例题"></a>典型例题</h4><p><a class="link"   target="_blank" rel="noopener" href="https://vjudge.net/problem/51Nod-1021" >石子归并 - 51Nod 1021 - Virtual Judge (vjudge.net) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f</span></span><br><span class="line"><span class="type">int</span> stone[<span class="number">105</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="type">int</span> sum[<span class="number">105</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">memset</span>(sum, <span class="number">0</span>, <span class="built_in">sizeof</span>(sum));</span><br><span class="line">    <span class="built_in">memset</span>(dp, INF, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;stone[i]);</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + stone[i];  <span class="comment">// 重量</span></span><br><span class="line">        dp[i][i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> len = <span class="number">1</span>; len &lt;= n; len++) &#123;          <span class="comment">// 枚举长度</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j + len &lt;= n + <span class="number">1</span>; j++) &#123;  <span class="comment">// 枚举起点，ends&lt;=n</span></span><br><span class="line">            <span class="type">int</span> ends = j + len - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = j; i &lt; ends; i++) &#123;  <span class="comment">// 枚举分割点</span></span><br><span class="line">                dp[j][ends] =</span><br><span class="line">                    <span class="built_in">min</span>(dp[j][ends], dp[j][i] + dp[i + <span class="number">1</span>][ends] + sum[ends] - sum[j - <span class="number">1</span>]);  <span class="comment">// 更新状态</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; dp[<span class="number">1</span>][n] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<blockquote>
<p>其实之前发过的ST表就是用的区间dp的思想。</p>
</blockquote>
<h3 id="2-树形dp"><a href="#2-树形dp" class="headerlink" title="2.树形dp"></a>2.树形dp</h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>树形dp就是在树上进行的dp。由于树具有递归的性质，因此树形dp一半都是用递归的方式进行的。</p>
</blockquote>
<h4 id="核心思路-1"><a href="#核心思路-1" class="headerlink" title="核心思路"></a>核心思路</h4><blockquote>
<p>通常，我们从根节点出发，向子节点做深度优先搜索，并由其子节点的最优解合并得到该节点的最优解。有些问题，我们还需再次从根节点出发，向子节点做深度优先搜索，对于树上的每个节点（除根节点外），由父节点的信息（父节点合并后的信息，除去该孩子的信息，就是其与孩子的信息）更新该节点的信息</p>
</blockquote>
<p>树形DP的关键和实现方法是dfs。在dfs中dp，主要的实现形式是$dp[i][j][0/1]$，i是以i为根的子树，j是表示在以i为根的子树中选择j个子节点，0表示这个节点不选，1表示选择这个节点。有的时候j或0/1这一维可以压掉。<br>具体操作时，先找到树根，从树根开始运用dfs 递归，跟dfs一样先初始化，然后递归到叶子节点上为止，把最底层的$dp[i][j] $更新完毕，再回来往上走，自底向上地根据题意更新上层的dp数组，最后输出答案即可。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> dp[...];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> now, <span class="type">int</span> fa...)</span></span>&#123;</span><br><span class="line">	<span class="comment">/*设置初值*/</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="comment">/*遍历儿子*/</span>)&#123;</span><br><span class="line">		<span class="type">int</span> u = <span class="comment">/*儿子*/</span>;</span><br><span class="line">		<span class="keyword">if</span> (u == fa) <span class="keyword">continue</span>;<span class="comment">//注意不能返回父亲节点</span></span><br><span class="line">		<span class="built_in">dfs</span>(u, now...);</span><br><span class="line">		<span class="comment">/*转移*/</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>一般基础的题转移方程有两种模式：</p>
<h5 id="选择节点类"><a href="#选择节点类" class="headerlink" title="选择节点类"></a>选择节点类</h5><p>$ f [ i ] [ 0 ] = f [ j ] [ 1 ]$ </p>
<p>$f [ i ] [ 1 ] = max ⁡ / min ⁡ ( f [ j ] [ 0 ] , f [ j ] [ 1 ] )$</p>
<p>选择节点式的题首先前提条件是整个数据是由树形结构存储的，或者应该用树形结构存，效率更高什么的，然后会告诉你相邻的节点是不能同时存在的，要求取最大最小值。</p>
<blockquote>
<p>我们以下方（没有上司的舞会）一题为代表进行简单解释选择结点类的树形dp</p>
<p>“没有上司的舞会”这题是树形dp的板子题，每个节点都有被选择和不被选择两种情况。<br>用数组$dp[n][0]$记录第n个节点不被选择时快乐指数的最大值，用数组$dp[n][1]$记录被选择时快乐指数的最大值。<br>那么就有状态转移方程<br>$dp[n][0] = Σ(max(dp[x][0],dp[x][1])$，其中，x是n的所有子节点<br>$dp[n][1] = a[n] + Σ(dp[x][0])$</p>
</blockquote>
<p>在大量做题后会发现此类型的树形dp问题还是比较少的（我觉得这类问题没有考到树形dp的本质），而更经典的还是下方的这类树形背包类的树形dp问题。</p>
<h5 id="树形背包类"><a href="#树形背包类" class="headerlink" title="树形背包类"></a>树形背包类</h5><p>$ f [ v ] [ k ] = f [ u ] [ k ] + v a l$</p>
<p>$f [ u ] [ k ] = m a x ( f [ u ] [ k ] , f [ v ] [ k − 1 ] )$</p>
<p>所谓树形背包问题，我喜欢把它称为第四类背包问题——分组背包（前三类就是经典的01背包、完全背包和多重背包,具体内容可以见我的前一篇关于dp基础讲解的博客）。</p>
<h6 id="分组背包定义"><a href="#分组背包定义" class="headerlink" title="分组背包定义"></a>分组背包定义</h6><p>分组背包，通俗的讲就是，给你N组物品，然后每一组你至多选择一个物品(<strong>也可以不选</strong>),每个物品都有自己的体积和价值，现在给你一个容里为M的背包，让你用这个背包装物品，使得物品价值总和最大.把这个概念带入树形背包，就是背包加上条件，一个物品只有选择了它的主件（根节点）才能选择。<br>对于树上的每个结点而言，它所拥有的组数就是它的子节点数，每个结点只能选择装入或放弃整个结点的值而不能放弃一个结点而取该结点子节点的值(分组)，这也就形成了分组背包的条件，所以我们只要能很好的掌握分组背包，也就很好地能理解背包的思想了。（当然也可以当做依赖背包来理解，即如果要选择子节点则必须选择父节点，当然本质区别不大）。</p>
<h6 id="讲解"><a href="#讲解" class="headerlink" title="讲解"></a>讲解</h6><p>而分组背包其实就类似于01背包，对于一个物品有两种决策选或不选，但是分组背包是在01背包的基础上对物品进行了分组，并且每一组只能最多选择一个物品，所以我们不妨用01背包的思想去思考分组背包.<br>分析：我们设$f[i][j]$为当前考虑到了第i组物品，剩余容里为j的背包能装物品的最大价值，那么很容易想到我们需要去枚举第i组物品，考虑选哪一个物品时最优的(或者不选)，状态转移方程就是$if(j&gt;=v[i][k])f[i][j]=max(f[i][j],f[i−1][j−v[i][k]]+w[i][k])$,$v[i][k]$和$w[i][k]$分别表示第i组物品中第k个物品的体积和价值。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= m; j++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= s[i]; k++)  <span class="comment">// s[i]表示第i组物品的个数</span></span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v[i][k])  <span class="comment">// 剩余的背包容量j大于第i组的第k个物品的体积</span></span><br><span class="line">            &#123;</span><br><span class="line">                f[i][j] = <span class="built_in">max</span>(f[i][j], f[i - <span class="number">1</span>][j - v[i][k]] + w[i][k]);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>
<p>这里我们还可以对空间进行优化，我们可以观察到，$f[i][…]$只会用到$f[i-1][…]$的值，所以数组的第一维的空间完全可以用滚动数组的方式处理掉，但是如何不影响状态转移呢，我们来看滚掉之后的状态转移方程，$f [ j ] = m a x ( f [ j ] , f [ j − v [ i ] [ k ] ] + w [ i ] [ k ] ) $,这里的max里面的$f [ j ]$ 和 $f [ j − v [ i ] [ k ] ]$ 其实是$f [ i − 1 ] [ j ] $和 $f [ i − 1 ] [ j − v [ i ] [ k ] ]$ ,而不是$f [ i ] [ j ] $和 $f [ i ] [ j − v [ i ] [ k ] ]$ ，所以我们需要对体积的遍历做一些修改，从大到小循环，如果还是从小到大循环的话，那么这里的$f [ j ]$ 和 $f [ j − v [ i ] [ k ] ]$的含义就有可能是$f [ i ] [ j ]$ 和 $f [ i ] [ j − v [ i ] [ k ] ] $，而不是我们需要的$f [ i − 1 ] [ j ]$ 和 $f [ i − 1 ] [ j − v [ i ] [ k ] ]$ 。</p>
<blockquote>
<p>我们以下方（有线电视网）一题为代表进行简单解释树形背包类的树形dp</p>
<p>我们设$dp[i][j]$表示在以i为根的子树中，满足j个客户的需求所能获得的最大收益,至于分组背包，我们设dp[i][u][j]表示以u为根的子树，仅用前i个儿子，满足j个客户取得最大价值，那么$dp[i][u][j]=max(dp[i-1][u][j-k]+dp[full_son_size[v]][v][k]);$而i这一维可以直接用滚动数组优化掉。<br>在本题中，我们设置了deep数组所含有的子节点的总数，所以状态转移的分组背包如下（注意由于滚动数组优化需要倒序读入【其实有的可以正序，但为了防止出错都倒序即可】）</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = deep[step]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = deep[next]; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">        dp[step][i] = <span class="built_in">max</span>(dp[step][i], dp[step][i - j] + dp[next][j] - g.e[k].val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里的状态转移方程对于树形dp非常典型：$dp[step][i] = max(dp[step][i], dp[step][i - j] + dp[next][j] + something );$这里的something多为体现树本身的一些性质（如背包问题中的重量等），且多为边或叶节点的性质。</p>
</blockquote>
<h6 id="一些细节"><a href="#一些细节" class="headerlink" title="一些细节"></a>一些细节</h6><p>对于树形背包问题而言，不可避免的就是使用dfs进行解题，而在刷题中最常使用的量是上文例子中的deep数组（含有的子节点的总数），而要注意对于叶节点而言要将deep数组的值设为1方便迭代，而对于对deep数组的更新而言，在进行背包之前和之后均可，只是要注意写法上有一定区别，具体可见以下两段代码。</p>
<p>在背包前更新：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">deep[step] += deep[next];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = deep[step]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = deep[next]; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">        dp[step][i] = <span class="built_in">max</span>(dp[step][i],</span><br><span class="line">                          dp[step][i - j] + dp[next][j] - g.e[k].val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>在背包后更新：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = deep[step]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = deep[next]; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">        dp[step][i + j] =</span><br><span class="line">            <span class="built_in">max</span>(dp[step][i + j], dp[step][i] + dp[next][j] - g.e[k].val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">deep[step] += deep[next];</span><br></pre></td></tr></table></figure></div>
<h6 id="树上背包问题详解："><a href="#树上背包问题详解：" class="headerlink" title="树上背包问题详解："></a>树上背包问题详解：</h6><blockquote>
<p>下面放一些我写博客时类似参考文献的东西，在此一并保留。</p>
</blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59459037/article/details/119189656?ops_request_misc=%7B%22request%5Fid%22%3A%22167446351016800222833585%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167446351016800222833585&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-119189656-null-null.142^v71^control,201^v4^add_ask&amp;utm_term=树形dp&amp;spm=1018.2226.3001.4187" >树形dp（超详细） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/RioTian/p/15163878.html" >【动态规划】树形DP完全详解！ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/no1_terminator/article/details/77824790" >多叉树的树形背包常见建模方法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/TheWayForDream/article/details/116567088?ops_request_misc=%7B%22request%5Fid%22%3A%22167456145316782428640910%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167456145316782428640910&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116567088-null-null.142^v71^control,201^v4^add_ask&amp;utm_term=分组背包&amp;spm=1018.2226.3001.4187" >背包问题——分组背包(超详细讲解) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="典型例题-1"><a href="#典型例题-1" class="headerlink" title="典型例题"></a>典型例题</h4><p><a class="link"   target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1352" >P1352 没有上司的舞会 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 6007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 99999997</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> r[M], n;</span><br><span class="line"><span class="type">bool</span> book[M], root[M];</span><br><span class="line">ll dp[M][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, link;</span><br><span class="line">&#125; Edge;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="type">int</span> head[M]; </span><br><span class="line">    <span class="type">int</span> edge_num = <span class="number">0</span>;</span><br><span class="line">    Edge e[M &lt;&lt; <span class="number">2</span>];</span><br><span class="line">&#125; Graph;</span><br><span class="line">Graph g;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    g.e[++g.edge_num].to = to;</span><br><span class="line">    g.e[g.edge_num].from = from;</span><br><span class="line">    g.e[g.edge_num].link = g.head[from];</span><br><span class="line">    g.head[from] = g.edge_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll step)</span> </span>&#123;</span><br><span class="line">    book[step] = <span class="number">1</span>;</span><br><span class="line">    dp[step][<span class="number">1</span>] = r[step];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g.head[step]; i != <span class="number">-1</span>; i = g.e[i].link) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!book[g.e[i].to]) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(g.e[i].to);</span><br><span class="line">            dp[step][<span class="number">0</span>] += <span class="built_in">max</span>(dp[g.e[i].to][<span class="number">0</span>], dp[g.e[i].to][<span class="number">1</span>]);</span><br><span class="line">            dp[step][<span class="number">1</span>] += dp[g.e[i].to][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">memset</span>(g.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(g.head));</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; r[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; v &gt;&gt; u;</span><br><span class="line">        <span class="built_in">add_edge</span>(u, v);</span><br><span class="line">        root[v] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!root[i]) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(i);</span><br><span class="line">            cout &lt;&lt; <span class="built_in">max</span>(dp[i][<span class="number">0</span>], dp[i][<span class="number">1</span>]) &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1273" >P1273 有线电视网 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 3007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> deep[M];</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, link;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">&#125; Edge;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">&#125; Node;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="type">int</span> head[N]; </span><br><span class="line">    <span class="type">int</span> node_num = <span class="number">0</span>;</span><br><span class="line">    Node p[N];</span><br><span class="line">    <span class="type">int</span> edge_num = <span class="number">0</span>;</span><br><span class="line">    Edge e[M];</span><br><span class="line">&#125; Graph;</span><br><span class="line">Graph g;</span><br><span class="line"><span class="type">int</span> dp[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> step, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dp[step][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (step &gt; n - m) &#123;</span><br><span class="line">        dp[step][<span class="number">1</span>] = g.p[step].val;</span><br><span class="line">        deep[step] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> k = g.head[step];</span><br><span class="line">    <span class="keyword">while</span> (k != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> next = g.e[k].to;</span><br><span class="line">        <span class="keyword">if</span> (fa == next) &#123;</span><br><span class="line">            k = g.e[k].link;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(next, step);</span><br><span class="line">        deep[step] += deep[next];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = deep[step]; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = deep[next]; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                dp[step][i] = <span class="built_in">max</span>(dp[step][i],</span><br><span class="line">                                  dp[step][i - j] + dp[next][j] - g.e[k].val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        k = g.e[k].link;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">    g.e[++g.edge_num].to = to;</span><br><span class="line">    g.e[g.edge_num].from = from;</span><br><span class="line">    g.e[g.edge_num].val = val;</span><br><span class="line">    g.e[g.edge_num].link = g.head[from];</span><br><span class="line">    g.head[from] = g.edge_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">memset</span>(g.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(g.head));</span><br><span class="line">    <span class="built_in">memset</span>(dp, ~<span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">int</span> k, v, w;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - m; i++) &#123;</span><br><span class="line">        cin &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= k; j++) &#123;</span><br><span class="line">            cin &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            <span class="built_in">add_edge</span>(i, v, w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - m + <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; g.p[i].val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dp[<span class="number">1</span>][m] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            cout &lt;&lt; m;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<h3 id="3-状态压缩dp"><a href="#3-状态压缩dp" class="headerlink" title="3.状态压缩dp"></a>3.状态压缩dp</h3><h4 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>状态压缩就是使用某种方法，简明扼要地以最小代价来表示某种状态，通常是用一串01数字（二进制数）来表示各个点的状态。这就要求使用状态压缩的对象的点的状态必须只有两种，0 或 1；当然如果有三种状态用三进制来表示也未尝不可。<br>状态压缩DP：顾名思义，就是用状态压缩实现DP（作为一名成熟的北航6系学子，我们可以很自然地联想有限状态机理解，状态压缩dp本质也是“空间换时间”）</p>
</blockquote>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p>状态压缩DP一般分为两类：</p>
<p>①<strong>基于连通性</strong>DP（棋盘式）<br>如下面的旅行者问题和互不侵犯问题。</p>
<p>②<strong>集合式</strong>（表示每一个元素是否在集合中）</p>
<p>见链接（实际较少）：<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_64226820/article/details/126333202" >状态压缩DP 图文详解（二） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="核心思路-2"><a href="#核心思路-2" class="headerlink" title="核心思路"></a>核心思路</h4><h5 id="位运算运用技巧"><a href="#位运算运用技巧" class="headerlink" title="位运算运用技巧"></a>位运算运用技巧</h5><blockquote>
<p>1.’&amp;’符号，x&amp;y，会将两个十进制数在二进制下进行与运算，然后返回其十进制下的值。<br>例如3(11)&amp;2(10)=2(10)。<br>2.’|’符号，x|y，会将两个十进制数在二进制下进行或运算，然后返回其十进制下的值。<br>例如3(11)|2(10)=3(11)。<br>3.’\^’符号，x\^y，会将两个十进制数在二进制下进行异或运算，然后返回其十进制下的值。<br>例如3(11)\^2(10)=1(01)。<br>4.’&lt;&lt;’符号，左移操作，x&lt;<2，将x在二进制下的每一位向左移动两位，最右边用0填充，x<<2相当于让x乘以4。相应的，’>&gt;’是右移操作，x&gt;&gt;1相当于给x/2，去掉x二进制下的最有一位。</p>
<p>这四种运算在状压dp中有着广泛的应用，常见的应用如下：<br>1.判断一个数字x二进制下第i位是不是等于1。<br>方法：if ( ( ( 1 &lt;&lt; ( i - 1 ) ) &amp; x ) &gt; 0)<br>将1左移i-1位，相当于制造了一个只有第i位上是1，其他位上都是0的二进制数。然后与x做与运算，如果结果&gt;0，说明x第i位上是1，反之则是0。<br>2.将一个数字x二进制下第i位更改成1。<br>方法：x = x | ( 1&lt;&lt;(i-1) )<br>证明方法与1类似，此处不再重复证明。<br>3.把一个数字二进制下最靠右的第一个1去掉。<br>方法：x=x&amp;(x-1)</p>
</blockquote>
<h5 id="位运算技巧在核心思路的应用"><a href="#位运算技巧在核心思路的应用" class="headerlink" title="位运算技巧在核心思路的应用"></a>位运算技巧在核心思路的应用</h5><p>而这些位运算的技巧具体要怎么使用呢，我们可以用状态压缩最经典的问题——“旅行商问题”进行简单的理解。<br><strong>（1）问题描述</strong>：旅行推销员问题（英语：Travelling salesman problem, TSP）是这样一个问题：给定一系列城市和每对城市之间的距离，求解访问每一座城市一次并回到起始城市的最短回路。（它是组合优化中的一个NP难问题，在运筹学和理论计算机科学中非常重要。）<br><strong>（2）如何运用状态压缩</strong><br>比如一共有5个点：1 2 3 4 5。现在要表示已经走过的地方和没走过的地方，我们可以用0,1来表示。其中0表示没到过，1表示到达过<br>那么对应的状态有<br>1 2 3 4 5<br>0 0 0 0 0（刚要开始走，还没有到达的地方）<br>0 0 0 0 1（已经到过第五个点）<br>0 0 0 1 0（已经到过第四个点）<br>0 0 0 1 1（已经到过第四，五个点）<br>……</p>
<p>我们发现以上的状态可以用二进制数表示，二进制数就是由0，1组成的。并且2^5可以涵盖所有的情况，从00000到11111；<br>$dp[i][s]$表示走到i这个点，已经经过的地方为s，此时所走过的最短路。<br><strong>（3）状态转移</strong><br>举个栗子，当s为11011的时候，s可以是由11001来，也可以是从11010来。那么我们可以运用位运算：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">    <span class="comment">// 是从j走到i的</span></span><br><span class="line">    <span class="keyword">if</span> (i == j || (s &amp; (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 没有j这个元素或者从i到i</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[i][s] = <span class="built_in">min</span>(dp[i][s], dp[j][s - (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] + <span class="built_in">dis</span>(i, j));  <span class="comment">// dis(i,j)为i到j的距离</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>在简要解释完最经典的状态dp问题后，我们以下方（互不侵犯）一题为代表进行简单解释状态压缩dp</p>
<h6 id="基本含义"><a href="#基本含义" class="headerlink" title="基本含义"></a>基本含义</h6><p>$dp[i][j][S]$代表:当第i行状态为j时，已经放置了S个国王的总方案数。<br>（小tips：如本题$dp[N][N * N][1 &lt;&lt; N]$的数组定义而言，对于状态压缩数组的各维变量的定义需要认真规范，否则很容易出现MLE或RE的情况）<br>$state[i]$用来记录可用状态的十进制i，$num[i]$用来记录状态i的国王数</p>
<h5 id="状态转移处理"><a href="#状态转移处理" class="headerlink" title="状态转移处理"></a>状态转移处理</h5><p>dp方程:$dp[i][j][S]=∑dp[i-1][t][S-num[j]]$<br>对于本题而言，有一个非常棘手的问题要处理——两个在同一行相邻的国王，这个情况的存在使得我们要一个个列举状态（而排除了这种情况我们就可以一行一行地处理，这也是状态压缩dp最常见的处理情况），所以为了排除这种情况，我们需要对状态预处理，并把可以使用的状态存储下来（所以对本题而言添加了额外的state和num数组。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &amp; (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        <span class="comment">//用这行代码排除了国王同行相邻的情况。</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; (<span class="number">1</span> &lt;&lt; j))</span><br><span class="line">            sum++;</span><br><span class="line">    &#125;</span><br><span class="line">    state[++cnt] = i;</span><br><span class="line">    num[cnt] = sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>然后就是正规的dp部分</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//初始化</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="comment">//行枚举</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123;</span><br><span class="line">        <span class="comment">//对于第i行，有cnt种状态，枚举每种状态(cnt在预处理中求出)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt;= k; l++) &#123;</span><br><span class="line">            <span class="comment">//枚举之前i-1行已经有的国王数</span></span><br><span class="line">            <span class="keyword">if</span> (l &gt;= num[j]) &#123;</span><br><span class="line">                <span class="comment">//可以摆放(l&lt;num[j],都没有那么多国王了，就不能摆了)</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t &lt;= cnt; t++) &#123;</span><br><span class="line">                    <span class="comment">//上一行的状态</span></span><br><span class="line">                    <span class="keyword">if</span> (state[j] &amp; state[t] | state[j] &amp; (state[t] &lt;&lt; <span class="number">1</span>) |</span><br><span class="line">                        state[j] &amp; (state[t] &gt;&gt; <span class="number">1</span>))</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="comment">//冲突则跳过</span></span><br><span class="line">                    dp[i][j][l] += dp[i - <span class="number">1</span>][t][l - num[j]];</span><br><span class="line">                    <span class="comment">//状态转移</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">    ans += dp[n][i][k];</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans;</span><br></pre></td></tr></table></figure></div>
<p>写在最后：当然对于dp的题而言，如果空间不足同样可以使用滚动数组进行优化，如本题dp行数这一元i就可以优化。如下面的邦邦的大合唱站队问题中的一维dp同样是用滚动数组进行了优化。</p>
</blockquote>
<h4 id="状态压缩dp的特例——插头dp"><a href="#状态压缩dp的特例——插头dp" class="headerlink" title="状态压缩dp的特例——插头dp"></a>状态压缩dp的特例——插头dp</h4><blockquote>
<p>插头dp在实际做题中很少，在此放两个链接做简要介绍即可。</p>
</blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/hollyidyllic/article/details/109961955?ops_request_misc=%7B%22request%5Fid%22%3A%22167409403416800215018091%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167409403416800215018091&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109961955-null-null.142^v71^control,201^v4^add_ask&amp;utm_term=插头dp&amp;spm=1018.2226.3001.4187" >从零开始的插头DP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/Emm_Titan/article/details/122281723?ops_request_misc=%7B%22request%5Fid%22%3A%22167409403416800215018091%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167409403416800215018091&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122281723-null-null.142^v71^control,201^v4^add_ask&amp;utm_term=插头dp&amp;spm=1018.2226.3001.4187" >简单的连通性状压DP——插头DP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="典型例题-2"><a href="#典型例题-2" class="headerlink" title="典型例题"></a>典型例题</h4><p><a class="link"   target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1896" >P1896 [SCOI2005] 互不侵犯  <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> n, k, cnt;</span><br><span class="line">ll dp[N][N * N][<span class="number">1</span> &lt;&lt; N], ans;</span><br><span class="line"><span class="type">int</span> state[M], num[M];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; (<span class="number">1</span> &lt;&lt; j))</span><br><span class="line">                sum++;</span><br><span class="line">        &#125;</span><br><span class="line">        state[++cnt] = i;</span><br><span class="line">        num[cnt] = sum;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt;= k; l++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (l &gt;= num[j]) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t &lt;= cnt; t++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (state[j] &amp; state[t] | state[j] &amp; (state[t] &lt;&lt; <span class="number">1</span>) |</span><br><span class="line">                            state[j] &amp; (state[t] &gt;&gt; <span class="number">1</span>))</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        dp[i][j][l] += dp[i - <span class="number">1</span>][t][l - num[j]];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">        ans += dp[n][i][k];</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3694" >P3694 邦邦的大合唱站队  <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> sum[M][N];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">1</span> &lt;&lt; N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            sum[i][j] = sum[i - <span class="number">1</span>][j];</span><br><span class="line">        &#125;</span><br><span class="line">        sum[i][x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; m); i++) &#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &amp; (i &gt;&gt; (j - <span class="number">1</span>))) &#123;</span><br><span class="line">                ret += sum[n][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &amp; (i &gt;&gt; (j - <span class="number">1</span>)))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            dp[i | (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))] = <span class="built_in">min</span>(</span><br><span class="line">                dp[i | (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))],</span><br><span class="line">                dp[i] + sum[n][j] - (sum[ret + sum[n][j]][j] - sum[ret][j]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; dp[(<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<h3 id="4-多维dp"><a href="#4-多维dp" class="headerlink" title="4.多维dp"></a>4.多维dp</h3><h4 id="定义-3"><a href="#定义-3" class="headerlink" title="定义"></a>定义</h4><p>多维dp问题指的是一个问题具有多个维度，通常可类比于二维数组取数问题，进行直接暴力dp的话时间和空间的复杂度为$O(n^4)$</p>
<h4 id="核心思路-3"><a href="#核心思路-3" class="headerlink" title="核心思路"></a>核心思路</h4><blockquote>
<p>以下方典型例题为例</p>
</blockquote>
<h5 id="暴力的四维dp"><a href="#暴力的四维dp" class="headerlink" title="暴力的四维dp"></a>暴力的四维dp</h5><p>对于传纸条可以选择从上面和左边进行选择<br>$f[i][j][p][q]=max(f[i−1][j][p−1][q],f[i][j−1][p−1][q],f[i−1][j][p][q−1],f[i][j−1][p][q−1])$</p>
<h5 id="四维dp优化为三维dp"><a href="#四维dp优化为三维dp" class="headerlink" title="四维dp优化为三维dp"></a>四维dp优化为三维dp</h5><p>我们可以使用k = i + j，使用k - i 代替j，k- p代替q，得到下面的状态转移方程<br>$f[k][i][p]=max(f[k−1][i−1][p],f[k−1][i][p],f[k−1][i][p−1],f[k−1][i-1][p-1])$</p>
<h5 id="三维dp优化为二维dp"><a href="#三维dp优化为二维dp" class="headerlink" title="三维dp优化为二维dp"></a>三维dp优化为二维dp</h5><p>通过观察上面的式子，我们可以发现前面的k其实并没有被用到，所以我们可以使用滚动数组进行优化，得到的结果就是 $f[i][p]=max(f[i−1][p],f[i][p],f[i][p−1],f[i−1][p−1])$</p>
<p>在此过程中我们只需要保证p &gt; 1即可</p>
<h4 id="典型例题-3"><a href="#典型例题-3" class="headerlink" title="典型例题"></a>典型例题</h4><p> <a class="link"   target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1006" >NOIP2008 提高组] 传纸条  <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> f[N][N], v[N][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">3</span>; k &lt;= n + m; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt; i; j--) &#123;</span><br><span class="line">                f[i][j] = <span class="built_in">max</span>(<span class="built_in">max</span>(f[i - <span class="number">1</span>][j], f[i - <span class="number">1</span>][j - <span class="number">1</span>]),</span><br><span class="line">                              <span class="built_in">max</span>(f[i][j - <span class="number">1</span>], f[i][j]));</span><br><span class="line">                f[i][j] += v[i][k - i] + v[j][k - j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, f[n - <span class="number">1</span>][n]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<h3 id="5-数位dp"><a href="#5-数位dp" class="headerlink" title="5.数位dp"></a>5.数位dp</h3><h4 id="定义-4"><a href="#定义-4" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>数位DP往往都是这样的题型，给定一个闭区间[ l , r ] ，让你求这个区间中满足某种条件的数的总数。而这个区间可能很大，简单的暴力代码如下：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= r; i++) &#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="built_in">check</span>(i))</span><br><span class="line">           ans++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>我们发现，若区间长度超过$1e8$，我们暴力枚举就会超时了，而数位DP则可以解决这样的题型。数位DP实际上就是在数位上进行DP。</p>
</blockquote>
<h4 id="核心思路-4"><a href="#核心思路-4" class="headerlink" title="核心思路"></a>核心思路</h4><blockquote>
<p>数位DP就是换一种暴力枚举的方式，使得新的枚举方式符合DP的性质，然后预处理好即可。 我们来看：我们可以用f(n)表示[0,n]的所有满足条件的个数，那么对于[l,r]我们就可以用[l,r]⟺f(r)−f(l−1)，相当于前缀和思想。那么也就是说我们只要求出f(n)即可。那么数位DP关键的思想就是从树的角度来考虑。将数拆分成位，从高位到低位开始枚举。我们可以视N为n位数，那么我们拆分$N:a<em>{n}、a</em>{n-1}…a_1$。那么我们就可以开始分解建树，如下。之后我们就可以预处理再求解$f(n)$了，个人认为求解$f(n)$是最难的一步。</p>
</blockquote>
<h4 id="典型例题-4"><a href="#典型例题-4" class="headerlink" title="典型例题"></a>典型例题</h4><h5 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h5><blockquote>
<p>求给定区间$ [X,Y]$ 中满足下列条件的整数个数：这个数恰好等于 K 个互不相等的 B 的整数次幂之和。例如，设 X = 15 , Y = 20 , K = 2 , B = 2 X=15,Y=20,K=2,B=2X=15,Y=20,K=2,B=2，则有且仅有下列三个数满足题意：<br>$17=2^4+2^0$<br>$18=2^4+2^1$<br>$20=2^4+2^2$</p>
<p>输入格式<br>第一行包含两个整数 X 和 Y，接下来两行包含整数 K 和 B。<br>输出格式<br>只包含一个整数，表示满足条件的数的个数。<br>数据范围<br>$1≤X≤Y≤2^{31}−1,$<br>$1≤K≤20,$<br>$2≤B≤10$<br> 输入样例：<br>15 20<br>2<br>2<br>输出样例：<br>3</p>
</blockquote>
<h5 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a><strong>解题思路</strong></h5><p>此题实际上就是将十进制数转化为B BB进制数，判断位数上的值是否为1 11。那么我们可以视N NN为n nn位数，那么我们拆分$N:a<em>{n}、a</em>{n-1}…a_1$ 。从树的角度考虑：我们设$N=76543210,B=10$，那么我们从高位往最低位开始枚举如下；枚举 $a_n$时，我们有两种选择：</p>
<ol>
<li>走右边分支，那么我们填 $7(a_n)$，而题目要求每一位只能填1或者0,而$a_n&gt;1$<br>，所以不是合法方案，我们直接剔除。</li>
<li>走左边分支，那么我们可以填$0~6$，即$0-{a_n}-1$，那么由于每一位只能填1或者0，所以我们累加这两种选择的方案。<br>记住，走到了左边分支是可以直接累加的。</li>
</ol>
<p>所以我们实际上还是要做一个预处理的，我们用$f[i][j]$表示还剩下$i$位没有填，且需要填写j个1的方案数。那么在$(i,j)$这个状态，我们可以选择填$1$，那么接下来的状态就是$f[i−1][j−1]$，而如果填$0$，那么接下来的状态就是$f[i−1][j]$，那么状态转移方程就是$f[i][j]=f[i−1][j]+f[i][j−1]$。而初始状态即是当j=0时，$f[i][0]=1$。这样我们就可以预处理f数组了。</p>
<p>处理完之后我们就可以直接模拟做了。</p>
<h5 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h5><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 3007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 2020</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> l, r, k, b;</span><br><span class="line"><span class="type">int</span> f[<span class="number">35</span>][<span class="number">35</span>];</span><br><span class="line"><span class="comment">// 首先我们先预处理f数组。其中f[i][j]表示剩下还有i个没填，需要填写j个1的方案数。</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!j)</span><br><span class="line">                f[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                f[i][j] = f[i - <span class="number">1</span>][j] + f[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 求解f(n)。我们需要避免n为0的情况，这里需要特判。</span></span><br><span class="line">    <span class="keyword">if</span> (!n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; nums;  <span class="comment">// 将n分割，存储位数。</span></span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        nums.<span class="built_in">push_back</span>(n % b);</span><br><span class="line">        n /= b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;  <span class="comment">// 答案。</span></span><br><span class="line">    <span class="type">int</span> last = <span class="number">0</span>;  <span class="comment">// 前面的信息，这里代表的是前面分支选取了多少个1.</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = nums.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">int</span> x = nums[i];</span><br><span class="line">        <span class="keyword">if</span> (x) &#123;</span><br><span class="line">            <span class="comment">// 说明x&gt;0，我们可以选择左边分支填0.</span></span><br><span class="line">            ans += f[i][k - last];</span><br><span class="line">            <span class="keyword">if</span> (x &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// 当x&gt;1我们才可以枚举左边分支填1.</span></span><br><span class="line">                <span class="keyword">if</span> (k - last - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// 如果还可以填1的话。</span></span><br><span class="line">                    ans += f[i][k - last - <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;  <span class="comment">// 因为右边分支只能为0或1，所以不符合条件。break。</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 当x=1就可以进入右边的分支继续讨论。</span></span><br><span class="line">                last++;</span><br><span class="line">                <span class="keyword">if</span> (last &gt; k)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 考虑到最后一位，如果符合条件那么末位填0也算一种方案。</span></span><br><span class="line">        <span class="keyword">if</span> (!i &amp;&amp; last == k)</span><br><span class="line">            ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r &gt;&gt; k &gt;&gt; b;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">dp</span>(r) - <span class="built_in">dp</span>(l - <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<h3 id="6-倍增优化dp"><a href="#6-倍增优化dp" class="headerlink" title="6.倍增优化dp"></a>6.倍增优化dp</h3><blockquote>
<p>放个链接：<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/The___Flash/article/details/104135861?ops_request_misc=%7B%22request%5Fid%22%3A%22167504329816800215047755%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167504329816800215047755&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-104135861-null-null.142^v71^control,201^v4^add_ask&amp;utm_term=倍增优化dp&amp;spm=1018.2226.3001.4187" >（算法竞赛进阶指南，倍增优化 DP） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<h2 id="模板题"><a href="#模板题" class="headerlink" title="模板题"></a>模板题</h2><h3 id="蓝桥杯-2021-省-A-左孩子右兄弟（树形dp）"><a href="#蓝桥杯-2021-省-A-左孩子右兄弟（树形dp）" class="headerlink" title="[蓝桥杯 2021 省 A] 左孩子右兄弟（树形dp）"></a>[蓝桥杯 2021 省 A] 左孩子右兄弟（树形dp）</h3><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><p>对于一棵多叉树，我们可以通过“左孩子右兄弟”表示法，将其转化成一棵二叉树。</p>
<p>如果我们认为每个结点的子结点是无序的，那么得到的二叉树可能不唯一。换句话说，每个结点可以选任意子结点作为左孩子，并按任意顺序连接右兄弟。</p>
<p>给定一棵包含 $N$ 个结点的多叉树，结点从 $1$ 至 $N$ 编号，其中 $1$ 号结点是根，每个结点的父结点的编号比自己的编号小。请你计算其通过”左孩子右兄弟”表示法转化成的二叉树，高度最高是多少。（只有根结点这一个结点的树高度为 $0$）</p>
<p>例如如下的多叉树：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_d8f144a59f4c0ce9322ag-11.jpg"
                      alt=""
                ></p>
<p>可能有以下 $3$ 种 (这里只列出 $3$ 种, 并不是全部) 不同的 “左孩子右兄弟” 表示: </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_d8f144a59f4c0ce9322ag-12.jpg"
                      alt=""
                ></p>
<p>其中最后一种高度最高, 为 $4$。</p>
<h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h4><p>输入的第一行包含一个整数 $N$ 。</p>
<p>以下 $N-1$ 行, 每行包含一个整数, 依次表示 $2$ 至 $N$ 号结点的父结点编号。</p>
<h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h4><p>输出一个整数表示答案。</p>
<h4 id="样例-1"><a href="#样例-1" class="headerlink" title="样例 #1"></a>样例 #1</h4><h5 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入 #1"></a>样例输入 #1</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure></div>
<h5 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出 #1"></a>样例输出 #1</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4</span><br></pre></td></tr></table></figure></div>
<h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>对于 $30 \%$ 的评测用例，$1 \leq N \leq 20$;</p>
<p>对于所有评测用例，$1 \leq N \leq 10^5$ 。 </p>
<p>蓝桥杯 2021 第一轮省赛 A 组 H 题。</p>
<h3 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h3><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 200007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 99999997</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> a[M];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, link;</span><br><span class="line">&#125; Edge;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">&#125; Node;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="type">int</span> head[N];  <span class="comment">// ;</span></span><br><span class="line">    <span class="type">int</span> node_num = <span class="number">0</span>;</span><br><span class="line">    Node p[N];</span><br><span class="line">    <span class="type">int</span> edge_num = <span class="number">0</span>;</span><br><span class="line">    Edge e[M];</span><br><span class="line">&#125; Graph;</span><br><span class="line">Graph g;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    g.e[++g.edge_num].to = to;</span><br><span class="line">    g.e[g.edge_num].from = from;</span><br><span class="line">    g.e[g.edge_num].link = g.head[from];</span><br><span class="line">    g.head[from] = g.edge_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> book[M], dp[M], maxi;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> step)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k = g.head[step];</span><br><span class="line">    <span class="keyword">while</span> (k != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!book[g.e[k].to]) &#123;</span><br><span class="line">            book[g.e[k].to] = <span class="number">1</span>;</span><br><span class="line">            dp[g.e[k].to] = dp[step] + g.p[step].l;</span><br><span class="line">            maxi = <span class="built_in">max</span>(maxi, dp[g.e[k].to]);</span><br><span class="line">            <span class="built_in">dfs</span>(g.e[k].to);</span><br><span class="line">            book[g.e[k].to] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        k = g.e[k].link;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">int</span> root;</span><br><span class="line">    <span class="built_in">memset</span>(g.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(g.head));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; root;</span><br><span class="line">        <span class="built_in">add_edge</span>(root, i);</span><br><span class="line">        g.p[root].l++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    cout &lt;&lt; maxi;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<h3 id="蓝桥杯-2021-省-AB2-国际象棋"><a href="#蓝桥杯-2021-省-AB2-国际象棋" class="headerlink" title="[蓝桥杯 2021 省 AB2] 国际象棋"></a>[蓝桥杯 2021 省 AB2] 国际象棋</h3><h4 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h4><p>众所周知， “八皇后” 问题是求解在国际象棋棋盘上摆放 $8$ 个皇后，使得两两之间互不攻击的方案数。已经学习了很多算法的小蓝觉得 “八皇后” 问题太简单了，意犹末尽。作为一个国际象棋迷，他想研究在 $N \times M$ 的棋盘上，摆放 $K$ 个马，使得两两之间互不攻击有多少种摆放方案。由于方案数可能很大，只需计算答案除以 $1000000007$ (即 $\left.10^{9}+7\right)$ 的余数。</p>
<p>如下图所示，国际象棋中的马摆放在棋盘的方格内，走 “日” 字, 位于 $(x, y)$ 格的马（第 $x$ 行第 $y$ 列）可以攻击 $(x+1, y+2),(x+1, y-2),(x-1, y+2),(x-1, y-2),(x+2, y+1),(x+2, y-1),(x-2, y+1),(x-2, y-1)$ 共 $8$ 个 格子。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_68f9131d5c14c1f27e68g-12.jpg"
                      alt=""
                ></p>
<h4 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h4><p>输入一行包含三个正整数 $N, M, K$, 分别表示棋盘的行数、列数和马的个数。</p>
<h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h4><p>输出一个整数，表示摆放的方案数除以 $1000000007\left(\right.$ 即 $\left.10^{9}+7\right)$ 的余数。</p>
<h4 id="样例-1-1"><a href="#样例-1-1" class="headerlink" title="样例 #1"></a>样例 #1</h4><h5 id="样例输入-1-1"><a href="#样例输入-1-1" class="headerlink" title="样例输入 #1"></a>样例输入 #1</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 1</span><br></pre></td></tr></table></figure></div>
<h5 id="样例输出-1-1"><a href="#样例输出-1-1" class="headerlink" title="样例输出 #1"></a>样例输出 #1</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure></div>
<h4 id="样例-2"><a href="#样例-2" class="headerlink" title="样例 #2"></a>样例 #2</h4><h5 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入 #2"></a>样例输入 #2</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4 4 3</span><br></pre></td></tr></table></figure></div>
<h5 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出 #2"></a>样例输出 #2</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">276</span><br></pre></td></tr></table></figure></div>
<h4 id="样例-3"><a href="#样例-3" class="headerlink" title="样例 #3"></a>样例 #3</h4><h5 id="样例输入-3"><a href="#样例输入-3" class="headerlink" title="样例输入 #3"></a>样例输入 #3</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 20 12</span><br></pre></td></tr></table></figure></div>
<h5 id="样例输出-3"><a href="#样例输出-3" class="headerlink" title="样例输出 #3"></a>样例输出 #3</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">914051446</span><br></pre></td></tr></table></figure></div>
<h4 id="提示-1"><a href="#提示-1" class="headerlink" title="提示"></a>提示</h4><p>对于 $5 \%$ 的评测用例, $K=1$;</p>
<p>对于另外 $10 \%$ 的评测用例, $K=2$;</p>
<p>对于另外 $10 \%$ 的评测用例, $N=1$;</p>
<p>对于另外 $20 \%$ 的评测用例, $N, M \leq 6, K \leq 5$;</p>
<p>对于另外 $25 \%$ 的评测用例, $N \leq 3, M \leq 20 ， K \leq 12$;</p>
<p>对于所有评测用例, $1 \leq N \leq 6,1 \leq M \leq 100,1 \leq K \leq 20$。 </p>
<p>蓝桥杯 2021 第二轮省赛 A 组 I 题（B 组 J 题）。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>这道题由于 $1 \le N \le 6$ 所以我们可以把每一列的状态用 0 或 1 表示，没放马或放马，于是我们就想到了<strong>状态压缩 dp</strong>。</p>
<p><strong>状态设计</strong>:</p>
<p>x 为这一列的情况，y 为上一列的情况，z 为上上列的情况，check(x) 表示 x状态中马的个数，$dp_{i,j,x,y} $表示第 i列放了 j个马且当前列的情况为 x，上一列为 y的方案数。</p>
<p><strong>状态初始化</strong>：</p>
<p>$dp_{0,0,0,0}=1$一开始就有一种情况。</p>
<p><strong>求马的个数</strong>：</p>
<p>其实就是求二进制中 1的个数。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (val) &#123;</span><br><span class="line">        ans++;</span><br><span class="line">        val &amp;= val - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>判断是否互相攻击</strong>：</p>
<ol>
<li>这一列与上一列判断：</li>
</ol>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*    *</span><br><span class="line">2    *</span><br><span class="line">*    *</span><br><span class="line">*    1</span><br><span class="line">*    *</span><br><span class="line">2    *</span><br><span class="line">*    *</span><br></pre></td></tr></table></figure></div>
<p>如上图，标记为 1的是马的位置，标记为 2的是它的攻击范围，所以只要通过左移两位和右移两位来判断是否互相攻击。</p>
<p>所以判断方法为：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x &amp; (y &lt;&lt; <span class="number">2</span>) || x &amp; (y &gt;&gt; <span class="number">2</span>)) <span class="keyword">continue</span>;</span><br></pre></td></tr></table></figure></div>
<ol>
<li>这一列与上上列判断：</li>
</ol>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*    *    *</span><br><span class="line">*    *    *</span><br><span class="line">2    *    *</span><br><span class="line">*    *    1</span><br><span class="line">2    *    *</span><br><span class="line">*    *    *</span><br><span class="line">*    *    *</span><br></pre></td></tr></table></figure></div>
<p>如图，标记为 1 的是马的位置，标记为 2 的是它的攻击范围，所以只要通过左移一位和右移一位来判断是否互相攻击。</p>
<p>所以判断的方法为：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x &amp; (z &lt;&lt; <span class="number">1</span>) || x &amp; (z &gt;&gt; <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br></pre></td></tr></table></figure></div>
<p><strong>方程转移</strong>：</p>
<p>首先我们需要枚举 j,范围就是 $get(x)+get(y)+get(z)$一直到 K。方程的转移就可以轻松写出来了，就是加上，上一列去掉这一列马的个数即 $dp_{i-1,j-get(x),y,z}$。</p>
<p>所以最后的方程就是 $dp<em>{i,j,x,y}=dp</em>{i,j,x,y}+dp_{i-1,j-get(x),y,z}$。</p>
<p>所以最后的答案为所有状态的总和，即：$ans=ans+dp_{m,k,i,j}$。i 和 j 是所有状态。</p>
<p><strong>总体思路</strong>：</p>
<p>先每一列枚举，再枚举这一列状态，上一列状态，判断是否互相攻击，之后再枚举上上列的状态，判断是否互相攻击，最后转移即可。最后一定要记住<strong>题目要取模</strong>。</p>
<h3 id="AC代码-1"><a href="#AC代码-1" class="headerlink" title="AC代码"></a>AC代码</h3><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>folding code </summary>
              <div class='content'>
              <div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="type">int</span> dp[<span class="number">101</span>][<span class="number">21</span>][<span class="number">1</span> &lt;&lt; <span class="number">6</span>][<span class="number">1</span> &lt;&lt; <span class="number">6</span>]; </span><br><span class="line"><span class="comment">// dp[m][k][1&lt;&lt;n][1&lt;&lt;n]</span></span><br><span class="line"><span class="type">int</span> n, m, k;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (val) &#123;</span><br><span class="line">        ans++;</span><br><span class="line">        val &amp;= val - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">NULL</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">0</span>; x &lt; (<span class="number">1</span> &lt;&lt; n); x++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">0</span>; y &lt; (<span class="number">1</span> &lt;&lt; n); y++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x &amp; (y &lt;&lt; <span class="number">2</span>) || x &amp; (y &gt;&gt; <span class="number">2</span>))</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> z = <span class="number">0</span>; z &lt; (<span class="number">1</span> &lt;&lt; n); z++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (y &amp; (z &lt;&lt; <span class="number">2</span>) || y &amp; (z &gt;&gt; <span class="number">2</span>))</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (x &amp; (z &lt;&lt; <span class="number">1</span>) || x &amp; (z &gt;&gt; <span class="number">1</span>))</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="type">int</span> t = <span class="built_in">check</span>(x) + <span class="built_in">check</span>(y) + <span class="built_in">check</span>(z);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> j = t; j &lt;= k; j++) &#123;</span><br><span class="line">                        dp[i][j][x][y] =</span><br><span class="line">                            (dp[i][j][x][y] + dp[i - <span class="number">1</span>][j - <span class="built_in">check</span>(x)][y][z]) %</span><br><span class="line">                            mod;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; n); j++) &#123;</span><br><span class="line">            ans = (ans + dp[m][k][i][j]) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> dynamic-programming-advance</li>
        <li><strong>Author:</strong> Charles</li>
        <li><strong>Created at:</strong> 2023-01-12 20:59:46</li>
        
            <li>
                <strong>Updated at:</strong> 2023-02-11 21:10:11
            </li>
        
        <li>
            <strong>Link:</strong> https://charles2530.github.io/2023/01/12/dynamic-programming-advance/
        </li>
        <li>
            <strong>License:</strong> This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>.
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/algorithm/">#algorithm</a>&nbsp;
                        </li>
                    
                </ul>
            

            <div class="recommended-article">
  <div class="recommended-article-header">
    <i aria-hidden="true"></i><span>recommend_articles</span>
  </div>
  <div class="recommended-article-group"><a class="recommended-article-item" href="/2022/12/28/markdown-note/" title="markdown-note" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p2.jpg" alt="markdown-note">
  <span class="title">markdown-note</span>
</a><a class="recommended-article-item" href="/2023/02/18/bash-note-1/" title="Bash-note-1" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.jfif" alt="Bash-note-1">
  <span class="title">Bash-note-1</span>
</a><a class="recommended-article-item" href="/2022/12/26/co-pre/" title="CO_Pre" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p4.jfif" alt="CO_Pre">
  <span class="title">CO_Pre</span>
</a></div>
</div>

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/01/12/game-theory-algorithm/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">game-theory-algorithm</span>
                                    <span class="post-nav-item">Prev posts</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/01/12/dynamic-programming-basis/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">dynamic-programming-basis</span>
                                    <span class="post-nav-item">Next posts</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
  <div id="comment-anchor"></div>
  <div class="comment-area-title">
    <i class="fa-solid fa-comments"></i>&nbsp;Comments
  </div>
  

  <!--  -->
  <script src="https://utteranc.es/client.js" repo="Charles2530/Charles2530.github.io" issue-term="pathname"
    label="Comment" theme="preferred-color-scheme" crossorigin="anonymous" async>
  </script>
  
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">dynamic-programming-advance</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#dynamic-programming-advance"><span class="nav-text">dynamic-programming-advance</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E8%BF%9B%E9%98%B6"><span class="nav-text">动态规划进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8C%BA%E9%97%B4dp"><span class="nav-text">1.区间dp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF"><span class="nav-text">核心思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8E%AF%E5%BD%A2%E5%8C%BA%E9%97%B4dp%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-text">环形区间dp的处理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98"><span class="nav-text">典型例题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%A0%91%E5%BD%A2dp"><span class="nav-text">2.树形dp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF-1"><span class="nav-text">核心思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E8%8A%82%E7%82%B9%E7%B1%BB"><span class="nav-text">选择节点类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%91%E5%BD%A2%E8%83%8C%E5%8C%85%E7%B1%BB"><span class="nav-text">树形背包类</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E8%83%8C%E5%8C%85%E5%AE%9A%E4%B9%89"><span class="nav-text">分组背包定义</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AE%B2%E8%A7%A3"><span class="nav-text">讲解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82"><span class="nav-text">一些细节</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%A0%91%E4%B8%8A%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E8%AF%A6%E8%A7%A3%EF%BC%9A"><span class="nav-text">树上背包问题详解：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98-1"><span class="nav-text">典型例题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9dp"><span class="nav-text">3.状态压缩dp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-2"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-text">分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF-2"><span class="nav-text">核心思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E8%BF%90%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="nav-text">位运算运用技巧</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E6%8A%80%E5%B7%A7%E5%9C%A8%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-text">位运算技巧在核心思路的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%90%AB%E4%B9%89"><span class="nav-text">基本含义</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB%E5%A4%84%E7%90%86"><span class="nav-text">状态转移处理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9dp%E7%9A%84%E7%89%B9%E4%BE%8B%E2%80%94%E2%80%94%E6%8F%92%E5%A4%B4dp"><span class="nav-text">状态压缩dp的特例——插头dp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98-2"><span class="nav-text">典型例题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%A4%9A%E7%BB%B4dp"><span class="nav-text">4.多维dp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-3"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF-3"><span class="nav-text">核心思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9A%B4%E5%8A%9B%E7%9A%84%E5%9B%9B%E7%BB%B4dp"><span class="nav-text">暴力的四维dp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%9B%E7%BB%B4dp%E4%BC%98%E5%8C%96%E4%B8%BA%E4%B8%89%E7%BB%B4dp"><span class="nav-text">四维dp优化为三维dp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%89%E7%BB%B4dp%E4%BC%98%E5%8C%96%E4%B8%BA%E4%BA%8C%E7%BB%B4dp"><span class="nav-text">三维dp优化为二维dp</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98-3"><span class="nav-text">典型例题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E6%95%B0%E4%BD%8Ddp"><span class="nav-text">5.数位dp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-4"><span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF-4"><span class="nav-text">核心思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98-4"><span class="nav-text">典型例题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A2%98%E9%9D%A2"><span class="nav-text">题面</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="nav-text">解题思路</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81"><span class="nav-text">参考代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E5%80%8D%E5%A2%9E%E4%BC%98%E5%8C%96dp"><span class="nav-text">6.倍增优化dp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E9%A2%98"><span class="nav-text">模板题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%93%9D%E6%A1%A5%E6%9D%AF-2021-%E7%9C%81-A-%E5%B7%A6%E5%AD%A9%E5%AD%90%E5%8F%B3%E5%85%84%E5%BC%9F%EF%BC%88%E6%A0%91%E5%BD%A2dp%EF%BC%89"><span class="nav-text">[蓝桥杯 2021 省 A] 左孩子右兄弟（树形dp）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F"><span class="nav-text">输入格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="nav-text">输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-1"><span class="nav-text">样例 #1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%85%A5-1"><span class="nav-text">样例输入 #1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%87%BA-1"><span class="nav-text">样例输出 #1</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E7%A4%BA"><span class="nav-text">提示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AC%E4%BB%A3%E7%A0%81"><span class="nav-text">AC代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%93%9D%E6%A1%A5%E6%9D%AF-2021-%E7%9C%81-AB2-%E5%9B%BD%E9%99%85%E8%B1%A1%E6%A3%8B"><span class="nav-text">[蓝桥杯 2021 省 AB2] 国际象棋</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%A0%BC%E5%BC%8F-1"><span class="nav-text">输入格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F-1"><span class="nav-text">输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-1-1"><span class="nav-text">样例 #1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%85%A5-1-1"><span class="nav-text">样例输入 #1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%87%BA-1-1"><span class="nav-text">样例输出 #1</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-2"><span class="nav-text">样例 #2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%85%A5-2"><span class="nav-text">样例输入 #2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%87%BA-2"><span class="nav-text">样例输出 #2</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-3"><span class="nav-text">样例 #3</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%85%A5-3"><span class="nav-text">样例输入 #3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B%E8%BE%93%E5%87%BA-3"><span class="nav-text">样例输出 #3</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E7%A4%BA-1"><span class="nav-text">提示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF"><span class="nav-text">思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AC%E4%BB%A3%E7%A0%81-1"><span class="nav-text">AC代码</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Charles</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        Total Page Views&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">Powered by Charles</span>
                <br>
            <span class="theme-version-container">Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.1.4</a>
        </div>
        
        
        
            <div id="start_div" style="display:none">
                2022/12/27 00:00:00
            </div>
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>



  
<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/layouts/navbarShrink.js"></script>

<script src="/js/tools/scrollTopBottom.js"></script>

<script src="/js/tools/lightDarkSwitch.js"></script>



    
<script src="/js/tools/localSearch.js"></script>




    
<script src="/js/tools/codeBlock.js"></script>




    
<script src="/js/layouts/lazyload.js"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/layouts/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>




    
<script src="/js/libs/minimasonry.min.js"></script>

    
<script src="/js/plugins/masonry.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/tools/tocToggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/layouts/toc.js"></script>

<script src="/js/plugins/tabs.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>



  
</body>

</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
