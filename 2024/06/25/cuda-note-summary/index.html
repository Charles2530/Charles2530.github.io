<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Charles">
    
    <meta name="author" content="Charles">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://charles2530.github.io/2024/06/25/cuda-note-summary/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="post by Charles in 2024-06-25 10:22:46">
<meta property="og:type" content="article">
<meta property="og:title" content="CUDA-note-summary">
<meta property="og:url" content="http://charles2530.github.io/2024/06/25/cuda-note-summary/index.html">
<meta property="og:site_name" content="Charles&#39;s Castle">
<meta property="og:description" content="post by Charles in 2024-06-25 10:22:46">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1719307189761-6.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/2-1719307192131-8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1719307205239-20.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/2-1719307208581-23.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3-1719307210782-26.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-1719307212979-29.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-1719307214987-32.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6-1719307217326-35.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/7.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3-1719307229277-44.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-1719307231426-47.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1719307237831-50.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/%E6%97%B6%E9%97%B4%E8%BD%B4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112332751.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112231716.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112434514.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112611093.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112649405.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112719527.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625112936534.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/cuda_thread.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/memory.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625115313113.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625115820221.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625115915177.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625120034724.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/fermi_sm.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/fermi.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/kepler.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/kepler_2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_9.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_10.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_11.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_10-1719307302965-79.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_12.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625121158349.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625122813904.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_13.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_14.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_2-1719307315559-88.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_15.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_16.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_4-1719307324404-97.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/excel.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_18.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/xianglin.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/jiaocuo.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_21.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_23.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625141733203.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_24.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1719307351089-114.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625142712784.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/3_26.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625144327320.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625150614484.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625151756403.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-6.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-9.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-10.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-11.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-12.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-13.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-14.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-15.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-16.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-17.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-18.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625152945418.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625153206249.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-19.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-20.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-21.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-22.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625153824815.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625153855669.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625154213625.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625154336659.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625154459118.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625155914202.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-10.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-11.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/4-4-13.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625160848025.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-6.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-7.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-9.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-10.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-11.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-11-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-12.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/5-12-1719307513385-201.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625163553913.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625163643634.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/re-1-8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/rect.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625164313920.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/re-5.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-3-1719307539591-212.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625165543828.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625165643634.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1-1719307543197-215.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-2-1719307546862-218.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170025114.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1-1719307553733-221.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-2-1719307555178-224.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-3-1719307556974-227.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170353274.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170439121.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170508863.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170545982.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170622294.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170721418.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-5-1719307564932-232.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170721418.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625170853139.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6-2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6-3.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/6-4.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625171045981.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625171325330.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/nvvp-6.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/nvvp-7.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/nvvp-8.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/re-0.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/re-1.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/nvvp-2.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625171615236.png">
<meta property="og:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/image-20240625171737082.png">
<meta property="article:published_time" content="2024-06-25T02:22:46.000Z">
<meta property="article:modified_time" content="2024-06-25T09:28:17.783Z">
<meta property="article:author" content="Du Jinyang">
<meta property="article:tag" content="GPU">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://charles2530.github.io/2024/06/25/image/CUDA-note-summary/1-1719307189761-6.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://charles2530.github.io/image/background/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://charles2530.github.io/image/background/favicon.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://charles2530.github.io/image/background/favicon.png">
    <!--- Page Info-->
    
    <title>
        
            CUDA-note-summary -
        
        Charles&#39;s Castle
    </title>

    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    
        
            
                
                    <script data-swup-reload-script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?8e0e5f382d14d87cbeadc33a36e71e86"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script>
                
    
            
    

    
        <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/anime.min.js"></script>
    <h1 class="ml13">
        Charles&#39;s Castle
    </h1>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });


        anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [100,0],
                translateZ: 0,
                opacity: [0,1],
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i
            }).add({
            targets: '.ml13 .letter',
            translateY: [0,-100],
            opacity: [1,0],
            easing: "easeInExpo",
            duration: 1200,
            delay: (el, i) => 100 + 30 * i
        });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            hidePreloaderAfterTimeout(1000); // Hide after 1000 milliseconds once the window has loaded
        });

        // Backup failsafe: Hide preloader after a maximum of 5000 milliseconds, regardless of the window load event
        hidePreloaderAfterTimeout(5000);

        function hidePreloaderAfterTimeout(delay) {
            setTimeout(function () {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function () {
                    preloader.style.display = 'none';
                }, 200);
            }, delay);
        }
    </script>
</div>
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/assets/build/styles.css">
    

    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fonts/fonts.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fonts/Satoshi/satoshi.css">
    <!--- Font Part-->
    
    
    
    


    <script id="hexo-configurations">
    window.config = {"hostname":"charles2530.github.io","root":"/","language":"en","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"5rem","h2":"4rem","h3":"2.8rem","h4":"2.5rem","h5":"2.2rem","h6":"2rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":true,"list":["lol","Neo","God"]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":true,"title":"recommend_articles","limit":3,"mobile_limit":2,"placeholder":"https://charles2530.github.io/image/background/p3.jfif","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":"#1890ff","default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://charles2530.github.io/image/background/background-light1.jpg","dark":"https://charles2530.github.io/image/background/background-dark1.jpg"},"title":"Charles's Castle","subtitle":{"text":["Happiness is best!","Never give up!","Everyday is a gift!"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#000000","dark":"#d1d1b6"},"text_style":{"title_size":"3.2rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"center","links":{"github":"https://github.com/Charles2530/","zhihu":"https://www.zhihu.com/people/yang-guang-xiao-zi-55-55","email":"charles2530@163.com"},"qrs":{"weixin":"https://charles2530.github.io/image/background/Wechat_icon.png"}}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null},{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.6.1","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Categories":{"path":"/categories","icon":"fas fa-bookmark"},"Tags":{"path":"/tags","icon":"fas fa-tags"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/Charles2530/","Blog":"https://charles2530.github.io","Statistics":"https://tongji.baidu.com/"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"This is Charles's Castle","show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Photos":{"icon":"fa-solid fa-image","path":"/masonry/"},"Essays":{"icon":"fa-solid fa-message-lines","path":"/essay/"},"Friends":{"icon":"fa-solid fa-user-group","path":"/friends/"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/12/27 00:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Charles's Castle" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="https://charles2530.github.io/image/background/logo.jpg">
                </a>
            
            <a class="logo-title" href="/">
                
                Charles&#39;s Castle
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fas fa-bookmark fa-fw"></i>
                                    CATEGORIES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fas fa-tags fa-fw"></i>
                                    TAGS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    ABOUT
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/Charles2530/">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="https://charles2530.github.io">
                                                    BLOG
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://tongji.baidu.com/">
                                                    STATISTICS
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                CATEGORIES
                            </span>
                            
                                <i class="fas fa-bookmark fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                TAGS
                            </span>
                            
                                <i class="fas fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                ABOUT
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/Charles2530/">GITHUB</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="https://charles2530.github.io">BLOG</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://tongji.baidu.com/">STATISTICS</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/archives"
                        >
                            <span>Archives</span>
                            <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/masonry/"
                        >
                            <span>Photos</span>
                            <i class="fa-solid fa-image fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/essay/"
                        >
                            <span>Essays</span>
                            <i class="fa-solid fa-message-lines fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/friends/"
                        >
                            <span>Friends</span>
                            <i class="fa-solid fa-user-group fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">23</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">77</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">292</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                
                
                <img src="https://charles2530.github.io/image/background/p5.jpg" alt="CUDA-note-summary" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75"/>
                
                <div class="w-full flex items-center absolute bottom-0 justify-start">
                    <h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-bold backdrop-blur-lg rounded-xl border border-border-color ">CUDA-note-summary</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="https://charles2530.github.io/image/background/logo2.jpg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Charles</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv7</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-06-25 10:22:46</span>
        <span class="mobile">2024-06-25 10:22:46</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-06-25 17:28:17</span>
            <span class="mobile">2024-06-25 17:28:17</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Machine-Learning/">Machine-Learning</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/Machine-Learning/CUDA/">CUDA</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/Machine-Learning/CUDA/note/">note</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/GPU/">GPU</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>73.9k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>287 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
<br />
<br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1719307189761-6.png"
                      alt="img" 
                ></p>
<blockquote>
<p></p>
</blockquote>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p>CUDA </p>
<ol>
<li><strong></strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">thread</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">block</td>
<td style="text-align:center">1 2 3</td>
<td style="text-align:center">4 5 6</td>
<td style="text-align:center">7 8 9</td>
<td style="text-align:center">10 11 12</td>
<td style="text-align:center">13 14 15</td>
</tr>
</tbody>
</table>
<ol start="2">
<li><strong></strong> 1  1 2  2 5  5 1  6</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">thread</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:left">5</th>
<th style="text-align:left">1</th>
<th style="text-align:left">2</th>
<th style="text-align:left">3</th>
<th style="text-align:left">4</th>
<th style="text-align:left">5</th>
<th style="text-align:left">1</th>
<th style="text-align:left">2</th>
<th style="text-align:left">3</th>
<th style="text-align:left">4</th>
<th style="text-align:left">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">block</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:left">5</td>
<td style="text-align:left">6</td>
<td style="text-align:left">7</td>
<td style="text-align:left">8</td>
<td style="text-align:left">9</td>
<td style="text-align:left">10</td>
<td style="text-align:left">11</td>
<td style="text-align:left">12</td>
<td style="text-align:left">13</td>
<td style="text-align:left">14</td>
<td style="text-align:left">15</td>
</tr>
</tbody>
</table>
<p><strong></strong><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/2-1719307192131-8.png"
                      alt="img" 
                ><br />
<strong></strong><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3.png"
                      alt="img" 
                ></p>
<blockquote>
<p></p>
</blockquote>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<h4 id="flynns-taxonomy"><a class="markdownIt-Anchor" href="#flynns-taxonomy"></a> Flynns Taxonomy</h4>
<p> Flynns Taxonomy CPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4.png"
                      alt="img" 
                ></p>
<p></p>
<ul>
<li> SISD386</li>
<li> SIMD CPU </li>
<li> MISD</li>
<li> MIMDMIMD  SIMD MIMD  SIMD</li>
</ul>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p><br />
 MB/s  GB/s <br />
 gflops </p>
<h4 id=""><a class="markdownIt-Anchor" href="#"></a> </h4>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5.png"
                      alt="img" 
                ></p>
<p> PCIe <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6.png"
                      alt="img" 
                ><br />
 many-core)<br />
GPU  CPU </p>
<ul>
<li>CPU </li>
<li>GPU </li>
</ul>
<h1 id="-cuda"><a class="markdownIt-Anchor" href="#-cuda"></a>  CUDA</h1>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
GPU <br />
GPU  CUDA  GPU </p>
<p>x86 CPU+GPU  CPU+FPGACPU+DSP CPU+GPU </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CPU  GPU  CPU host GPU device<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1719307205239-20.png"
                      alt="img" 
                ><br />
 CPU  GPU </p>
<ul>
<li>
<p> CPU  ALUALU DRAM CPU </p>
</li>
<li>
<p>GPU ALU SM ALU  Control  Cache CPU ALU control </p>
<blockquote>
<p> GPU  SM  CPU GPU  GPU  SM</p>
</blockquote>
</li>
</ul>
<p>CPU  GPU  PCIe <br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
<br />
 GPU  CPU  GPU  CPU <br />
NVIDIA </p>
<ul>
<li>Tegra</li>
<li>Geforce</li>
<li>Quadro</li>
<li>Tesla</li>
</ul>
<p> Tegra Geforce Tesla </p>
<p></p>
<p> GPU ******</p>
<ul>
<li>CUDA </li>
<li></li>
</ul>
<p>******:</p>
<ul>
<li></li>
<li></li>
</ul>
<p>nvidia  GPU </p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1.x</td>
<td style="text-align:left">Tesla</td>
</tr>
<tr>
<td style="text-align:left">2.x</td>
<td style="text-align:left">Fermi</td>
</tr>
<tr>
<td style="text-align:left">3.x</td>
<td style="text-align:left">Kepler</td>
</tr>
<tr>
<td style="text-align:left">4.x</td>
<td style="text-align:left">Maxwell</td>
</tr>
<tr>
<td style="text-align:left">5.x</td>
<td style="text-align:left">Pascal</td>
</tr>
<tr>
<td style="text-align:left">6.x</td>
<td style="text-align:left">Volta</td>
</tr>
</tbody>
</table>
<p> Tesla  Tesla </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CPU  GPU  GPU  CPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/2-1719307208581-23.png"
                      alt="img" 
                ></p>
<p> CPU<br />
 GPU</p>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3-1719307210782-26.png"
                      alt="img" 
                ></p>
<p>CPU  GPU </p>
<ol>
<li>CPU </li>
<li>GPU GPU </li>
<li>CPU  GPU </li>
</ol>
<h3 id="cuda"><a class="markdownIt-Anchor" href="#cuda"></a> CUDA</h3>
<p>CUDA  Nvidia GPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-1719307212979-29.png"
                      alt="img" 
                ></p>
<p>CUDA C  ANSI C  CUDA  API </p>
<p> API </p>
<ul>
<li>CUDA  API</li>
<li>CUDA  API</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-1719307214987-32.png"
                      alt="img" 
                ></p>
<p> API  API API  API API<br />
 API </p>
<p> CUDA </p>
<ul>
<li>CPU </li>
<li>GPU </li>
</ul>
<p>CUDA nvcc  C  C  CUDA C  nvcc  GPU </p>
<blockquote>
<p><strong></strong></p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6-1719307217326-35.png"
                      alt="img" 
                ></p>
<p>nvcc  LLVM </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/7.png"
                      alt="img" 
                ></p>
<p>CUDA  CUDA </p>
<h2 id="hello-world"><a class="markdownIt-Anchor" href="#hello-world"></a> Hello World</h2>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">hello_world</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;GPU: Hello world!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CPU: Hello world!\n&quot;</span>);</span><br><span class="line">    hello_world&lt;&lt;&lt;<span class="number">1</span>, <span class="number">10</span>&gt;&gt;&gt;();</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>(); <span class="comment">// if no this line ,it can not output hello world from gpu</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__global__</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello_world&lt;&lt;&lt;<span class="number">1</span>,<span class="number">10</span>&gt;&gt;&gt;();</span><br></pre></td></tr></table></figure></div>
<p> C <code>&lt;&lt;&lt;&gt;&gt;&gt;</code> CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaDeviceReset</span>();</span><br></pre></td></tr></table></figure></div>
<p>GPU  CPU  GPU  GPU CPU  GPU <br />
 CUDA </p>
<ol>
<li> GPU </li>
<li></li>
<li> CUDA </li>
<li></li>
<li></li>
</ol>
<blockquote>
<p>CPU  GPU  GPU </p>
</blockquote>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p></p>
<p>CUDA </p>
<ul>
<li></li>
<li></li>
</ul>
<p>CUDA C CUDA  GPU </p>
<p>CUDA </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p>NVIDIA </p>
<ul>
<li>Nvidia Nsight </li>
<li>CUDA-GDB </li>
<li></li>
<li>CUDA-MEMCHECK </li>
<li>GPU </li>
</ul>
<h1 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h1>
<h2 id="cuda--2"><a class="markdownIt-Anchor" href="#cuda--2"></a> CUDA </h2>
<p>CUDA  CUDA C OpenCL  GPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1.png"
                      alt="img" 
                ></p>
<p> Communication Abstraction <br />
GPU </p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p><br />
 CPU+GPU <br />
 GPU </p>
<ul>
<li> GPU </li>
<li> GPU </li>
</ul>
<p> CUDA </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
<br />
CUDA  CUDA  GPU <br />
</p>
<h2 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h2>
<p> CPU  GPU PCIe  PCIe </p>
<ul>
<li>CPU </li>
<li>GPU </li>
</ul>
<p>CUDA6.0 </p>
<p> CUDA <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/2.png"
                      alt="img" 
                ><br />
 host  host )</p>
<p></p>
<ul>
<li>
<p></p>
</li>
<li>
<p></p>
</li>
<li>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
</li>
<li>
<p></p>
</li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>CUDA  CUDA  API  CDUA </p>
<p> API  CUDA C  API </p>
<table>
<thead>
<tr>
<th style="text-align:center"> C </th>
<th style="text-align:center">CUDA C </th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">malloc</td>
<td style="text-align:center">cudaMalloc</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">memcpy</td>
<td style="text-align:center">cudaMemcpy</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">memset</td>
<td style="text-align:center">cudaMemset</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">free</td>
<td style="text-align:center">cudaFree</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpy</span><span class="params">(<span class="type">void</span> * dst,<span class="type">const</span> <span class="type">void</span> * src,<span class="type">size_t</span> count,</span></span></span><br><span class="line"><span class="params"><span class="function">  cudaMemcpyKind kind)</span></span></span><br></pre></td></tr></table></figure></div>
<p>cudaMemcpyKind kind</p>
<ul>
<li>cudaMemcpyHostToHost</li>
<li>cudaMemcpyHostToDevice</li>
<li>cudaMemcpyDeviceToHost</li>
<li>cudaMemcpyDeviceToDevice</li>
</ul>
<blockquote>
<p> cudaSuccess  cudaErrorMemoryAllocation</p>
</blockquote>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span>* <span class="title">cudaGetErrorString</span><span class="params">(cudaError_t error)</span></span></span><br></pre></td></tr></table></figure></div>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3-1719307229277-44.png"
                      alt="img" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaMalloc</span>((<span class="type">float</span>**)&amp;a_d,nByte);</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p> h<em> hostd</em> device</p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> GPU  grid grid <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-1719307231426-47.png"
                      alt="img" 
                ></p>
<p> block </p>
<ul>
<li></li>
<li></li>
</ul>
<blockquote>
<p></p>
</blockquote>
<p><br />
</p>
<ul>
<li>blockIdx</li>
<li>threadIdx</li>
</ul>
<p> Idx  index  uint3 </p>
<ul>
<li>blockIdx.x</li>
<li>blockIdx.y</li>
<li>blockIdx.z</li>
<li>threadIdx.x</li>
<li>threadIdx.y</li>
<li>threadIdx.z</li>
</ul>
<p> blockIdx  threadIdx </p>
<ul>
<li>blockDim</li>
<li>gridDim</li>
</ul>
<p> dim3 ( uint3 ) x,y,z.</p>
<ul>
<li>blockDim.x</li>
<li>blockDim.y</li>
<li>blockDim.z</li>
</ul>
<p></p>
<blockquote>
<p>dim3 uint3  uint3 </p>
</blockquote>
<p><br />
 CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> CUDA  NVCC  GPU  CUDA  CUDA </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> ANSI C  CUDA C </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel_name&lt;&lt;&lt;grid,block&gt;&gt;&gt;(argument list);</span><br></pre></td></tr></table></figure></div>
<p> C  C </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">function_name</span>(argument list);</span><br></pre></td></tr></table></figure></div>
<p><code>&lt;&lt;&lt;grid,block&gt;&gt;&gt;</code> CUDA C  dim3  grid  block grid  block  uint3 <br />
 grid  block </p>
<ul>
<li></li>
<li></li>
</ul>
<p> dim3  grid  block  int </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel_name&lt;&lt;&lt;<span class="number">4</span>,<span class="number">8</span>&gt;&gt;&gt;(argument list);</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1719307237831-50.png"
                      alt="img" 
                ></p>
<p>.</p>
<blockquote>
<p> threadIdx.x  blockIdx.x .</p>
</blockquote>
<p></p>
<ol>
<li></li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel_name&lt;&lt;&lt;<span class="number">1</span>,<span class="number">32</span>&gt;&gt;&gt;(argument list);</span><br></pre></td></tr></table></figure></div>
<ol>
<li>32 </li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel_name&lt;&lt;&lt;<span class="number">32</span>,<span class="number">1</span>&gt;&gt;&gt;(argument list);</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p></p>
</blockquote>
<p>,<strong></strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceSynchronize</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpy</span><span class="params">(<span class="type">void</span>* dst,<span class="type">const</span> <span class="type">void</span> * src,</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="type">size_t</span> count,cudaMemcpyKind kind)</span></span>;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p> CUDA  C </p>
</blockquote>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel_name</span><span class="params">(argument list)</span></span>;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p><strong> CUDA  C </strong></p>
</blockquote>
<p> C <strong>global</strong> ,CUDA C  C </p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>global</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"> 3 </td>
<td style="text-align:center"> void </td>
</tr>
<tr>
<td style="text-align:center"><strong>device</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>host</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<blockquote>
<p> <strong>device</strong>  <strong>host</strong>  C  nvcc </p>
</blockquote>
<p>Kernel </p>
<ol>
<li></li>
<li> void </li>
<li></li>
<li></li>
<li></li>
</ol>
<p> for  for </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArraysOnHost</span><span class="params">(<span class="type">float</span> *A, <span class="type">float</span> *B, <span class="type">float</span> *C, <span class="type">const</span> <span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">    C[i] = A[i] + B[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysOnGPU</span><span class="params">(<span class="type">float</span> *A, <span class="type">float</span> *B, <span class="type">float</span> *C)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i = threadIdx.x;</span><br><span class="line">  C[i] = A[i] + B[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> CUDA </p>
<blockquote>
<p>CUDA </p>
<p><code>kernel_name&lt;&lt;&lt;1,1&gt;&gt;&gt;(argument list)</code></p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> CHECK(call)                                                          \</span></span><br><span class="line"><span class="meta">    &#123;                                                                        \</span></span><br><span class="line"><span class="meta">        const cudaError_t <span class="keyword">error</span> = call;                                      \</span></span><br><span class="line"><span class="meta">        <span class="keyword">if</span> (<span class="keyword">error</span> != cudaSuccess) &#123;                                          \</span></span><br><span class="line"><span class="meta">            printf(<span class="string">&quot;ERROR: %s:%d,&quot;</span>, __FILE__, __LINE__);                     \</span></span><br><span class="line"><span class="meta">            printf(<span class="string">&quot;code:%d,reason:%s\n&quot;</span>, <span class="keyword">error</span>, cudaGetErrorString(<span class="keyword">error</span>)); \</span></span><br><span class="line"><span class="meta">            exit(1);                                                         \</span></span><br><span class="line"><span class="meta">        &#125;                                                                    \</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br></pre></td></tr></table></figure></div>
<p>CUDA C  API </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<h2 id="-cpu-"><a class="markdownIt-Anchor" href="#-cpu-"></a>  CPU </h2>
<p> cpu  C </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">clock_t</span> start, finish;</span><br><span class="line">start = <span class="built_in">clock</span>();</span><br><span class="line"><span class="comment">// </span></span><br><span class="line">finish = <span class="built_in">clock</span>();</span><br><span class="line">duration = (<span class="type">double</span>)(finish - start) / CLOCKS_PER_SEC;</span><br></pre></td></tr></table></figure></div>
<p> clock()clock (ticks) CLOCKS_PER_SEC  clocks</p>
<blockquote>
<p><strong> clock c </strong></p>
</blockquote>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/time.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">cpuSecond</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">timeval</span> tp;</span><br><span class="line">  <span class="built_in">gettimeofday</span>(&amp;tp,<span class="literal">NULL</span>);</span><br><span class="line">  <span class="keyword">return</span>((<span class="type">double</span>)tp.tv_sec+(<span class="type">double</span>)tp.tv_usec*<span class="number">1e-6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>gettimeofday  linux  cpu  1970  1  1  0  sys/time.h</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; N)</span><br><span class="line">        res[i] = a[i] + b[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// timer</span></span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> iStart  cpuSecond </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaDeviceSynchronize</span>();</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/%E6%97%B6%E9%97%B4%E8%BD%B4.png"
                      alt="img" 
                ><br />
</p>
<ol>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
<p> 2~4  CPU  1~5 <br />
</p>
<ul>
<li>2  1&lt;&lt;2416 
<ul>
<li> 256 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112332751.png"
                      alt="image-20240625112332751" 
                ></li>
<li> 512 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112231716.png"
                      alt="image-20240625112231716" 
                ></li>
<li> 1024 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112434514.png"
                      alt="image-20240625112434514" 
                ></li>
</ul>
</li>
<li>2  (1&lt;&lt;24)+116 
<ul>
<li> 256 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112611093.png"
                      alt="image-20240625112611093" 
                ></li>
<li> 512 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112649405.png"
                      alt="image-20240625112649405" 
                ></li>
<li> 1024 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112719527.png"
                      alt="image-20240625112719527" 
                ></li>
</ul>
</li>
</ul>
<blockquote>
<p> 12  cpu </p>
</blockquote>
<h2 id="-nvprof-"><a class="markdownIt-Anchor" href="#-nvprof-"></a>  nvprof </h2>
<p>CUDA 5.0  nvprof <br />
nvprof </p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvprof [nvprof_args] &lt;application&gt;[application_args]</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625112936534.png"
                      alt="image-20240625112936534" 
                ><br />
 kernel  cuda <br />
nvprof </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 2  10  2.01 <br />
</p>
<ul>
<li>Tesla K10 745MHz  x 2GPU/ x8  x 192  x 32 / x 2 OPS/ =4.58 TFLOPS</li>
<li>Tesla K10  2GPU/ x 256  x 2500 MHz  x 2 DDR/8 / = 320 GB/s</li>
<li> 4.58 TFLOPS/320 GB/s =13.6  1 </li>
</ul>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<blockquote>
<p></p>
</blockquote>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/cuda_thread.png"
                      alt="img" 
                ><br />
(ix,iy)(threadIdx.x,threadIdx.y)<br />
</p>
<p><code>ix=threadIdx.x+blockIdx.xblockDim.x</code></p>
<p></p>
<p><code>iy=threadIdx.y+blockIdx.yblockDim.y</code></p>
<p> kernel  CUDA CUDA <br />
 (86)(86)<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/memory.png"
                      alt="img" 
                ></p>
<p></p>
<ul>
<li></li>
<li>ix,iy</li>
<li>(ix,iy)</li>
</ul>
<p></p>
<p><code>idx=ix+iynx</code></p>
<p>(ix,iy)(ix,iy)<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">printThreadIndex</span><span class="params">(<span class="type">float</span> *A, <span class="type">const</span> <span class="type">int</span> nx, <span class="type">const</span> <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockIdx.x * blockDim.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockIdx.y * blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = iy * nx + ix;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;thread_id(%d,%d) block_id(%d,%d) coordinate(%d,%d)&quot;</span></span><br><span class="line">           <span class="string">&quot;global index %2d ival %2d\n&quot;</span>,</span><br><span class="line">           threadIdx.x, threadIdx.y,</span><br><span class="line">           blockIdx.x, blockIdx.y, ix, iy, idx, A[idx]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumMatrix</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">float</span> *MatC, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx = ix + iy * ny;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatC[idx] = MatA[idx] + MatB[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumMatrix2D_CPU</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">float</span> *MatC, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> *a = MatA;</span><br><span class="line">    <span class="type">float</span> *b = MatB;</span><br><span class="line">    <span class="type">float</span> *c = MatC;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; ny; j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nx; i++) &#123;</span><br><span class="line">            c[i] = a[i] + b[i];</span><br><span class="line">        &#125;</span><br><span class="line">        c += nx;</span><br><span class="line">        b += nx;</span><br><span class="line">        a += nx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumMatrix</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">float</span> *MatC, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx = ix + iy * ny;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatC[idx] = MatA[idx] + MatB[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;starting...\n&quot;</span>);</span><br><span class="line">    <span class="built_in">initDevice</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> nx = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> ny = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> nxy = nx * ny;</span><br><span class="line">    <span class="type">int</span> nBytes = nxy * <span class="built_in">sizeof</span>(<span class="type">float</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Malloc</span></span><br><span class="line">    <span class="type">float</span> *A_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *B_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *C_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *C_from_gpu = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="built_in">initialData</span>(A_host, nxy);</span><br><span class="line">    <span class="built_in">initialData</span>(B_host, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cudaMalloc</span></span><br><span class="line">    <span class="type">float</span> *A_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">float</span> *B_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">float</span> *C_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;A_dev, nBytes));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;B_dev, nBytes));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;C_dev, nBytes));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(A_dev, A_host, nBytes, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(B_dev, B_host, nBytes, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> dimx = <span class="number">32</span>;</span><br><span class="line">    <span class="type">int</span> dimy = <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cpu compute</span></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(C_from_gpu, C_dev, nBytes, cudaMemcpyDeviceToHost);</span><br><span class="line">    <span class="type">double</span> iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    <span class="built_in">sumMatrix2D_CPU</span>(A_host, B_host, C_host, nx, ny);</span><br><span class="line">    <span class="type">double</span> iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CPU Execution Time elapsed %f sec\n&quot;</span>, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2d block and 2d grid</span></span><br><span class="line">    <span class="function">dim3 <span class="title">block_0</span><span class="params">(dimx, dimy)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid_0</span><span class="params">((nx - <span class="number">1</span>) / block_0.x + <span class="number">1</span>, (ny - <span class="number">1</span>) / block_0.y + <span class="number">1</span>)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumMatrix&lt;&lt;&lt;grid_0, block_0&gt;&gt;&gt;(A_dev, B_dev, C_dev, nx, ny);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;GPU Execution configuration&lt;&lt;&lt;(%d,%d),(%d,%d)&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>,</span><br><span class="line">           grid_0.x, grid_0.y, block_0.x, block_0.y, iElaps);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(C_from_gpu, C_dev, nBytes, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">checkResult</span>(C_host, C_from_gpu, nxy);</span><br><span class="line">    <span class="comment">// 1d block and 1d grid</span></span><br><span class="line">    dimx = <span class="number">32</span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">block_1</span><span class="params">(dimx)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid_1</span><span class="params">((nxy - <span class="number">1</span>) / block_1.x + <span class="number">1</span>)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumMatrix&lt;&lt;&lt;grid_1, block_1&gt;&gt;&gt;(A_dev, B_dev, C_dev, nx * ny, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;GPU Execution configuration&lt;&lt;&lt;(%d,%d),(%d,%d)&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>,</span><br><span class="line">           grid_1.x, grid_1.y, block_1.x, block_1.y, iElaps);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(C_from_gpu, C_dev, nBytes, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">checkResult</span>(C_host, C_from_gpu, nxy);</span><br><span class="line">    <span class="comment">// 2d block and 1d grid</span></span><br><span class="line">    dimx = <span class="number">32</span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">block_2</span><span class="params">(dimx)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid_2</span><span class="params">((nx - <span class="number">1</span>) / block_2.x + <span class="number">1</span>, ny)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumMatrix&lt;&lt;&lt;grid_2, block_2&gt;&gt;&gt;(A_dev, B_dev, C_dev, nx, ny);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;GPU Execution configuration&lt;&lt;&lt;(%d,%d),(%d,%d)&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>,</span><br><span class="line">           grid_2.x, grid_2.y, block_2.x, block_2.y, iElaps);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(C_from_gpu, C_dev, nBytes, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">checkResult</span>(C_host, C_from_gpu, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(A_dev);</span><br><span class="line">    <span class="built_in">cudaFree</span>(B_dev);</span><br><span class="line">    <span class="built_in">cudaFree</span>(C_dev);</span><br><span class="line">    <span class="built_in">free</span>(A_host);</span><br><span class="line">    <span class="built_in">free</span>(B_host);</span><br><span class="line">    <span class="built_in">free</span>(C_host);</span><br><span class="line">    <span class="built_in">free</span>(C_from_gpu);</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625115313113.png"
                      alt="image-20240625115313113" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> CPU </p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h1 id="gpu-"><a class="markdownIt-Anchor" href="#gpu-"></a> GPU </h1>
<h2 id="api--gpu-"><a class="markdownIt-Anchor" href="#api--gpu-"></a> API  GPU </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s Starting ...\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">int</span> deviceCount = <span class="number">0</span>;</span><br><span class="line">    cudaError_t error_id = <span class="built_in">cudaGetDeviceCount</span>(&amp;deviceCount);</span><br><span class="line">    <span class="keyword">if</span> (error_id != cudaSuccess) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;cudaGetDeviceCount returned %d\n -&gt;%s\n&quot;</span>,</span><br><span class="line">               (<span class="type">int</span>)error_id, <span class="built_in">cudaGetErrorString</span>(error_id));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Result = FAIL\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (deviceCount == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;There are no available device(s) that support CUDA\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Detected %d CUDA Capable device(s)\n&quot;</span>, deviceCount);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>, driverVersion = <span class="number">0</span>, runtimeVersion = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line">    cudaDeviceProp deviceProp;</span><br><span class="line">    <span class="built_in">cudaGetDeviceProperties</span>(&amp;deviceProp, dev);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Device %d:\&quot;%s\&quot;\n&quot;</span>, dev, deviceProp.name);</span><br><span class="line">    <span class="built_in">cudaDriverGetVersion</span>(&amp;driverVersion);</span><br><span class="line">    <span class="built_in">cudaRuntimeGetVersion</span>(&amp;runtimeVersion);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  CUDA Driver Version / Runtime Version         %d.%d  /  %d.%d\n&quot;</span>,</span><br><span class="line">           driverVersion / <span class="number">1000</span>, (driverVersion % <span class="number">100</span>) / <span class="number">10</span>,</span><br><span class="line">           runtimeVersion / <span class="number">1000</span>, (runtimeVersion % <span class="number">100</span>) / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  CUDA Capability Major/Minor version number:   %d.%d\n&quot;</span>,</span><br><span class="line">           deviceProp.major, deviceProp.minor);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Total amount of global memory:                %.2f GBytes (%llu bytes)\n&quot;</span>,</span><br><span class="line">           (<span class="type">float</span>)deviceProp.totalGlobalMem / <span class="built_in">pow</span>(<span class="number">1024.0</span>, <span class="number">3</span>), deviceProp.totalGlobalMem);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  GPU Clock rate:                               %.0f MHz (%0.2f GHz)\n&quot;</span>,</span><br><span class="line">           deviceProp.clockRate * <span class="number">1e-3</span>f, deviceProp.clockRate * <span class="number">1e-6</span>f);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Memory Bus width:                             %d-bits\n&quot;</span>,</span><br><span class="line">           deviceProp.memoryBusWidth);</span><br><span class="line">    <span class="keyword">if</span> (deviceProp.l2CacheSize) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  L2 Cache Size:                            	%d bytes\n&quot;</span>,</span><br><span class="line">               deviceProp.l2CacheSize);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Max Texture Dimension Size (x,y,z)            1D=(%d),2D=(%d,%d),3D=(%d,%d,%d)\n&quot;</span>,</span><br><span class="line">           deviceProp.maxTexture1D, deviceProp.maxTexture2D[<span class="number">0</span>], deviceProp.maxTexture2D[<span class="number">1</span>], deviceProp.maxTexture3D[<span class="number">0</span>], deviceProp.maxTexture3D[<span class="number">1</span>], deviceProp.maxTexture3D[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Max Layered Texture Size (dim) x layers       1D=(%d) x %d,2D=(%d,%d) x %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxTexture1DLayered[<span class="number">0</span>], deviceProp.maxTexture1DLayered[<span class="number">1</span>],</span><br><span class="line">           deviceProp.maxTexture2DLayered[<span class="number">0</span>], deviceProp.maxTexture2DLayered[<span class="number">1</span>],</span><br><span class="line">           deviceProp.maxTexture2DLayered[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Total amount of constant memory               %lu bytes\n&quot;</span>,</span><br><span class="line">           deviceProp.totalConstMem);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Total amount of shared memory per block:      %lu bytes\n&quot;</span>,</span><br><span class="line">           deviceProp.sharedMemPerBlock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Total number of registers available per block:%d\n&quot;</span>,</span><br><span class="line">           deviceProp.regsPerBlock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Wrap size:                                    %d\n&quot;</span>, deviceProp.warpSize);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Maximum number of thread per multiprocesser:  %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxThreadsPerMultiProcessor);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Maximum number of thread per block:           %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxThreadsPerBlock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Maximum size of each dimension of a block:    %d x %d x %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxThreadsDim[<span class="number">0</span>], deviceProp.maxThreadsDim[<span class="number">1</span>], deviceProp.maxThreadsDim[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Maximum size of each dimension of a grid:     %d x %d x %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxGridSize[<span class="number">0</span>],</span><br><span class="line">           deviceProp.maxGridSize[<span class="number">1</span>],</span><br><span class="line">           deviceProp.maxGridSize[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  Maximum memory pitch                           %lu bytes\n&quot;</span>, deviceProp.memPitch);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;----------------------------------------------------------\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Number of multiprocessors:                      %d\n&quot;</span>, deviceProp.multiProcessorCount);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Total amount of constant memory:                %4.2f KB\n&quot;</span>,</span><br><span class="line">           deviceProp.totalConstMem / <span class="number">1024.0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Total amount of shared memory per block:        %4.2f KB\n&quot;</span>,</span><br><span class="line">           deviceProp.sharedMemPerBlock / <span class="number">1024.0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Total number of registers available per block:  %d\n&quot;</span>,</span><br><span class="line">           deviceProp.regsPerBlock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Warp size                                       %d\n&quot;</span>, deviceProp.warpSize);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Maximum number of threads per block:            %d\n&quot;</span>, deviceProp.maxThreadsPerBlock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Maximum number of threads per multiprocessor:  %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxThreadsPerMultiProcessor);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Maximum number of warps per multiprocessor:     %d\n&quot;</span>,</span><br><span class="line">           deviceProp.maxThreadsPerMultiProcessor / <span class="number">32</span>);</span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625115820221.png"
                      alt="image-20240625115820221" 
                ></p>
<p></p>
<ol>
<li>CUDA </li>
<li></li>
<li>1.95G</li>
<li>GPU </li>
<li>GPU </li>
<li>L2 </li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
<p></p>
<h2 id="nvidia-smi"><a class="markdownIt-Anchor" href="#nvidia-smi"></a> NVIDIA-SMI</h2>
<p>nvidia-smi  nvidia </p>
<blockquote>
<p>nvitop</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625115915177.png"
                      alt="image-20240625115915177" 
                ><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625120034724.png"
                      alt="image-20240625120034724" 
                ><br />
<br />
</p>
<ul>
<li>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
</li>
<li>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
</li>
</ul>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi -q -i</span><br></pre></td></tr></table></figure></div>
<h1 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h1>
<p> CUDA  CUDA  CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>CUDA  GPU <br />
<br />
 CUDA </p>
<h2 id="gpu-"><a class="markdownIt-Anchor" href="#gpu-"></a> GPU </h2>
<p>GPU SM GPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/fermi_sm.png"
                      alt="img" 
                ></p>
<p></p>
<ul>
<li>
<p>CUDA </p>
</li>
<li>
<p>/</p>
</li>
<li>
<p></p>
</li>
<li>
<p>/</p>
</li>
<li>
<p></p>
</li>
<li>
<p></p>
</li>
</ul>
<h3 id="sm"><a class="markdownIt-Anchor" href="#sm"></a> SM</h3>
<p>GPU  SM  GPU  SM block  SM </p>
<blockquote>
<p><strong>:</strong>  blcok  SM  SM  SM  SM </p>
</blockquote>
<p> SM </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CUDA  SIMT  32 SM  block block  TSM  32 </p>
<h3 id="simd-vs-simt"><a class="markdownIt-Anchor" href="#simd-vs-simt"></a> SIMD vs SIMT</h3>
<p><br />
 SIMT  SIMT SIMD  SIMT  SIMT  SIMD <br />
SIMT  SIMD </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p>blckIdx,threadIdx</p>
<p>32  SM  SIMD  SM  32  32 .</p>
<h3 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h3>
<p> CUDA <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_2.png"
                      alt="img" 
                ></p>
<p>SM </p>
<blockquote>
<p></p>
</blockquote>
<p> SM <br />
CUDA <br />
 SM </p>
<h2 id="fermi-"><a class="markdownIt-Anchor" href="#fermi-"></a> Fermi </h2>
<p>Fermi  GPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/fermi.png"
                      alt="img" 
                ></p>
<p>Fermi :</p>
<ol>
<li>512 CUDA </li>
<li> CUDA  ALU FPU</li>
<li>CUDA  16  SM </li>
<li>6  384-bits  GDDR5 </li>
<li> 6G </li>
<li>GigaThread  SM </li>
<li>768KB  SM </li>
</ol>
<p> SM </p>
<ul>
<li>CUDA </li>
<li></li>
<li></li>
</ul>
<p> SM  16 / 16 </p>
<p> SFU SFU <br />
 SM  SM <br />
 16  CUDA  16 / 4  SM  SM <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_4.png"
                      alt="img" 
                ></p>
<p><br />
Fermi  GPU<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_5.png"
                      alt="img" 
                ></p>
<h2 id="kepler-"><a class="markdownIt-Anchor" href="#kepler-"></a> Kepler </h2>
<p>Kepler  Fermi </p>
<ul>
<li> SM</li>
<li></li>
<li>Hyper-Q </li>
</ul>
<p> SM  CUDA SFU LD/ST <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/kepler.png"
                      alt="img" 
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/kepler_2.png"
                      alt="img" 
                ></p>
<p>kepler  GPU <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_8.png"
                      alt="img" 
                ><br />
Hyper-Q  CPU  GPU  CPU  GPU Fermi  CPU  GPU Kepler  Hyper-Q <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_9.png"
                      alt="img" 
                ><br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_10.png"
                      alt="img" 
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_11.png"
                      alt="img" 
                ></p>
<h2 id="-profile-profile-driven-optimization"><a class="markdownIt-Anchor" href="#-profile-profile-driven-optimization"></a>  Profile Profile-Driven Optimization</h2>
<p> profile <br />
</p>
<ol>
<li>()</li>
<li></li>
<li></li>
</ol>
<p><br />
</p>
<ol>
<li></li>
<li></li>
</ol>
<p>Profile </p>
<ul>
<li></li>
<li>CUDA  SM  SM </li>
<li>CUDA </li>
</ul>
<p></p>
<ul>
<li>nvvp</li>
<li>nvprof</li>
</ul>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> CUDA  SM CUDA (SM)<br />
CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><strong> SM </strong> SM  32  SIMT <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_10-1719307302965-79.png"
                      alt="img" 
                ></p>
<p><br />
threadIdx<br />
()blockIdx<br />
<br />
 128  SM  4 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">warp0: thread  <span class="number">0</span>,........thread31</span><br><span class="line">warp1: thread <span class="number">32</span>,........thread63</span><br><span class="line">warp2: thread <span class="number">64</span>,........thread95</span><br><span class="line">warp3: thread <span class="number">96</span>,........thread127</span><br></pre></td></tr></table></figure></div>
<p>x y z  c  c  t (threadIdx.x,threadIdx.y,threadIdx.z)</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t[z][y][x];</span><br></pre></td></tr></table></figure></div>
<p></p>
<p>tid=threadIdx.x+threadIdx.yblockDim.x+threadIdx.zblockDim.xblockDim.y</p>
<blockquote>
<p> c </p>
</blockquote>
<p></p>
<p>WarpsPerBlock=ceil(ThreadsPerBlockwarpSize)</p>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> CUDA  C  ifelse, for ,while CUDA <br />
 CPU  10  1024 CPU  CPU  gpu  GPU  CPU CPU GPU <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (con)&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 32  16  if  16  else <br />
<br />
 if  else  con  if  con <br />
<br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_12.png"
                      alt="img" 
                ><br />
<strong></strong></p>
<blockquote>
<p> if  else </p>
<p> if  if else </p>
</blockquote>
<p> kernel </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">mathKernel1</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> (tid % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> x=64 threadIdx.x  else if<br />
 C</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">mathKernel2</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> ((tid / warpSize) % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> tid  0  31tid/warpSize  0 if <br />
 tid  32  63tid/warpSize  1 else<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">warmup</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((tid / warpSize) % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// printf(&quot;%d %d %f \n&quot;,tid,warpSize,a+b);</span></span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">mathKernel1</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> (tid % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">mathKernel2</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> ((tid / warpSize) % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">mathKernel3</span><span class="params">(<span class="type">float</span> *c)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">float</span> a = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">bool</span> ipred = (tid % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (ipred) &#123;</span><br><span class="line">        a = <span class="number">100.0f</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b = <span class="number">200.0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[tid] = a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    cudaDeviceProp deviceProp;</span><br><span class="line">    <span class="built_in">cudaGetDeviceProperties</span>(&amp;deviceProp, dev);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s using Device %d: %s\n&quot;</span>, argv[<span class="number">0</span>], dev, deviceProp.name);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set up data size</span></span><br><span class="line">    <span class="type">int</span> size = <span class="number">64</span>;</span><br><span class="line">    <span class="type">int</span> blocksize = <span class="number">64</span>;</span><br><span class="line">    <span class="keyword">if</span> (argc &gt; <span class="number">1</span>)</span><br><span class="line">        blocksize = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (argc &gt; <span class="number">2</span>)</span><br><span class="line">        size = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Data size %d &quot;</span>, size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set up execution configuration</span></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(blocksize, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">((size + block.x - <span class="number">1</span>) / block.x, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution Configure (block %d grid %d)\n&quot;</span>, block.x, grid.x);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// allocate gpu memory</span></span><br><span class="line">    <span class="type">float</span> *C_dev;</span><br><span class="line">    <span class="type">size_t</span> nBytes = size * <span class="built_in">sizeof</span>(<span class="type">float</span>);</span><br><span class="line">    <span class="type">float</span> *C_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;C_dev, nBytes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// run a warmup kernel to remove overhead</span></span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    warmup&lt;&lt;&lt;grid, block&gt;&gt;&gt;(C_dev);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;warmup	   &lt;&lt;&lt;%4d,%4d&gt;&gt;&gt;elapsed %lf sec \n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// run kernel 1</span></span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    mathKernel1&lt;&lt;&lt;grid, block&gt;&gt;&gt;(C_dev);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;mathKernel1&lt;&lt;&lt;%4d,%4d&gt;&gt;&gt;elapsed %lf sec \n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(C_host, C_dev, nBytes, cudaMemcpyDeviceToHost);</span><br><span class="line">    <span class="comment">// run kernel 2</span></span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    mathKernel2&lt;&lt;&lt;grid, block&gt;&gt;&gt;(C_dev);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;mathKernel2&lt;&lt;&lt;%4d,%4d&gt;&gt;&gt;elapsed %lf sec \n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// run kernel 3</span></span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    mathKernel3&lt;&lt;&lt;grid, block&gt;&gt;&gt;(C_dev);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;mathKernel3&lt;&lt;&lt;%4d,%4d&gt;&gt;&gt;elapsed %lf sec \n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(C_dev);</span><br><span class="line">    <span class="built_in">free</span>(C_host);</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625121158349.png"
                      alt="image-20240625121158349" 
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625122813904.png"
                      alt="image-20240625122813904" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> event<br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> SM  SM  SM <br />
 SM </p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p> SM <br />
 SM  32 <br />
 SM  SM </p>
<p>SM  kernel <br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_13.png"
                      alt="img" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_14.png"
                      alt="img" 
                ></p>
<p><br />
 SM </p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_2-1719307315559-88.png"
                      alt="img" 
                ></p>
<p><br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p> SM <br />
</p>
<ul>
<li>32  CUDA </li>
<li></li>
</ul>
<p>Kepler  64<br />
 4<br />
<br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
<br />
</p>
<p>GPU </p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
<br />
</p>
<ul>
<li> 10~20 </li>
<li> 400~800 </li>
</ul>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_15.png"
                      alt="img" 
                ><br />
 0 SM <br />
<br />
little </p>
<p>=  </p>
<blockquote>
<p></p>
</blockquote>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_16.png"
                      alt="img" 
                ><br />
 Fermi  Kepler <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_3.png"
                      alt="img" 
                ></p>
<p></p>
<ul>
<li>(ILP): </li>
<li>(TLP): </li>
</ul>
<p></p>
<blockquote>
<p></p>
</blockquote>
<p><br />
 Little  GB/s  C 2070  144 GB/s  144GB/s1.566GHz=92B/t,<br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_4-1719307324404-97.png"
                      alt="img" 
                ></p>
<p> SM  GPU  GPU  SM <br />
Fermi  74  GPU  4  18500  579 <br />
</p>
<p> SM  SM <br />
 32  20  32x20 =640 </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> SM  SM </p>
<p> 64  SM<br />
CUDA  UCDA <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/excel.png"
                      alt="img" 
                ></p>
<p> SM nvcc <br />
</p>
<ul>
<li></li>
<li> SM </li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> pthread openmp <strong></strong><br />
CUDA </p>
<ul>
<li></li>
<li></li>
</ul>
<p><code>__syncthread();</code></p>
<blockquote>
<p></p>
</blockquote>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 1  T  2  1  T/2  CUDA  Nvidia </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_18.png"
                      alt="img" 
                ></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumMatrix2D_CPU</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">float</span> *MatC, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> *a = MatA;</span><br><span class="line">    <span class="type">float</span> *b = MatB;</span><br><span class="line">    <span class="type">float</span> *c = MatC;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; ny; j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nx; i++) &#123;</span><br><span class="line">            c[i] = a[i] + b[i];</span><br><span class="line">        &#125;</span><br><span class="line">        c += nx;</span><br><span class="line">        b += nx;</span><br><span class="line">        a += nx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumMatrix</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">float</span> *MatC, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx = ix + iy * ny;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatC[idx] = MatA[idx] + MatB[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">initDevice</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> nx = <span class="number">1</span> &lt;&lt; <span class="number">13</span>;</span><br><span class="line">    <span class="type">int</span> ny = <span class="number">1</span> &lt;&lt; <span class="number">13</span>;</span><br><span class="line">    <span class="type">int</span> nxy = nx * ny;</span><br><span class="line">    <span class="type">int</span> nBytes = nxy * <span class="built_in">sizeof</span>(<span class="type">float</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Malloc</span></span><br><span class="line">    <span class="type">float</span> *A_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *B_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *C_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *C_from_gpu = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="built_in">initialData</span>(A_host, nxy);</span><br><span class="line">    <span class="built_in">initialData</span>(B_host, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cudaMalloc</span></span><br><span class="line">    <span class="type">float</span> *A_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">float</span> *B_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">float</span> *C_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;A_dev, nBytes));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;B_dev, nBytes));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;C_dev, nBytes));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(A_dev, A_host, nBytes, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(B_dev, B_host, nBytes, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> dimx = argc &gt; <span class="number">2</span> ? <span class="built_in">atoi</span>(argv[<span class="number">1</span>]) : <span class="number">32</span>;</span><br><span class="line">    <span class="type">int</span> dimy = argc &gt; <span class="number">2</span> ? <span class="built_in">atoi</span>(argv[<span class="number">2</span>]) : <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    <span class="comment">// cpu compute</span></span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    <span class="built_in">sumMatrix2D_CPU</span>(A_host, B_host, C_host, nx, ny);</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CPU Execution Time elapsed %f sec\n&quot;</span>, iElaps);</span><br><span class="line">    <span class="comment">// warm up</span></span><br><span class="line">    <span class="comment">//  2d block and 2d grid</span></span><br><span class="line">    <span class="function">dim3 <span class="title">block_0</span><span class="params">(<span class="number">32</span>, <span class="number">32</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid_0</span><span class="params">((nx - <span class="number">1</span>) / block_0.x + <span class="number">1</span>, (ny - <span class="number">1</span>) / block_0.y + <span class="number">1</span>)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumMatrix&lt;&lt;&lt;grid_0, block_0&gt;&gt;&gt;(A_dev, B_dev, C_dev, nx, ny);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Warm Up \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2d block and 2d grid</span></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(dimx, dimy)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">((nx - <span class="number">1</span>) / block.x + <span class="number">1</span>, (ny - <span class="number">1</span>) / block.y + <span class="number">1</span>)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumMatrix&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, C_dev, nx, ny);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;GPU Execution configuration&lt;&lt;&lt;(%d,%d),(%d,%d)&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>,</span><br><span class="line">           grid.x, grid.y, block.x, block.y, iElaps);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(C_from_gpu, C_dev, nBytes, cudaMemcpyDeviceToHost));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(C_host, C_from_gpu, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(A_dev);</span><br><span class="line">    <span class="built_in">cudaFree</span>(B_dev);</span><br><span class="line">    <span class="built_in">cudaFree</span>(C_dev);</span><br><span class="line">    <span class="built_in">free</span>(A_host);</span><br><span class="line">    <span class="built_in">free</span>(B_host);</span><br><span class="line">    <span class="built_in">free</span>(C_host);</span><br><span class="line">    <span class="built_in">free</span>(C_from_gpu);</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 81928192 <br />
 GPU  21321322=228   256M 768M  GPU  2G </p>
<h2 id="-nvprof-"><a class="markdownIt-Anchor" href="#-nvprof-"></a>  nvprof </h2>
<p> x  y  x  y ,</p>
<table>
<thead>
<tr>
<th style="text-align:center">gridDim</th>
<th style="text-align:center">blockDim</th>
<th style="text-align:center">time(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">256,256</td>
<td style="text-align:center">32,32</td>
<td style="text-align:center">0.008304</td>
</tr>
<tr>
<td style="text-align:center">256,512</td>
<td style="text-align:center">32,16</td>
<td style="text-align:center">0.008332</td>
</tr>
<tr>
<td style="text-align:center">512,256</td>
<td style="text-align:center">16,32</td>
<td style="text-align:center">0.008341</td>
</tr>
<tr>
<td style="text-align:center">512,512</td>
<td style="text-align:center">16,16</td>
<td style="text-align:center">0.008347</td>
</tr>
<tr>
<td style="text-align:center">512,1024</td>
<td style="text-align:center">16,8</td>
<td style="text-align:center">0.008351</td>
</tr>
<tr>
<td style="text-align:center">1024512</td>
<td style="text-align:center">8,16</td>
<td style="text-align:center">0.008401</td>
</tr>
</tbody>
</table>
<blockquote>
<p>CHECK</p>
</blockquote>
<p></p>
<blockquote>
<p> sm </p>
</blockquote>
<h2 id="-nvprof-"><a class="markdownIt-Anchor" href="#-nvprof-"></a>  nvprof </h2>
<p> nvprof <br />
:</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvprof --metrics gld_throughput ./simple_sum_matrix</span><br></pre></td></tr></table></figure></div>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center">gridDim</th>
<th style="text-align:center">blockDim</th>
<th style="text-align:center">time(s)</th>
<th style="text-align:center">Achieved Occupancy</th>
<th style="text-align:center">GLD Throughput (GB/s)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">256,256</td>
<td style="text-align:center">32,32</td>
<td style="text-align:center">0.008304</td>
<td style="text-align:center">0.813609</td>
<td style="text-align:center">60.270</td>
</tr>
<tr>
<td style="text-align:center">256,512</td>
<td style="text-align:center">32,16</td>
<td style="text-align:center">0.008332</td>
<td style="text-align:center">0.841264</td>
<td style="text-align:center">60.042</td>
</tr>
<tr>
<td style="text-align:center">512,256</td>
<td style="text-align:center">16,32</td>
<td style="text-align:center">0.008341</td>
<td style="text-align:center">0.855385</td>
<td style="text-align:center">59.996</td>
</tr>
<tr>
<td style="text-align:center">512,512</td>
<td style="text-align:center">16,16</td>
<td style="text-align:center">0.008347</td>
<td style="text-align:center">0.876081</td>
<td style="text-align:center">59.967</td>
</tr>
<tr>
<td style="text-align:center">512,1024</td>
<td style="text-align:center">16,8</td>
<td style="text-align:center">0.008351</td>
<td style="text-align:center">0.875807</td>
<td style="text-align:center">59.976</td>
</tr>
<tr>
<td style="text-align:center">1024512</td>
<td style="text-align:center">8,16</td>
<td style="text-align:center">0.008401</td>
<td style="text-align:center">0.857242</td>
<td style="text-align:center">59.440</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvprof --metrics gld_efficiency ./simple_sum_matrix</span><br></pre></td></tr></table></figure></div>
<p> 100%  CUDA  M2070   CUDA </p>
<p>blockDim.x<br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> blockDim.x </p>
<table>
<thead>
<tr>
<th style="text-align:center">gridDim</th>
<th style="text-align:center">blockDim</th>
<th style="text-align:center">time(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(128,4096)</td>
<td style="text-align:center">(64,2)</td>
<td style="text-align:center">0.008391</td>
</tr>
<tr>
<td style="text-align:center">(128,2048)</td>
<td style="text-align:center">(64,4)</td>
<td style="text-align:center">0.008411</td>
</tr>
<tr>
<td style="text-align:center">(128,1024)</td>
<td style="text-align:center">(64,8)</td>
<td style="text-align:center">0.008405</td>
</tr>
<tr>
<td style="text-align:center">(64,4096)</td>
<td style="text-align:center">(128,2)</td>
<td style="text-align:center">0.008454</td>
</tr>
<tr>
<td style="text-align:center">(64,2048)</td>
<td style="text-align:center">(128,4)</td>
<td style="text-align:center">0.008430</td>
</tr>
<tr>
<td style="text-align:center">(64,1024)</td>
<td style="text-align:center">(128,8)</td>
<td style="text-align:center">0.008418</td>
</tr>
<tr>
<td style="text-align:center">(32,4096)</td>
<td style="text-align:center">(256,2)</td>
<td style="text-align:center">0.008468</td>
</tr>
<tr>
<td style="text-align:center">(32,2048)</td>
<td style="text-align:center">(256,4)</td>
<td style="text-align:center">0.008439</td>
</tr>
<tr>
<td style="text-align:center">(32,1024)</td>
<td style="text-align:center">(256,8)</td>
<td style="text-align:center">fail</td>
</tr>
</tbody>
</table>
<p></p>
<ul>
<li>644  1282 </li>
<li></li>
<li></li>
</ul>
<p>:</p>
<table>
<thead>
<tr>
<th style="text-align:center">gridDim</th>
<th style="text-align:center">blockDim</th>
<th style="text-align:center">time(s)</th>
<th style="text-align:center">Achieved Occupancy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(128,4096)</td>
<td style="text-align:center">(64,2)</td>
<td style="text-align:center">0.008391</td>
<td style="text-align:center">0.888596</td>
</tr>
<tr>
<td style="text-align:center">(128,2048)</td>
<td style="text-align:center">(64,4)</td>
<td style="text-align:center">0.008411</td>
<td style="text-align:center">0.866298</td>
</tr>
<tr>
<td style="text-align:center">(128,1024)</td>
<td style="text-align:center">(64,8)</td>
<td style="text-align:center">0.008405</td>
<td style="text-align:center">0.831536</td>
</tr>
<tr>
<td style="text-align:center">(64,4096)</td>
<td style="text-align:center">(128,2)</td>
<td style="text-align:center">0.008454</td>
<td style="text-align:center">0.893161</td>
</tr>
<tr>
<td style="text-align:center">(64,2048)</td>
<td style="text-align:center">(128,4)</td>
<td style="text-align:center">0.008430</td>
<td style="text-align:center">0.862629</td>
</tr>
<tr>
<td style="text-align:center">(64,1024)</td>
<td style="text-align:center">(128,8)</td>
<td style="text-align:center">0.008418</td>
<td style="text-align:center">0.833540</td>
</tr>
<tr>
<td style="text-align:center">(32,4096)</td>
<td style="text-align:center">(256,2)</td>
<td style="text-align:center">0.008468</td>
<td style="text-align:center">0.859110</td>
</tr>
<tr>
<td style="text-align:center">(32,2048)</td>
<td style="text-align:center">(256,4)</td>
<td style="text-align:center">0.008439</td>
<td style="text-align:center">0.825036</td>
</tr>
<tr>
<td style="text-align:center">(32,1024)</td>
<td style="text-align:center">(256,8)</td>
<td style="text-align:center">fail</td>
<td style="text-align:center">Nan</td>
</tr>
</tbody>
</table>
<blockquote>
<p></p>
</blockquote>
<h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p><br />
<br />
</p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
<br />
<strong> cpu </strong></p>
<p><br />
</p>
<ol>
<li><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/xianglin.png"
                      alt="img" 
                ></li>
<li><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/jiaocuo.png"
                      alt="img" 
                ></li>
</ol>
<p><br />
 cpu </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">recursiveReduce</span><span class="params">(<span class="type">int</span> *data, <span class="type">int</span> <span class="type">const</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// terminate check</span></span><br><span class="line">    <span class="keyword">if</span> (size == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> data[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// renew the stride</span></span><br><span class="line">    <span class="type">int</span> <span class="type">const</span> stride = size / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (size % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; stride; i++) &#123;</span><br><span class="line">            data[i] += data[i + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        data[<span class="number">0</span>] += data[size - <span class="number">1</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; stride; i++) &#123;</span><br><span class="line">            data[i] += data[i + stride];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// call</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">recursiveReduce</span>(data, stride);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> if  for </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceNeighbored</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x;</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> stride = <span class="number">1</span>; stride &lt; blockDim.x; stride *= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((tid % (<span class="number">2</span> * stride)) == <span class="number">0</span>) &#123;</span><br><span class="line">            idata[tid] += idata[tid + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// synchronize within block</span></span><br><span class="line">        __syncthreads();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__syncthreads();</span><br></pre></td></tr></table></figure></div>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((tid % (<span class="number">2</span> * stride)) == <span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_21.png"
                      alt="img" 
                ></p>
<p><br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_23.png"
                      alt="img" 
                ><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceNeighboredLess</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> idx = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="comment">// convert global data pointer to the local point of this block</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x;</span><br><span class="line">    <span class="keyword">if</span> (idx &gt; n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> stride = <span class="number">1</span>; stride &lt; blockDim.x; stride *= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// convert tid into local array index</span></span><br><span class="line">        <span class="type">int</span> index = <span class="number">2</span> * stride * tid;</span><br><span class="line">        <span class="keyword">if</span> (index &lt; blockDim.x) &#123;</span><br><span class="line">            idata[index] += idata[index + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        __syncthreads();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write result for this block to global men</span></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> index = <span class="number">2</span> * stride * tid;</span><br></pre></td></tr></table></figure></div>
<p> index  tid <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625141733203.png"
                      alt="image-20240625141733203" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_24.png"
                      alt="img" 
                ><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceInterleaved</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> idx = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="comment">// convert global data pointer to the local point of this block</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x;</span><br><span class="line">    <span class="keyword">if</span> (idx &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> stride = blockDim.x / <span class="number">2</span>; stride &gt; <span class="number">0</span>; stride &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tid &lt; stride) &#123;</span><br><span class="line">            idata[tid] += idata[tid + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        __syncthreads();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write result for this block to global men</span></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>reduceInterleaved  reduceInterleaved </p>
</blockquote>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p>GPU GPU  if  for <br />
 for </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;tid;i++)&#123;&#125;</span><br></pre></td></tr></table></figure></div>
<p> tid  32 32  for </p>
<blockquote>
<p></p>
</blockquote>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">    a[i]=b[i]+c[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> c++</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i+=<span class="number">4</span>)&#123;</span><br><span class="line">    a[i+<span class="number">0</span>]=b[i+<span class="number">0</span>]+c[i+<span class="number">0</span>];</span><br><span class="line">    a[i+<span class="number">1</span>]=b[i+<span class="number">1</span>]+c[i+<span class="number">1</span>];</span><br><span class="line">    a[i+<span class="number">2</span>]=b[i+<span class="number">2</span>]+c[i+<span class="number">2</span>];</span><br><span class="line">    a[i+<span class="number">3</span>]=b[i+<span class="number">3</span>]+c[i+<span class="number">3</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<blockquote>
<p><strong> CUDA </strong></p>
</blockquote>
<p> CUDA </p>
<ol>
<li>
<p></p>
</li>
<li>
<p></p>
</li>
</ol>
<p> CUDA <br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> reduceInterleaved </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceUnroll2</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x * <span class="number">2</span> + threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (idx + blockDim.x &lt; n) &#123;</span><br><span class="line">        g_idata[idx] += g_idata[idx + blockDim.x];</span><br><span class="line">    &#125;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> stride = blockDim.x / <span class="number">2</span>; stride &gt; <span class="number">0</span>; stride &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tid &lt; stride) &#123;</span><br><span class="line">            idata[tid] += idata[tid + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// synchronize within block</span></span><br><span class="line">        __syncthreads();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 2 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1719307351089-114.png"
                      alt="img" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(idx+blockDim.x&lt;n)&#123;</span><br><span class="line">    g_idata[idx]+=g_idata[idx+blockDim.x];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// kernel 1:reduceUnrolling2</span></span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(idata_dev, idata_host, bytes, cudaMemcpyHostToDevice));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">reduceUnroll2&lt;&lt;&lt;grid.x / <span class="number">2</span>, block&gt;&gt;&gt;(idata_dev, odata_dev, size);</span><br><span class="line"><span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line"><span class="built_in">cudaMemcpy</span>(odata_host, odata_dev, grid.x * <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyDeviceToHost);</span><br><span class="line">gpu_sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; grid.x / <span class="number">2</span>; i++)</span><br><span class="line">    gpu_sum += odata_host[i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;reduceUnrolling2            elapsed %lf ms gpu_sum: %d&lt;&lt;&lt;grid %d block %d&gt;&gt;&gt;\n&quot;</span>,</span><br><span class="line">       iElaps, gpu_sum, grid.x / <span class="number">2</span>, block.x);</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625142712784.png"
                      alt="image-20240625142712784" 
                ><br />
 248  2 4  8 </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 32  64  64  32 16 1  6 6432168421 6 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceUnrollWarp8</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x * <span class="number">8</span> + threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x * <span class="number">8</span>;</span><br><span class="line">    <span class="comment">// unrolling 8;</span></span><br><span class="line">    <span class="keyword">if</span> (idx + <span class="number">7</span> * blockDim.x &lt; n) &#123;</span><br><span class="line">        <span class="type">int</span> a1 = g_idata[idx];</span><br><span class="line">        <span class="type">int</span> a2 = g_idata[idx + blockDim.x];</span><br><span class="line">        <span class="type">int</span> a3 = g_idata[idx + <span class="number">2</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a4 = g_idata[idx + <span class="number">3</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a5 = g_idata[idx + <span class="number">4</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a6 = g_idata[idx + <span class="number">5</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a7 = g_idata[idx + <span class="number">6</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a8 = g_idata[idx + <span class="number">7</span> * blockDim.x];</span><br><span class="line">        g_idata[idx] = a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8;</span><br><span class="line">    &#125;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> stride = blockDim.x / <span class="number">2</span>; stride &gt; <span class="number">32</span>; stride &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tid &lt; stride) &#123;</span><br><span class="line">            idata[tid] += idata[tid + stride];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// synchronize within block</span></span><br><span class="line">        __syncthreads();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid &lt; <span class="number">32</span>) &#123;</span><br><span class="line">        <span class="keyword">volatile</span> <span class="type">int</span> *vmem = idata;</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">32</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">16</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">8</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">4</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">2</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> unrolling8  tid  [0,32] </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">volatile</span> <span class="type">int</span> *vmem = idata;</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">32</span>];</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">16</span>];</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">8</span>];</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">4</span>];</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">2</span>];</span><br><span class="line">vmem[tid] += vmem[tid + <span class="number">1</span>];</span><br></pre></td></tr></table></figure></div>
<p> volatile int  64  32  32 32  tid  64  32 <br />
 32  16  16  16  tid&lt;32  tid 16  31  17  33  17  1  17  CUDA  17  1  33  17  17  1  32  tid <br />
 tid[0]<br />
</p>
<p>volatile int </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vmem[tid]+=vmem[tid+<span class="number">32</span>];</span><br><span class="line">vmem[tid]+=vmem[tid+<span class="number">16</span>];</span><br></pre></td></tr></table></figure></div>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 64  128 256 512 1024 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceCompleteUnrollWarp8</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x * <span class="number">8</span> + threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x * <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> (idx + <span class="number">7</span> * blockDim.x &lt; n) &#123;</span><br><span class="line">        <span class="type">int</span> a1 = g_idata[idx];</span><br><span class="line">        <span class="type">int</span> a2 = g_idata[idx + blockDim.x];</span><br><span class="line">        <span class="type">int</span> a3 = g_idata[idx + <span class="number">2</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a4 = g_idata[idx + <span class="number">3</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a5 = g_idata[idx + <span class="number">4</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a6 = g_idata[idx + <span class="number">5</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a7 = g_idata[idx + <span class="number">6</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a8 = g_idata[idx + <span class="number">7</span> * blockDim.x];</span><br><span class="line">        g_idata[idx] = a1 + a2 + a3 + a4 + a5 + a6 + a7 + a8;</span><br><span class="line">    &#125;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">1024</span> &amp;&amp; tid &lt; <span class="number">512</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">512</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">512</span> &amp;&amp; tid &lt; <span class="number">256</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">256</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">256</span> &amp;&amp; tid &lt; <span class="number">128</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">128</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">128</span> &amp;&amp; tid &lt; <span class="number">64</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">64</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid &lt; <span class="number">32</span>) &#123;</span><br><span class="line">        <span class="keyword">volatile</span> <span class="type">int</span> *vmem = idata;</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">32</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">16</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">8</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">4</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">2</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> tid  32  tid  32 </p>
<h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">1024</span> &amp;&amp; tid &lt; <span class="number">512</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">512</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">512</span> &amp;&amp; tid &lt; <span class="number">256</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">256</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">256</span> &amp;&amp; tid &lt; <span class="number">128</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">128</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">128</span> &amp;&amp; tid &lt; <span class="number">64</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">64</span>];</span><br><span class="line">__syncthreads();</span><br></pre></td></tr></table></figure></div>
<p> blockDim.x blockDim.x </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.010491</td>
<td style="text-align:center">25.01%</td>
<td style="text-align:center">25.00%</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.005968</td>
<td style="text-align:center">25.01%</td>
<td style="text-align:center">25.00%</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.004956</td>
<td style="text-align:center">98.04%</td>
<td style="text-align:center">97.71%</td>
</tr>
<tr>
<td style="text-align:center"> 8</td>
<td style="text-align:center">0.001294</td>
<td style="text-align:center">99.60%</td>
<td style="text-align:center">99.71%</td>
</tr>
<tr>
<td style="text-align:center"> 8+</td>
<td style="text-align:center">0.001009</td>
<td style="text-align:center">99.71%</td>
<td style="text-align:center">99.68%</td>
</tr>
<tr>
<td style="text-align:center"> 8++</td>
<td style="text-align:center">0.001001</td>
<td style="text-align:center">99.71%</td>
<td style="text-align:center">99.68%</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.001008</td>
<td style="text-align:center">99.71%</td>
<td style="text-align:center">99.68%</td>
</tr>
</tbody>
</table>
<p></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p><br />
<br />
 GPU </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
 cpu  GPU</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/3_26.png"
                      alt="img" 
                ></p>
<p></p>
<blockquote>
<p>-&gt; -&gt;-&gt; </p>
</blockquote>
<p><br />
<br />
<br />
 cudaMemcpy  cpu  gpu <br />
</p>
<ol>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
<h2 id="-gpu--hello-world"><a class="markdownIt-Anchor" href="#-gpu--hello-world"></a>  GPU  Hello World</h2>
<p> Hello World </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">nesthelloworld</span><span class="params">(<span class="type">int</span> iSize, <span class="type">int</span> iDepth)</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;depth : %d blockIdx: %d,threadIdx: %d\n&quot;</span>, iDepth, blockIdx.x, threadIdx.x);</span><br><span class="line">    <span class="keyword">if</span> (iSize == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> nthread = (iSize &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span> &amp;&amp; nthread &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        nesthelloworld&lt;&lt;&lt;<span class="number">1</span>, nthread&gt;&gt;&gt;(nthread, ++iDepth);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;-----------&gt; nested execution depth: %d\n&quot;</span>, iDepth);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> size = <span class="number">64</span>;</span><br><span class="line">    <span class="type">int</span> block_x = <span class="number">2</span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(block_x, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">((size - <span class="number">1</span>) / block.x + <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    nesthelloworld&lt;&lt;&lt;grid, block&gt;&gt;&gt;(size, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> cmake  makefile</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -arch=sm_35  nested_Hello_World.cu -o nested_Hello_World -lcudadevrt --relocatable-device-code true</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>-lcudadevrt relocatable-device-code true relocatable-device-code </p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625144327320.png"
                      alt="image-20240625144327320" 
                ></p>
<p></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p>CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p><br />
<br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-3.png"
                      alt="img" 
                ></p>
<p> cpu  CPU <br />
<br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p>CPU  GPU  DRAM SRAM<br />
GPU  CPU CUDA </p>
<h2 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h2>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
CPU <br />
CUDA  CPU GPU </p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p>CUDA </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-5.png"
                      alt="img" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> CPU  GPU  CPU  GPU  CPU <br />
<br />
 SM Fermi  63 Kepler  255 SM <br />
<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__global__ <span class="type">void</span></span><br><span class="line">__lauch_bounds__(maxThreadaPerBlock,minBlocksPerMultiprocessor)</span><br><span class="line"><span class="built_in">kernel</span>(...) &#123;&#125;</span><br></pre></td></tr></table></figure></div>
<p>  <strong>lauch_bounds</strong></p>
<ol>
<li>
<p>maxThreadaPerBlock</p>
</li>
<li>
<p>minBlocksPerMultiprocessor SM </p>
<p></p>
<p></p>
</li>
</ol>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-maxrregcount=32</span><br></pre></td></tr></table></figure></div>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p> 2.0  SM </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__share__</span><br></pre></td></tr></table></figure></div>
<p> SM </p>
<blockquote>
<p> SM  SM </p>
</blockquote>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __syncthreads();</span><br></pre></td></tr></table></figure></div>
<p></p>
<blockquote>
<p>__syncthreads();</p>
</blockquote>
<p>SM  64k </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaFuncSetCacheConfig</span><span class="params">(<span class="type">const</span> <span class="type">void</span> * func,<span class="keyword">enum</span> cudaFuncCache)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>cudaFuncCache </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cudaFuncCachePreferNone<span class="comment">//</span></span><br><span class="line">cudaFuncCachePreferShared<span class="comment">//48k16k</span></span><br><span class="line">cudaFuncCachePreferL1<span class="comment">// 48k16k</span></span><br><span class="line">cudaFuncCachePreferEqual<span class="comment">// 32k32k</span></span><br></pre></td></tr></table></figure></div>
<p>Fermi </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> SM <code>__constant__</code> 64k <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpyToSymbol</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* dst,<span class="type">const</span> <span class="type">void</span> *src,<span class="type">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> cudaMemcpy  src  count  dst <br />
</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> SM <br />
 GPU </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>GPU global <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__device__</span><br></pre></td></tr></table></figure></div>
<p> GPU <br />
<br />
3264128/</p>
<ol>
<li></li>
<li></li>
</ol>
<p>1.1 </p>
<h3 id="gpu-"><a class="markdownIt-Anchor" href="#gpu-"></a> GPU </h3>
<p> CPU GPU GPU  4 </p>
<ol>
<li></li>
<li></li>
<li></li>
<li></li>
</ol>
<p> SM  SM FermiKepler CUDA <br />
 CPU CPU  GPU <br />
 SM </p>
<h3 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h3>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">float var</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">float var[100]</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>share</strong></td>
<td style="text-align:center">float var*</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>device</strong></td>
<td style="text-align:center">float var*</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">__constant</td>
<td style="text-align:center">float var*</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">/</th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">n/a</td>
<td style="text-align:center">R/W</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">1.0 </td>
<td style="text-align:center">R/W</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">n/a</td>
<td style="text-align:center">R/W</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">1.0 </td>
<td style="text-align:center">R/W</td>
<td style="text-align:center">+</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Yes</td>
<td style="text-align:center">R</td>
<td style="text-align:center">+</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Yes</td>
<td style="text-align:center">R</td>
<td style="text-align:center">+</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CPU  newmalloc  delete  free  CUDA  cudaMalloc  copy :</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">__device__ <span class="type">float</span> devData;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">checkGlobalVariable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Device: The value of the global variable is %f\n&quot;</span>, devData);</span><br><span class="line">    devData += <span class="number">2.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> value = <span class="number">3.14f</span>;</span><br><span class="line">    <span class="built_in">cudaMemcpyToSymbol</span>(devData, &amp;value, <span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Host: copy %f to the global variable\n&quot;</span>, value);</span><br><span class="line">    checkGlobalVariable&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1</span>&gt;&gt;&gt;();</span><br><span class="line">    <span class="built_in">cudaMemcpyFromSymbol</span>(&amp;value, devData, <span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Host: the value changed by the kernel to %f \n&quot;</span>, value);</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625150614484.png"
                      alt="image-20240625150614484" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaMemcpyToSymbol</span>(devData,&amp;value,<span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br></pre></td></tr></table></figure></div>
<p> void*<code>__device__ float devData;</code></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaMemcpyFromSymbol</span>(&amp;value,devData,<span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br></pre></td></tr></table></figure></div>
<p></p>
<ol>
<li>
<p>devData </p>
</li>
<li>
<p>devData </p>
<p> CUDA  CPU </p>
</li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaMemcpy</span>(&amp;value,devData,<span class="built_in">sizeof</span>(<span class="type">float</span>));</span><br></pre></td></tr></table></figure></div>
<p> copy <br />
 cudaMemcpy</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> *dptr=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">cudaGetSymbolAddress</span>((<span class="type">void</span>**)&amp;dptr,devData);</span><br><span class="line"><span class="built_in">cudaMemcpy</span>(dptr,&amp;value,<span class="built_in">sizeof</span>(<span class="type">float</span>),cudaMemcpyHostToDevice);</span><br></pre></td></tr></table></figure></div>
<p><br />
 devData </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> *dptr=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">cudaGetSymbolAddress</span>((<span class="type">void</span>**)&amp;dptr,devData);</span><br></pre></td></tr></table></figure></div>
<p> GPU CUDA <br />
CUDA  API  API</p>
<h1 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h1>
<p>CUDA  C pythonphp c CUDA  C  C  CUDA  GPU  CPU CPU GPU <br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p>CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMalloc</span><span class="params">(<span class="type">void</span> ** devPtr,<span class="type">size_t</span> count)</span></span></span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> * devMem=<span class="literal">NULL</span>;</span><br><span class="line"><span class="function">cudaError_t <span class="title">cudaMalloc</span><span class="params">((<span class="type">float</span>**) devMem, count)</span></span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>devMem  NULL</p>
</blockquote>
<p>cudaMalloc  devMem  devMem  NULL<br />
<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemset</span><span class="params">(<span class="type">void</span> * devPtr,<span class="type">int</span> value,<span class="type">size_t</span> count)</span></span></span><br></pre></td></tr></table></figure></div>
<p> Memset  GPU <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaFree</span><span class="params">(<span class="type">void</span> * devPtr)</span></span></span><br></pre></td></tr></table></figure></div>
<p> cudaMalloc  cudaErrorInvalidDevicePointer  C </p>
<blockquote>
<p>:</p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> C C </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpy</span><span class="params">(<span class="type">void</span> *dst,<span class="type">const</span> <span class="type">void</span> * src,<span class="type">size_t</span> count,<span class="keyword">enum</span> cudaMemcpyKind kind)</span></span></span><br></pre></td></tr></table></figure></div>
<p> dst  src </p>
<ul>
<li>cudaMemcpyHostToHost</li>
<li>cudaMemcpyHostToDevice</li>
<li>cudaMemcpyDeviceToHost</li>
<li>cudaMemcpyDeviceToDevice</li>
</ul>
<p> host  host<br />
<br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-3.png"
                      alt="4-3" 
                ><br />
GPU  DDR5 2011  DDR4  GPU  DDR5GPU  Fermi C2050  144GB/s GPU CPU  GPU  PCIe 8GB/s  PCIe </p>
<blockquote>
<p>CUDA </p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>CUDA <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4.png"
                      alt="4-4" 
                ><br />
--<br />
<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMallocHost</span><span class="params">(<span class="type">void</span> ** devPtr,<span class="type">size_t</span> count)</span></span></span><br></pre></td></tr></table></figure></div>
<p> count ,<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaFreeHost</span><span class="params">(<span class="type">void</span> *ptr)</span></span></span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">const</span> <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i += <span class="number">4</span>) &#123;</span><br><span class="line">        res[i] = a[i] + b[i];</span><br><span class="line">        res[i + <span class="number">1</span>] = a[i + <span class="number">1</span>] + b[i + <span class="number">1</span>];</span><br><span class="line">        res[i + <span class="number">2</span>] = a[i + <span class="number">2</span>] + b[i + <span class="number">2</span>];</span><br><span class="line">        res[i + <span class="number">3</span>] = a[i + <span class="number">3</span>] + b[i + <span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    res[i] = a[i] + b[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> nElem = <span class="number">1</span> &lt;&lt; <span class="number">14</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>, nElem);</span><br><span class="line">    <span class="type">int</span> nByte = <span class="built_in">sizeof</span>(<span class="type">float</span>) * nElem;</span><br><span class="line">    <span class="type">float</span> *a_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *b_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_from_gpu_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_h, <span class="number">0</span>, nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h, <span class="number">0</span>, nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d, *b_d, *res_d;</span><br><span class="line">    <span class="comment">// pine memory malloc</span></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocHost</span>((<span class="type">float</span> **)&amp;a_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocHost</span>((<span class="type">float</span> **)&amp;b_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocHost</span>((<span class="type">float</span> **)&amp;res_d, nByte));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">initialData</span>(a_h, nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(a_d, a_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(b_d, b_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1024</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">(nElem / block.x)</span></span>;</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt;\n&quot;</span>, grid.x, block.x);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(res_from_gpu_h, res_d, nByte, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">sumArrays</span>(a_h, b_h, res_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(res_h, res_from_gpu_h, nElem);</span><br><span class="line">    <span class="built_in">cudaFreeHost</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFreeHost</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFreeHost</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(a_h);</span><br><span class="line">    <span class="built_in">free</span>(b_h);</span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line">    <span class="built_in">free</span>(res_from_gpu_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
GPU CUDA </p>
<ul>
<li></li>
<li></li>
<li> PCIe </li>
</ul>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaHostAlloc</span><span class="params">(<span class="type">void</span> ** pHost,<span class="type">size_t</span> count,<span class="type">unsigned</span> <span class="type">int</span> flags)</span></span></span><br></pre></td></tr></table></figure></div>
<p></p>
<ul>
<li>
<p>cudaHostAllocDefalt</p>
</li>
<li>
<p>cudaHostAllocPortable</p>
</li>
<li>
<p>cudaHostAllocWriteCombined</p>
</li>
<li>
<p>cudaHostAllocMapped</p>
<p>cudaHostAllocDefalt  cudaMallocHost cudaHostAllocPortable  CUDA cudaHostAllocWriteCombined cudaHostAllocMapped </p>
<blockquote>
<p> pHost </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaHostGetDevicePointer</span><span class="params">(<span class="type">void</span> ** pDevice,<span class="type">void</span> * pHost,<span class="type">unsigned</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
</blockquote>
</li>
</ul>
<p>pDevice  flag  0<br />
 PCIe<br />
</p>
<table>
<thead>
<tr>
<th style="text-align:center"> n( 2n )</th>
<th style="text-align:center">us</th>
<th style="text-align:center">us</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">2.5</td>
<td style="text-align:center">3.0</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">3.0</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">7.8</td>
<td style="text-align:center">8.6</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">23.1</td>
<td style="text-align:center">25.8</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center">86.5</td>
<td style="text-align:center">98.2</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">290.9</td>
<td style="text-align:center">310.5</td>
</tr>
</tbody>
</table>
<p> nvprof </p>
<table>
<thead>
<tr>
<th style="text-align:center"> n( 2n )</th>
<th style="text-align:center">us</th>
<th style="text-align:center">us</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">1.088</td>
<td style="text-align:center">4.257</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">1.056</td>
<td style="text-align:center">8.00</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">1920</td>
<td style="text-align:center">24.578</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">4.544</td>
<td style="text-align:center">86.63</td>
</tr>
</tbody>
</table>
<p></p>
<p> CPU  GPU  PCIe </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 2.0 Nvida UVA<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-5.png"
                      alt="4-5" 
                ></p>
<p>UVA  UVA  UVAcudaHostAlloc <br />
</p>
<ul>
<li></li>
<li> CUDA </li>
<li></li>
</ul>
<p> UVA</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaHostGetDevicePointer</span><span class="params">(<span class="type">void</span> ** pDevice,<span class="type">void</span> * pHost,<span class="type">unsigned</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>UVA <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> *a_host, *b_host, *res_d;</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaHostAlloc</span>((<span class="type">float</span> **)&amp;a_host, nByte, cudaHostAllocMapped));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaHostAlloc</span>((<span class="type">float</span> **)&amp;b_host, nByte, cudaHostAllocMapped));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;res_d, nByte));</span><br><span class="line">res_from_gpu_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line"></span><br><span class="line"><span class="built_in">initialData</span>(a_host, nElem);</span><br><span class="line"><span class="built_in">initialData</span>(b_host, nElem);</span><br><span class="line"></span><br><span class="line"><span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1024</span>)</span></span>;</span><br><span class="line"><span class="function">dim3 <span class="title">grid</span><span class="params">(nElem / block.x)</span></span>;</span><br><span class="line">sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_host, b_host, res_d);</span><br></pre></td></tr></table></figure></div>
<p>UVA UVA </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625151756403.png"
                      alt="image-20240625151756403" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>Nvidia CUDA6.0 CPU GPU  CPU  GPU <br />
 UVA <br />
<br />
</p>
<blockquote>
<p> <strong>managed</strong> </p>
</blockquote>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMallocManaged</span><span class="params">(<span class="type">void</span> ** devPtr,<span class="type">size_t</span> size,<span class="type">unsigned</span> <span class="type">int</span> flags=<span class="number">0</span>)</span></span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>CUDA6.0  cudaMallocManaged</p>
</blockquote>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> GPU <br />
CUDA CUDA </p>
<blockquote>
<p></p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1.png"
                      alt="1-1" 
                ><br />
 DRAM <br />
L1  SM  L1 L2  SM  L1 <br />
DRAM)</p>
<ul>
<li>128 </li>
<li>32 </li>
</ul>
<p> 128  32  32  128 </p>
<ul>
<li></li>
<li></li>
</ul>
<p> CPU  CUDA  DRAM  128  32 <br />
 CUDA  SM  SM SM  SM  31  32  32 <br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
32  128  32  64128  256 <br />
<br />
</p>
<ul>
<li> 128  128 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-6.png"
                      alt="4-6" 
                ><br />
</li>
<li>
<ol>
<li> 1~128 0~127  128~255  SM</li>
<li> 0~63  128~191 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-8.png"
                      alt="4-8" 
                ><br />
thread0  128  256  128/1283/128  128  1  1/128</li>
</ol>
</li>
</ul>
<blockquote>
<p></p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>SM </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
<br />
</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Xptxas -dlcm=cg</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Xptxas -dlcm=ca</span><br></pre></td></tr></table></figure></div>
<p> DRAM <br />
 32  3264  128  128  32  64 </p>
<blockquote>
<p> SM  DRAM Kepler  K10,K20</p>
</blockquote>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p></p>
<ul>
<li></li>
<li> 32  32  128 </li>
<li></li>
</ul>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ol>
<li> 100%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-9.png"
                      alt="4-9" 
                ></li>
<li> 100%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-10.png"
                      alt="4-10" 
                ></li>
<li>32  4  128 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-11.png"
                      alt="4-11" 
                ></li>
<li> 4  4128=3.125%4128=3.125%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-12.png"
                      alt="4-12" 
                ></li>
<li> N  1N32 32  4  N  1N<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-13.png"
                      alt="4-13" 
                ></li>
</ol>
<p>CPU  GPU GPU CPU  CPU GPU </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
 32  500ml  250ml 400ml . 200ml  5<br />
</p>
<ol>
<li> 128  4  100%100%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-14.png"
                      alt="4-14" 
                ></li>
<li> 128  100%100%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-15.png"
                      alt="4-15" 
                ></li>
<li> 32  128  45=80%45=80% , 5 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-16.png"
                      alt="4-16" 
                ></li>
<li> 4  432=12.5%432=12.5%<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-17.png"
                      alt="4-17" 
                ></li>
<li> N   N128  N32  N  128128  3232  N <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-18.png"
                      alt="4-18" 
                ></li>
</ol>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> offset, <span class="type">const</span> <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, k = offset; k &lt; size; i++, k++) &#123;</span><br><span class="line">        res[i] = a[k] + b[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> offset, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// int i=threadIdx.x;</span></span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="type">int</span> k = i + offset;</span><br><span class="line">    <span class="keyword">if</span> (k &lt; n)</span><br><span class="line">        res[i] = a[k] + b[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line">    <span class="type">int</span> nElem = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line">    <span class="type">int</span> offset = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (argc &gt;= <span class="number">2</span>)</span><br><span class="line">        offset = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>, nElem);</span><br><span class="line">    <span class="type">int</span> nByte = <span class="built_in">sizeof</span>(<span class="type">float</span>) * nElem;</span><br><span class="line">    <span class="type">float</span> *a_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *b_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_from_gpu_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_h, <span class="number">0</span>, nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h, <span class="number">0</span>, nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d, *b_d, *res_d;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;a_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;b_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;res_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemset</span>(res_d, <span class="number">0</span>, nByte));</span><br><span class="line">    <span class="built_in">initialData</span>(a_h, nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(a_d, a_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(b_d, b_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1024</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">(nElem / block.x)</span></span>;</span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, offset, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(res_from_gpu_h, res_d, nByte, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec --offset:%d \n&quot;</span>, grid.x, block.x, iElaps, offset);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sumArrays</span>(a_h, b_h, res_h, offset, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(res_h, res_from_gpu_h, nElem);</span><br><span class="line">    <span class="built_in">cudaFree</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(a_h);</span><br><span class="line">    <span class="built_in">free</span>(b_h);</span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line">    <span class="built_in">free</span>(res_from_gpu_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -O3 -arch=sm_35 -Xptxas -dlcm=cg -I ../include/ sum_array_offset.cu -o sum_array_offset</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625152945418.png"
                      alt="image-20240625152945418" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -O3 -arch=sm_35 -Xptxas -dlcm=ca -I ../include/ sum_array_offset.cu -o sum_array_offset</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625153206249.png"
                      alt="image-20240625153206249" 
                ></p>
<p></p>
<p>=/</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> 3.5  3.5 <br />
 32 <br />
</p>
<ol>
<li> _ldg</li>
<li></li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">copyKernel</span><span class="params">(<span class="type">float</span> * in,<span class="type">float</span>* out)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> idx=blockDim*blockIdx.x+threadIdx.x;</span><br><span class="line">    out[idx]=__ldg(&amp;in[idx]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> Fermi  Kepler GPU  32  128  64 <br />
</p>
<ol>
<li>
<p> 128  4 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-19.png"
                      alt="4-19" 
                ></p>
</li>
<li>
<p> 192  3 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-20.png"
                      alt="4-20" 
                ></p>
</li>
<li>
<p> 64 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-21.png"
                      alt="4-21" 
                ></p>
</li>
</ol>
<blockquote>
<p></p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> C <br />
AoSSoA<br />
AoS</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> a[N];</span><br></pre></td></tr></table></figure></div>
<p>SoA</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="type">int</span> a[N];</span><br><span class="line">    <span class="type">int</span> b[N]</span><br><span class="line">&#125;a;</span><br></pre></td></tr></table></figure></div>
<p>CUDA SoA  AoS <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-22.png"
                      alt="4-22" 
                ><br />
 AoS  50%<br />
 AoS  SoA </p>
<ul>
<li> SIMD SoA CUDA  SoA </li>
</ul>
<h3 id="aos-"><a class="markdownIt-Anchor" href="#aos-"></a> AoS </h3>
<p> AoS </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">naiveStruct</span> &#123;</span><br><span class="line">    <span class="type">float</span> a;</span><br><span class="line">    <span class="type">float</span> b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">const</span> <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        res[i] = a[i] + b[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="keyword">struct</span> naiveStruct *res, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// int i=threadIdx.x;</span></span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; n)</span><br><span class="line">        res[i].a = a[i] + b[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checkResult_struct</span><span class="params">(<span class="type">float</span> *res_h, <span class="keyword">struct</span> naiveStruct *res_from_gpu_h, <span class="type">int</span> nElem)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nElem; i++)</span><br><span class="line">        <span class="keyword">if</span> (res_h[i] != res_from_gpu_h[i].a) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;check fail!\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;result check success!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> nElem = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line">    <span class="type">int</span> offset = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (argc &gt;= <span class="number">2</span>)</span><br><span class="line">        offset = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>, nElem);</span><br><span class="line">    <span class="type">int</span> nByte = <span class="built_in">sizeof</span>(<span class="type">float</span>) * nElem;</span><br><span class="line">    <span class="type">int</span> nByte_struct = <span class="built_in">sizeof</span>(<span class="keyword">struct</span> naiveStruct) * nElem;</span><br><span class="line">    <span class="type">float</span> *a_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *b_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte_struct);</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">naiveStruct</span> *res_from_gpu_h = (<span class="keyword">struct</span> naiveStruct *)<span class="built_in">malloc</span>(nByte_struct);</span><br><span class="line">    <span class="built_in">memset</span>(res_h, <span class="number">0</span>, nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h, <span class="number">0</span>, nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d, *b_d;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">naiveStruct</span> *res_d;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;a_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;b_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="keyword">struct</span> naiveStruct **)&amp;res_d, nByte_struct));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemset</span>(res_d, <span class="number">0</span>, nByte_struct));</span><br><span class="line">    <span class="built_in">initialData</span>(a_h, nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(a_d, a_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(b_d, b_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1024</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">(nElem / block.x)</span></span>;</span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(res_from_gpu_h, res_d, nByte_struct, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sumArrays</span>(a_h, b_h, res_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult_struct</span>(res_h, res_from_gpu_h, nElem);</span><br><span class="line">    <span class="built_in">cudaFree</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(a_h);</span><br><span class="line">    <span class="built_in">free</span>(b_h);</span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line">    <span class="built_in">free</span>(res_from_gpu_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625153824815.png"
                      alt="image-20240625153824815" 
                ></p>
<h3 id="soa-"><a class="markdownIt-Anchor" href="#soa-"></a> SoA </h3>
<p> SoA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> offset, <span class="type">const</span> <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, k = offset; k &lt; size; i++, k++) &#123;</span><br><span class="line">        res[i] = a[k] + b[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> offset, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// int i=threadIdx.x;</span></span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x * <span class="number">4</span> + threadIdx.x;</span><br><span class="line">    <span class="type">int</span> k = i + offset;</span><br><span class="line">    <span class="keyword">if</span> (k + <span class="number">3</span> * blockDim.x &lt; n) &#123;</span><br><span class="line">        res[i] = a[k] + b[k];</span><br><span class="line">        res[i + blockDim.x] = a[k + blockDim.x] + b[k + blockDim.x];</span><br><span class="line">        res[i + blockDim.x * <span class="number">2</span>] = a[k + blockDim.x * <span class="number">2</span>] + b[k + blockDim.x * <span class="number">2</span>];</span><br><span class="line">        res[i + blockDim.x * <span class="number">3</span>] = a[k + blockDim.x * <span class="number">3</span>] + b[k + blockDim.x * <span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line">    <span class="type">int</span> block_x = <span class="number">512</span>;</span><br><span class="line">    <span class="type">int</span> nElem = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line">    <span class="type">int</span> offset = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (argc == <span class="number">2</span>)</span><br><span class="line">        offset = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (argc == <span class="number">3</span>) &#123;</span><br><span class="line">        offset = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">        block_x = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>, nElem);</span><br><span class="line">    <span class="type">int</span> nByte = <span class="built_in">sizeof</span>(<span class="type">float</span>) * nElem;</span><br><span class="line">    <span class="type">float</span> *a_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *b_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_from_gpu_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_h, <span class="number">0</span>, nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h, <span class="number">0</span>, nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d, *b_d, *res_d;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;a_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;b_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span> **)&amp;res_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemset</span>(res_d, <span class="number">0</span>, nByte));</span><br><span class="line">    <span class="built_in">initialData</span>(a_h, nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(a_d, a_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(b_d, b_h, nByte, cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(block_x)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">(nElem / block.x)</span></span>;</span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, offset, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;warmup Time elapsed %f sec\n&quot;</span>, iElaps);</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, offset, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(res_from_gpu_h, res_d, nByte, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec --offset:%d \n&quot;</span>, grid.x, block.x, iElaps, offset);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sumArrays</span>(a_h, b_h, res_h, offset, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(res_h, res_from_gpu_h, nElem - <span class="number">4</span> * block_x);</span><br><span class="line">    <span class="built_in">cudaFree</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(a_h);</span><br><span class="line">    <span class="built_in">free</span>(b_h);</span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line">    <span class="built_in">free</span>(res_from_gpu_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625153855669.png"
                      alt="image-20240625153855669" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<ol>
<li></li>
<li> SM </li>
</ol>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> * a,<span class="type">float</span> * b,<span class="type">float</span> * res,<span class="type">int</span> offset,<span class="type">const</span> <span class="type">int</span> size)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,k=offset;k&lt;size;i++,k++) &#123;</span><br><span class="line">        res[i]=a[k]+b[k];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span>*a,<span class="type">float</span>*b,<span class="type">float</span>*res,<span class="type">int</span> offset,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="comment">//int i=threadIdx.x;</span></span><br><span class="line">    <span class="type">int</span> i=blockIdx.x*blockDim.x*<span class="number">4</span>+threadIdx.x;</span><br><span class="line">    <span class="type">int</span> k=i+offset;</span><br><span class="line">    <span class="keyword">if</span>(k+<span class="number">3</span>*blockDim.x&lt;n)&#123;</span><br><span class="line">        res[i]=a[k]+b[k];</span><br><span class="line">        res[i+blockDim.x]=a[k+blockDim.x]+b[k+blockDim.x];</span><br><span class="line">        res[i+blockDim.x*<span class="number">2</span>]=a[k+blockDim.x*<span class="number">2</span>]+b[k+blockDim.x*<span class="number">2</span>];</span><br><span class="line">        res[i+blockDim.x*<span class="number">3</span>]=a[k+blockDim.x*<span class="number">3</span>]+b[k+blockDim.x*<span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> **argv)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> dev = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(dev);</span><br><span class="line">    <span class="type">int</span> block_x=<span class="number">512</span>;</span><br><span class="line">    <span class="type">int</span> nElem=<span class="number">1</span>&lt;&lt;<span class="number">18</span>;</span><br><span class="line">    <span class="type">int</span> offset=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(argc==<span class="number">2</span>)</span><br><span class="line">        offset=<span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(argc==<span class="number">3</span>) &#123;</span><br><span class="line">        offset=<span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">        block_x=<span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>,nElem);</span><br><span class="line">    <span class="type">int</span> nByte=<span class="built_in">sizeof</span>(<span class="type">float</span>)*nElem;</span><br><span class="line">    <span class="type">float</span> *a_h=(<span class="type">float</span>*)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *b_h=(<span class="type">float</span>*)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_h=(<span class="type">float</span>*)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="type">float</span> *res_from_gpu_h=(<span class="type">float</span>*)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_h,<span class="number">0</span>,nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h,<span class="number">0</span>,nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d,*b_d,*res_d;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span>**)&amp;a_d,nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span>**)&amp;b_d,nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">float</span>**)&amp;res_d,nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemset</span>(res_d,<span class="number">0</span>,nByte));</span><br><span class="line">    <span class="built_in">initialData</span>(a_h,nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_h,nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(a_d,a_h,nByte,cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(b_d,b_h,nByte,cudaMemcpyHostToDevice));</span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(block_x)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">(nElem/block.x)</span></span>;</span><br><span class="line">    <span class="type">double</span> iStart,iElaps;</span><br><span class="line">    iStart=<span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(a_d,b_d,res_d,offset,nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps=<span class="built_in">cpuSecond</span>()-iStart;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;warmup Time elapsed %f sec\n&quot;</span>,iElaps);</span><br><span class="line">    iStart=<span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(a_d,b_d,res_d,offset,nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps=<span class="built_in">cpuSecond</span>()-iStart;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(res_from_gpu_h,res_d,nByte,cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec --offset:%d \n&quot;</span>,grid.x,block.x,iElaps,offset);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">sumArrays</span>(a_h,b_h,res_h,offset,nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(res_h,res_from_gpu_h,nElem<span class="number">-4</span>*block_x);</span><br><span class="line">    <span class="built_in">cudaFree</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(a_h);</span><br><span class="line">    <span class="built_in">free</span>(b_h);</span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line">    <span class="built_in">free</span>(res_from_gpu_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625154213625.png"
                      alt="image-20240625154213625" 
                ></p>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h3>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625154336659.png"
                      alt="image-20240625154336659" 
                ></p>
<p>offset=11 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625154459118.png"
                      alt="image-20240625154459118" 
                ></p>
<p>512 </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> SM <br />
 SM <br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p> ECC  Fermi M2090  117.6 GB/s</p>
<p>(gflops)<br />
 GB/s <br />
</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><strong></strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-1.png"
                      alt="4-4-1" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">transformMatrix2D_CPU</span><span class="params">(<span class="type">float</span> * MatA,<span class="type">float</span> * MatB,<span class="type">int</span> nx,<span class="type">int</span> ny)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;ny;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nx;i++) &#123;</span><br><span class="line">            MatB[i*nx+j]=MatA[j*nx+i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-2.png"
                      alt="4-4-2" 
                ></p>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
<br />
<br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-3.png"
                      alt="4-4-3" 
                ></p>
<p><br />
 CPU  128  128  k </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> 10 9.8 10  9.9 <br />
</p>
<ul>
<li>()</li>
<li>()</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">copyRow</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx = ix + iy * nx;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx] = MatA[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">copyCol</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx] = MatA[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625155914202.png"
                      alt="image-20240625155914202" 
                ></p>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"> 1</th>
<th style="text-align:center"> 2</th>
<th style="text-align:center"> 3</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.001611</td>
<td style="text-align:center">0.001614</td>
<td style="text-align:center">0.001606</td>
<td style="text-align:center">0.001610</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">0.004191</td>
<td style="text-align:center">0.004210</td>
<td style="text-align:center">0.004205</td>
<td style="text-align:center">0.004202</td>
</tr>
</tbody>
</table>
<p> 0.001610s 0.004202s</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;starting...\n&quot;</span>);</span><br><span class="line">    <span class="built_in">initDevice</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> nx = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> ny = <span class="number">1</span> &lt;&lt; <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> nxy = nx * ny;</span><br><span class="line">    <span class="type">int</span> nBytes = nxy * <span class="built_in">sizeof</span>(<span class="type">float</span>);</span><br><span class="line">    <span class="type">int</span> transform_kernel = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (argc &gt;= <span class="number">2</span>)</span><br><span class="line">        transform_kernel = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="comment">// Malloc</span></span><br><span class="line">    <span class="type">float</span> *A_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="type">float</span> *B_host = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nBytes);</span><br><span class="line">    <span class="built_in">initialData</span>(A_host, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cudaMalloc</span></span><br><span class="line">    <span class="type">float</span> *A_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">float</span> *B_dev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;A_dev, nBytes));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;B_dev, nBytes));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(A_dev, A_host, nBytes, cudaMemcpyHostToDevice));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemset</span>(B_dev, <span class="number">0</span>, nBytes));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> dimx = <span class="number">32</span>;</span><br><span class="line">    <span class="type">int</span> dimy = <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cpu compute</span></span><br><span class="line">    <span class="type">double</span> iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    <span class="built_in">transformMatrix2D_CPU</span>(A_host, B_host, nx, ny);</span><br><span class="line">    <span class="type">double</span> iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CPU Execution Time elapsed %f sec\n&quot;</span>, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2d block and 2d grid</span></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(dimx, dimy)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">((nx - <span class="number">1</span>) / block.x + <span class="number">1</span>, (ny - <span class="number">1</span>) / block.y + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">block_1</span><span class="params">(dimx, dimy)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid_1</span><span class="params">((nx - <span class="number">1</span>) / (block_1.x * <span class="number">4</span>) + <span class="number">1</span>, (ny - <span class="number">1</span>) / block_1.y + <span class="number">1</span>)</span></span>;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    <span class="keyword">switch</span> (transform_kernel) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        copyRow&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        copyCol&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        transformNaiveRow&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        transformNaiveCol&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        transformNaiveColUnroll&lt;&lt;&lt;grid_1, block_1&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        transformNaiveColUnroll&lt;&lt;&lt;grid_1, block_1&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        transformNaiveRowDiagonal&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        transformNaiveColDiagonal&lt;&lt;&lt;grid, block&gt;&gt;&gt;(A_dev, B_dev, nx, ny);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot; Time elapsed %f sec\n&quot;</span>, iElaps);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(B_host, B_dev, nBytes, cudaMemcpyDeviceToHost));</span><br><span class="line">    <span class="built_in">checkResult</span>(B_host, B_host, nxy);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(A_dev);</span><br><span class="line">    <span class="built_in">cudaFree</span>(B_dev);</span><br><span class="line">    <span class="built_in">free</span>(A_host);</span><br><span class="line">    <span class="built_in">free</span>(B_host);</span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>switch </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> naive </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveRow</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_col] = MatA[idx_row];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveCol</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_row] = MatA[idx_col];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"> 1</th>
<th style="text-align:center"> 2</th>
<th style="text-align:center"> 3</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">transformNaiveRow</td>
<td style="text-align:center">0.004008</td>
<td style="text-align:center">0.004005</td>
<td style="text-align:center">0.004012</td>
<td style="text-align:center">0.004008</td>
</tr>
<tr>
<td style="text-align:center">transformNaiveCol</td>
<td style="text-align:center">0.002126</td>
<td style="text-align:center">0.002118</td>
<td style="text-align:center">0.002124</td>
<td style="text-align:center">0.002123</td>
</tr>
</tbody>
</table>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">copyRow</td>
<td style="text-align:center">81.263</td>
<td style="text-align:center">40.631</td>
</tr>
<tr>
<td style="text-align:center">copyCol</td>
<td style="text-align:center">120.93</td>
<td style="text-align:center">120.93</td>
</tr>
<tr>
<td style="text-align:center">transformNaiveRow</td>
<td style="text-align:center">31.717</td>
<td style="text-align:center">126.87</td>
</tr>
<tr>
<td style="text-align:center">transformNaiveCol</td>
<td style="text-align:center">243.64</td>
<td style="text-align:center">30.454</td>
</tr>
</tbody>
</table>
<p> SM  SM </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveRowUnroll</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x * <span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_col] = MatA[idx_row];</span><br><span class="line">        MatB[idx_col + ny * <span class="number">1</span> * blockDim.x] = MatA[idx_row + <span class="number">1</span> * blockDim.x];</span><br><span class="line">        MatB[idx_col + ny * <span class="number">2</span> * blockDim.x] = MatA[idx_row + <span class="number">2</span> * blockDim.x];</span><br><span class="line">        MatB[idx_col + ny * <span class="number">3</span> * blockDim.x] = MatA[idx_row + <span class="number">3</span> * blockDim.x];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveColUnroll</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * blockIdx.x * <span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_row] = MatA[idx_col];</span><br><span class="line">        MatB[idx_row + <span class="number">1</span> * blockDim.x] = MatA[idx_col + ny * <span class="number">1</span> * blockDim.x];</span><br><span class="line">        MatB[idx_row + <span class="number">2</span> * blockDim.x] = MatA[idx_col + ny * <span class="number">2</span> * blockDim.x];</span><br><span class="line">        MatB[idx_row + <span class="number">3</span> * blockDim.x] = MatA[idx_col + ny * <span class="number">3</span> * blockDim.x];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"> 1</th>
<th style="text-align:center"> 2</th>
<th style="text-align:center"> 3</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">transformNaiveRowUnroll</td>
<td style="text-align:center">0.001544</td>
<td style="text-align:center">0.001550</td>
<td style="text-align:center">001541</td>
<td style="text-align:center">0.001545</td>
</tr>
<tr>
<td style="text-align:center">transformNaiveColUnroll</td>
<td style="text-align:center">0.001545</td>
<td style="text-align:center">0.001539</td>
<td style="text-align:center">0.001546</td>
<td style="text-align:center">0.001543</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> DRAM  DRAM  DRAM DRAM  256  ID 123 <br />
 DRAM  DRAM <br />
 f(x,y)=(m,n)</p>
<blockquote>
<p> ID </p>
</blockquote>
<p> ID<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-10.png"
                      alt="4-4-10" 
                ></p>
<p> ID</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-11.png"
                      alt="4-4-11" 
                ></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveRowDiagonal</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> block_y = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> block_x = (blockIdx.x + blockIdx.y) % gridDim.x;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * block_x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * block_y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_col] = MatA[idx_row];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveColDiagonal</span><span class="params">(<span class="type">float</span> *MatA, <span class="type">float</span> *MatB, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> block_y = blockIdx.x;</span><br><span class="line">    <span class="type">int</span> block_x = (blockIdx.x + blockIdx.y) % gridDim.x;</span><br><span class="line">    <span class="type">int</span> ix = threadIdx.x + blockDim.x * block_x;</span><br><span class="line">    <span class="type">int</span> iy = threadIdx.y + blockDim.y * block_y;</span><br><span class="line">    <span class="type">int</span> idx_row = ix + iy * nx;</span><br><span class="line">    <span class="type">int</span> idx_col = ix * ny + iy;</span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        MatB[idx_row] = MatA[idx_col];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> naive  CUDA  DRAM </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> naive </p>
<table>
<thead>
<tr>
<th style="text-align:center">block </th>
<th style="text-align:center"> 1</th>
<th style="text-align:center"> 2</th>
<th style="text-align:center"> 3</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(32,32)</td>
<td style="text-align:center">0.002166</td>
<td style="text-align:center">0.002122</td>
<td style="text-align:center">0.002125</td>
<td style="text-align:center">0.002138</td>
</tr>
<tr>
<td style="text-align:center">(32,16)</td>
<td style="text-align:center">0.001677</td>
<td style="text-align:center">0.001696</td>
<td style="text-align:center">0.001703</td>
<td style="text-align:center">0.001692</td>
</tr>
<tr>
<td style="text-align:center">(32,8)</td>
<td style="text-align:center">0.001925</td>
<td style="text-align:center">0.001929</td>
<td style="text-align:center">0.001925</td>
<td style="text-align:center">0.001926</td>
</tr>
<tr>
<td style="text-align:center">(64,16)</td>
<td style="text-align:center">0.002117</td>
<td style="text-align:center">0.002146</td>
<td style="text-align:center">0.002113</td>
<td style="text-align:center">0.002125</td>
</tr>
<tr>
<td style="text-align:center">(64,8)</td>
<td style="text-align:center">0.001949</td>
<td style="text-align:center">0.001945</td>
<td style="text-align:center">0.001945</td>
<td style="text-align:center">0.001946</td>
</tr>
<tr>
<td style="text-align:center">(128,8)</td>
<td style="text-align:center">0.002228</td>
<td style="text-align:center">0.002230</td>
<td style="text-align:center">0.002229</td>
<td style="text-align:center">0.002229</td>
</tr>
</tbody>
</table>
<p>3216</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/4-4-13.png"
                      alt="4-4-13" 
                ></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span>**)&amp;a_d,nByte));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span>**)&amp;b_d,nByte));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span>**)&amp;res_d,nByte));</span><br></pre></td></tr></table></figure></div>
<p> cudaMallocManaged  copy  copy  memcopy </p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;freshman.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cuda_runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sumArrays</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">const</span> <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i += <span class="number">4</span>) &#123;</span><br><span class="line">        res[i] = a[i] + b[i];</span><br><span class="line">        res[i + <span class="number">1</span>] = a[i + <span class="number">1</span>] + b[i + <span class="number">1</span>];</span><br><span class="line">        res[i + <span class="number">2</span>] = a[i + <span class="number">2</span>] + b[i + <span class="number">2</span>];</span><br><span class="line">        res[i + <span class="number">3</span>] = a[i + <span class="number">3</span>] + b[i + <span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span> *a, <span class="type">float</span> *b, <span class="type">float</span> *res, <span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; N)</span><br><span class="line">        res[i] = a[i] + b[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set up device</span></span><br><span class="line">    <span class="built_in">initDevice</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> nElem = <span class="number">1</span> &lt;&lt; <span class="number">24</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector size:%d\n&quot;</span>, nElem);</span><br><span class="line">    <span class="type">int</span> nByte = <span class="built_in">sizeof</span>(<span class="type">float</span>) * nElem;</span><br><span class="line">    <span class="type">float</span> *res_h = (<span class="type">float</span> *)<span class="built_in">malloc</span>(nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_h, <span class="number">0</span>, nByte);</span><br><span class="line">    <span class="built_in">memset</span>(res_from_gpu_h, <span class="number">0</span>, nByte);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> *a_d, *b_d, *res_d;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span> **)&amp;a_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span> **)&amp;b_d, nByte));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMallocManaged</span>((<span class="type">float</span> **)&amp;res_d, nByte));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">initialData</span>(a_d, nElem);</span><br><span class="line">    <span class="built_in">initialData</span>(b_d, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CHECK(cudaMemcpy(a_d,a_h,nByte,cudaMemcpyHostToDevice));</span></span><br><span class="line">    <span class="comment">// CHECK(cudaMemcpy(b_d,b_h,nByte,cudaMemcpyHostToDevice));</span></span><br><span class="line"></span><br><span class="line">    <span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">512</span>)</span></span>;</span><br><span class="line">    <span class="function">dim3 <span class="title">grid</span><span class="params">((nElem - <span class="number">1</span>) / block.x + <span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> iStart, iElaps;</span><br><span class="line">    iStart = <span class="built_in">cpuSecond</span>();</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d, b_d, res_d, nElem);</span><br><span class="line">    <span class="built_in">cudaDeviceSynchronize</span>();</span><br><span class="line">    iElaps = <span class="built_in">cpuSecond</span>() - iStart;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Execution configuration&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>, grid.x, block.x, iElaps);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CHECK(cudaMemcpy(res_from_gpu_h,res_d,nByte,cudaMemcpyDeviceToHost));</span></span><br><span class="line">    <span class="built_in">sumArrays</span>(b_d, b_d, res_h, nElem);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">checkResult</span>(res_h, res_d, nElem);</span><br><span class="line">    <span class="built_in">cudaFree</span>(a_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(b_d);</span><br><span class="line">    <span class="built_in">cudaFree</span>(res_d);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(res_h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625160848025.png"
                      alt="image-20240625160848025" 
                ><br />
</p>
<blockquote>
<p> GPU  CPU  GPU  CPU  CPU </p>
</blockquote>
<p></p>
<blockquote>
<p></p>
</blockquote>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p> GPU </p>
<h1 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h1>
<p><br />
 CUDA <br />
GPU </p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
</p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2>
<p>shared memorySMEM GPU  SM  SM <br />
<br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-1.png"
                      alt="5-1" 
                ></p>
<p>SM L1 ReadOnly Constant  Dram  SM  SMEML1ReadOnlyConstant SMEM  L1  L2  20~30  10 <br />
</p>
<blockquote>
<p></p>
</blockquote>
<p></p>
<ol>
<li></li>
<li> 32  32 </li>
<li> 32 </li>
</ol>
<blockquote>
<p> SM </p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>CUDA  123 <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__shared__</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__shared__ <span class="type">float</span> a[size_x][size_y];</span><br></pre></td></tr></table></figure></div>
<p> size_x,size_y  c++<br />
 extern <br />
:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel&lt;&lt;&lt;grid,block,<span class="function">isize*<span class="title">sizeof</span><span class="params">(<span class="type">int</span>)</span>&gt;&gt;&gt;<span class="params">(...)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>isize </p>
<blockquote>
<p></p>
</blockquote>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
 32 32  32 <br />
</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
 3 </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
<br />
</p>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-2.png"
                      alt="5-2" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-3.png"
                      alt="5-3" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-4.png"
                      alt="5-4" 
                ><br />
</p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ol>
<li>2.x  4 32 </li>
<li>3.x  8 64 <br />
= 4 %</li>
</ol>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-5.png"
                      alt="5-5" 
                ></p>
<p><br />
 4  8 <br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-6.png"
                      alt="5-6" 
                ></p>
<p> 64  bank </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-7.png"
                      alt="5-7" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-8.png"
                      alt="5-8" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-9.png"
                      alt="5-9" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-10.png"
                      alt="5-10" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
 4  32 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-11.png"
                      alt="5-11" 
                ></p>
<p> bank0  5 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__shared__ <span class="type">int</span> a[<span class="number">5</span>][<span class="number">4</span>];</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__shared__ <span class="type">int</span> a[<span class="number">5</span>][<span class="number">5</span>];</span><br></pre></td></tr></table></figure></div>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-11-1.png"
                      alt="5-11-1" 
                ><br />
 4  5 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-12.png"
                      alt="5-12" 
                ></p>
<p></p>
<blockquote>
<p></p>
</blockquote>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> 4  8 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceGetSharedMemConfig</span><span class="params">(cudaSharedMemConfig * pConfig)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> pConfig </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cudaSharedMemBankSizeFourByte</span><br><span class="line">cudaSharedMemBankSizeEightByte</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceSetShareMemConfig</span><span class="params">(cudaSharedMemConfig config)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> config </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cudaSharedMemBankSizeDefault</span><br><span class="line">cudaSharedMemBankSizeFourByte</span><br><span class="line">cudaSharedMemBankSizeEightByte</span><br></pre></td></tr></table></figure></div>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> SM  64KB  L1  64KBCUDA </p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceSetCacheConfig</span><span class="params">(cudaFuncCache cacheConfig)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cudaFuncCachePreferNone: <span class="function">no <span class="title">preference</span><span class="params">(<span class="keyword">default</span>)</span></span></span><br><span class="line"><span class="function">cudaFuncCachePreferShared: prefer <span class="number">48</span>KB shared memory and <span class="number">16</span> KB L1 cache</span></span><br><span class="line"><span class="function">cudaFuncCachePreferL1: prefer <span class="number">48</span>KB L1 cache and <span class="number">16</span> KB shared memory</span></span><br><span class="line"><span class="function">cudaFuncCachePreferEqual: prefer <span class="number">32</span>KB L1 cache and <span class="number">32</span> KB shared memory</span></span><br></pre></td></tr></table></figure></div>
<p></p>
<ol>
<li></li>
<li>L1 </li>
</ol>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaFuncSetCacheConfig</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* func,<span class="keyword">enum</span> cudaFuncCacheca cheConfig)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> func  L1 <br />
 L1  L1 </p>
<blockquote>
<p>GPU  CPU GPU  GPU  SM </p>
</blockquote>
<h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p><br />
</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CUDA </p>
<p>GPU  SMEM</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __syncthreads();</span><br></pre></td></tr></table></figure></div>
<ol>
<li>
<p>__syncthreads()</p>
</li>
<li>
<p></p>
</li>
<li>
<p></p>
</li>
<li>
<p></p>
</li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (threadID % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    __syncthreads();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    __syncthreads();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ol start="5">
<li></li>
</ol>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ol>
<li></li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __threadfence_block();</span><br></pre></td></tr></table></figure></div>
<p></p>
<ol>
<li></li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __threadfence();</span><br></pre></td></tr></table></figure></div>
<p></p>
<ol>
<li></li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __threadfence_system();</span><br></pre></td></tr></table></figure></div>
<p></p>
<h3 id="volatile-"><a class="markdownIt-Anchor" href="#volatile-"></a> Volatile </h3>
<p>volatile  volatile </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p>,<br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> threadIdx.x, threadIdx.y  threadIdx.z</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> N 32</span></span><br><span class="line">...</span><br><span class="line">__shared__ <span class="type">int</span> x[N][N];</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>
<p> x </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> N 32</span></span><br><span class="line">...</span><br><span class="line">__shared__ <span class="type">int</span> x[N][N];</span><br><span class="line">...</span><br><span class="line"><span class="type">int</span> a=x[threadIdx.y][threadIdx.x];</span><br></pre></td></tr></table></figure></div>
<p> (y,x)  (x,y)<br />
 CPU  x CPU  GPU <br />
 threadIdx.x  threadIdx.y <br />
 y  threadIdx.x  threadIdx.y  x CUDA  x  threadIdx.x <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[threadIdx.y][threadIdx.x];</span><br></pre></td></tr></table></figure></div>
<p>threadIdx.x </p>
<p> CUDA </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/5-12-1719307513385-201.png"
                      alt="5-12" 
                ></p>
<p> int  1024  A  int  (32,32)  threadIdx.y=0,threadIdx.x=031,<code>A[threadIdx.x][threadIdx.y];</code><br />
<code>A[threadIdx.y][threadIdx.x];</code></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BDIMX 32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BDIMY 32</span></span><br></pre></td></tr></table></figure></div>
<p></p>
<ul>
<li></li>
<li></li>
</ul>
<p> 24_shared_memory_read_data <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadRow</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY][BDIMX];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line"></span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[threadIdx.y][threadIdx.x];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li> 32323232</li>
<li> idx</li>
<li> idx  tile[threadIdx.y][threadIdx.x]</li>
<li></li>
<li> tile[threadIdx.y][threadIdx.x] idx </li>
</ul>
<p></p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setColReadCol</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY][BDIMX];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line"></span><br><span class="line">    tile[threadIdx.x][threadIdx.y]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[threadIdx.x][threadIdx.y];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 1.552s  2.4640s  cpu  cpu </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out[idx]=tile[threadIdx.x][threadIdx.y];</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tile[threadIdx.y][threadIdx.x]=idx;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625163553913.png"
                      alt="image-20240625163553913" 
                ></p>
<p> load 32 </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> malloc  C++CUDA <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColDyn</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    <span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> row_idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> col_idx=threadIdx.x*blockDim.y+threadIdx.y;</span><br><span class="line">    tile[row_idx]=row_idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[row_idx]=tile[col_idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> extern </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br></pre></td></tr></table></figure></div>
<p> int </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setRowReadColDyn&lt;&lt;&lt;grid,block,(BDIMX)*<span class="function">BDIMY*<span class="title">sizeof</span><span class="params">(<span class="type">int</span>)</span>&gt;&gt;&gt;<span class="params">(out)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625163643634.png"
                      alt="image-20240625163643634" 
                ></p>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> CUDA   32  32 4-Byte/8-Byte <br />
<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColIpad</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY][BDIMX+IPAD];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line"></span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[threadIdx.x][threadIdx.y];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColDynIpad</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    <span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> row_idx=threadIdx.y*(blockDim.x+<span class="number">1</span>)+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> col_idx=threadIdx.x*(blockDim.x+<span class="number">1</span>)+threadIdx.y;</span><br><span class="line">    tile[row_idx]=row_idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[row_idx]=tile[col_idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setRowReadColDynIpad&lt;&lt;&lt;grid,block,(BDIMX+IPAD)*<span class="function">BDIMY*<span class="title">sizeof</span><span class="params">(<span class="type">int</span>)</span>&gt;&gt;&gt;<span class="params">(out)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/re-1-8.png"
                      alt="re-1-8" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> row_idx=threadIdx.y*(blockDim.x+<span class="number">1</span>)+threadIdx.x;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> col_idx=threadIdx.x*(blockDim.x+<span class="number">1</span>)+threadIdx.y;</span><br></pre></td></tr></table></figure></div>
<p> threadIdx.x*(blockDim.x+1)+threadIdx.y</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>,</p>
<table>
<thead>
<tr>
<th style="text-align:center">Type</th>
<th style="text-align:center">Time(%)</th>
<th style="text-align:center">Time</th>
<th style="text-align:center">Calls</th>
<th style="text-align:center">Avg</th>
<th style="text-align:center">Min</th>
<th style="text-align:center">Max</th>
<th style="text-align:center">Name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GPU activities:</td>
<td style="text-align:center">16.12%</td>
<td style="text-align:center">2.5600 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2.5600 s</td>
<td style="text-align:center">2.5600 s</td>
<td style="text-align:center">2.5600 s</td>
<td style="text-align:center">setColReadCol(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">13.30%</td>
<td style="text-align:center">2.1120 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2.1120 s</td>
<td style="text-align:center">2.1120 s</td>
<td style="text-align:center">2.1120 s</td>
<td style="text-align:center">warmup(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">12.90%</td>
<td style="text-align:center">2.0480 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2.0480 s</td>
<td style="text-align:center">2.0480 s</td>
<td style="text-align:center">2.0480 s</td>
<td style="text-align:center">setRowReadCol(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">12.70%</td>
<td style="text-align:center">2.0170 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2.0170 s</td>
<td style="text-align:center">2.0170 s</td>
<td style="text-align:center">2.0170 s</td>
<td style="text-align:center">setRowReadColDyn(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">12.70%</td>
<td style="text-align:center">2.0160 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2.0160 s</td>
<td style="text-align:center">2.0160 s</td>
<td style="text-align:center">2.0160 s</td>
<td style="text-align:center">setColReadRow(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">9.27%</td>
<td style="text-align:center">1.4720 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.4720 s</td>
<td style="text-align:center">1.4720 s</td>
<td style="text-align:center">1.4720 s</td>
<td style="text-align:center">setRowReadColIpad(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">8.88%</td>
<td style="text-align:center">1.4090 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.4090 s</td>
<td style="text-align:center">1.4090 s</td>
<td style="text-align:center">1.4090 s</td>
<td style="text-align:center">setRowReadRow(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">8.47%</td>
<td style="text-align:center">1.3450 s</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.3450 s</td>
<td style="text-align:center">1.3450 s</td>
<td style="text-align:center">1.3450 s</td>
<td style="text-align:center">setRowReadColDynIpad(int*)</td>
</tr>
</tbody>
</table>
<p></p>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BDIMX_RECT 32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BDIMY_RECT 16</span></span><br></pre></td></tr></table></figure></div>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h3>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColRect</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY_RECT][BDIMX_RECT];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[icol][irow];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/rect.png"
                      alt="sltpr" 
                ><br />
 1234 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br></pre></td></tr></table></figure></div>
<p> 1-&gt;3 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br></pre></td></tr></table></figure></div>
<p> 3-&gt;2  tile  1  3  1  x  3  y <br />
 32  16  32  16 </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColRectDyn</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    <span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> col_idx=icol*blockDim.x+irow;</span><br><span class="line">    tile[idx]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[col_idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setRowReadColRectDynPad&lt;&lt;&lt;grid_rect,block_rect,(BDIMX+<span class="number">1</span>)*<span class="function">BDIMY*<span class="title">sizeof</span><span class="params">(<span class="type">int</span>)</span>&gt;&gt;&gt;<span class="params">(out)</span></span>;</span><br></pre></td></tr></table></figure></div>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h3>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColRectPad</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY_RECT][BDIMX_RECT+IPAD];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[icol][irow];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColRectPad</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">int</span> tile[BDIMY_RECT][BDIMX_RECT+IPAD*<span class="number">2</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[icol][irow];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h3>
<p>tile </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">setRowReadColRectDynPad</span><span class="params">(<span class="type">int</span> * out)</span></span>&#123;</span><br><span class="line">    <span class="keyword">extern</span> __shared__ <span class="type">int</span> tile[];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> icol=idx%blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> irow=idx/blockDim.y;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> row_idx=threadIdx.y*(IPAD+blockDim.x)+threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> col_idx=icol*(IPAD+blockDim.x)+irow;</span><br><span class="line">    tile[row_idx]=idx;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[idx]=tile[col_idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 1 </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center">Type</th>
<th style="text-align:center">Time(%)</th>
<th style="text-align:center">Time</th>
<th style="text-align:center">Calls</th>
<th style="text-align:center">Avg</th>
<th style="text-align:center">Min</th>
<th style="text-align:center">Max</th>
<th style="text-align:center">Name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">GPU activities:</td>
<td style="text-align:center">66.27%</td>
<td style="text-align:center">12.512us</td>
<td style="text-align:center">1</td>
<td style="text-align:center">12.512us</td>
<td style="text-align:center">12.512us</td>
<td style="text-align:center">12.512us</td>
<td style="text-align:center">setRowReadColRectPad(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">8.81%</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">setRowReadColRect(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">8.81%</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">1.6640us</td>
<td style="text-align:center">setRowReadColRectDyn(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">8.47%</td>
<td style="text-align:center">1.6000us</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.6000us</td>
<td style="text-align:center">1.6000us</td>
<td style="text-align:center">1.6000us</td>
<td style="text-align:center">warmup(int*)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">7.63%</td>
<td style="text-align:center">1.4400us</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1.4400us</td>
<td style="text-align:center">1.4400us</td>
<td style="text-align:center">1.4400us</td>
<td style="text-align:center">setRowReadColRectDynPad(int*)</td>
</tr>
</tbody>
</table>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceGmem</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x + threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> *idata = g_idata + blockIdx.x * blockDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">1024</span> &amp;&amp; tid &lt; <span class="number">512</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">512</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">512</span> &amp;&amp; tid &lt; <span class="number">256</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">256</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">256</span> &amp;&amp; tid &lt; <span class="number">128</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">128</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">128</span> &amp;&amp; tid &lt; <span class="number">64</span>)</span><br><span class="line">        idata[tid] += idata[tid + <span class="number">64</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid &lt; <span class="number">32</span>) &#123;</span><br><span class="line">        <span class="keyword">volatile</span> <span class="type">int</span> *vmem = idata;</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">32</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">16</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">8</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">4</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">2</span>];</span><br><span class="line">        vmem[tid] += vmem[tid + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = idata[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x*blockIdx.x+threadIdx.x;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *idata = g_idata + blockIdx.x*blockDim.x;</span><br></pre></td></tr></table></figure></div>
<p>tid  idx</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">1024</span> &amp;&amp; tid &lt; <span class="number">512</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">512</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">512</span> &amp;&amp; tid &lt; <span class="number">256</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">256</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">256</span> &amp;&amp; tid &lt; <span class="number">128</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">128</span>];</span><br><span class="line">__syncthreads();</span><br><span class="line"><span class="keyword">if</span> (blockDim.x &gt;= <span class="number">128</span> &amp;&amp; tid &lt; <span class="number">64</span>)</span><br><span class="line">    idata[tid] += idata[tid + <span class="number">64</span>];</span><br><span class="line">__syncthreads();</span><br></pre></td></tr></table></figure></div>
<p> 64  64 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (tid &lt; <span class="number">32</span>) &#123;</span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> *vmem = idata;</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">32</span>];</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">16</span>];</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">8</span>];</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">4</span>];</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">2</span>];</span><br><span class="line">    vmem[tid] += vmem[tid + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> volatile </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> 4 4 :</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceUnroll4Smem</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    __shared__ <span class="type">int</span> smem[DIM];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tid = threadIdx.x;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x * <span class="number">4</span> + threadIdx.x;</span><br><span class="line">    <span class="comment">// boundary check</span></span><br><span class="line">    <span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="type">int</span> tempSum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (idx + <span class="number">3</span> * blockDim.x &lt;= n) &#123;</span><br><span class="line">        <span class="type">int</span> a1 = g_idata[idx];</span><br><span class="line">        <span class="type">int</span> a2 = g_idata[idx + blockDim.x];</span><br><span class="line">        <span class="type">int</span> a3 = g_idata[idx + <span class="number">2</span> * blockDim.x];</span><br><span class="line">        <span class="type">int</span> a4 = g_idata[idx + <span class="number">3</span> * blockDim.x];</span><br><span class="line">        tempSum = a1 + a2 + a3 + a4;</span><br><span class="line">    &#125;</span><br><span class="line">    smem[tid] = tempSum;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// in-place reduction in global memory</span></span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">1024</span> &amp;&amp; tid &lt; <span class="number">512</span>)</span><br><span class="line">        smem[tid] += smem[tid + <span class="number">512</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">512</span> &amp;&amp; tid &lt; <span class="number">256</span>)</span><br><span class="line">        smem[tid] += smem[tid + <span class="number">256</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">256</span> &amp;&amp; tid &lt; <span class="number">128</span>)</span><br><span class="line">        smem[tid] += smem[tid + <span class="number">128</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (blockDim.x &gt;= <span class="number">128</span> &amp;&amp; tid &lt; <span class="number">64</span>)</span><br><span class="line">        smem[tid] += smem[tid + <span class="number">64</span>];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// write result for this block to global mem</span></span><br><span class="line">    <span class="keyword">if</span> (tid &lt; <span class="number">32</span>) &#123;</span><br><span class="line">        <span class="keyword">volatile</span> <span class="type">int</span> *vsmem = smem;</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">32</span>];</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">16</span>];</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">8</span>];</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">4</span>];</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">2</span>];</span><br><span class="line">        vsmem[tid] += vsmem[tid + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (tid == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = smem[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x * <span class="number">4</span> + threadIdx.x;</span><br><span class="line"><span class="comment">// boundary check</span></span><br><span class="line"><span class="keyword">if</span> (tid &gt;= n)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"><span class="comment">// convert global data pointer to the</span></span><br><span class="line"><span class="type">int</span> tempSum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (idx + <span class="number">3</span> * blockDim.x &lt;= n) &#123;</span><br><span class="line">    <span class="type">int</span> a1 = g_idata[idx];</span><br><span class="line">    <span class="type">int</span> a2 = g_idata[idx + blockDim.x];</span><br><span class="line">    <span class="type">int</span> a3 = g_idata[idx + <span class="number">2</span> * blockDim.x];</span><br><span class="line">    <span class="type">int</span> a4 = g_idata[idx + <span class="number">3</span> * blockDim.x];</span><br><span class="line">    tempSum = a1 + a2 + a3 + a4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 3 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625164313920.png"
                      alt="image-20240625164313920" 
                ></p>
<p><br />
</p>
<ul>
<li>I/O </li>
<li> 14 </li>
<li></li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> sizeof()</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<p>=(+)109 </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>.<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">copyRow</span><span class="params">(<span class="type">float</span> * in,<span class="type">float</span> * out,<span class="type">int</span> nx,<span class="type">int</span> ny)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ix=threadIdx.x+blockDim.x*blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy=threadIdx.y+blockDim.y*blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx=ix+iy*nx;</span><br><span class="line">    <span class="keyword">if</span> (ix&lt;nx &amp;&amp; iy&lt;ny) &#123;</span><br><span class="line">      out[idx]=in[idx];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformNaiveRow</span><span class="params">(<span class="type">float</span> * in,<span class="type">float</span> * out,<span class="type">int</span> nx,<span class="type">int</span> ny)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ix=threadIdx.x+blockDim.x*blockIdx.x;</span><br><span class="line">    <span class="type">int</span> iy=threadIdx.y+blockDim.y*blockIdx.y;</span><br><span class="line">    <span class="type">int</span> idx_row=ix+iy*nx;</span><br><span class="line">    <span class="type">int</span> idx_col=ix*ny+iy;</span><br><span class="line">    <span class="keyword">if</span> (ix&lt;nx &amp;&amp; iy&lt;ny) &#123;</span><br><span class="line">      out[idx_col]=in[idx_row];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">CPU </th>
<th style="text-align:center">nvprof </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">copyRow</td>
<td style="text-align:center">0.001442 s</td>
<td style="text-align:center">1.4859 ms</td>
</tr>
<tr>
<td style="text-align:center">transformNaiveRow</td>
<td style="text-align:center">0.003964 s</td>
<td style="text-align:center">3.9640 ms</td>
</tr>
</tbody>
</table>
<p> cpu ,</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/re-5.png"
                      alt="re-5" 
                ><br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformSmem</span><span class="params">(<span class="type">float</span> * in,<span class="type">float</span>* out,<span class="type">int</span> nx,<span class="type">int</span> ny)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">float</span> tile[BDIMY][BDIMX];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> ix,iy,transform_in_idx,transform_out_idx;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    ix=threadIdx.x+blockDim.x*blockIdx.x;</span><br><span class="line">        iy=threadIdx.y+blockDim.y*blockIdx.y;</span><br><span class="line">    transform_in_idx=iy*nx+ix;</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bidx,irow,icol;</span><br><span class="line">    bidx=threadIdx.y*blockDim.x+threadIdx.x;</span><br><span class="line">    irow=bidx/blockDim.y;</span><br><span class="line">    icol=bidx%blockDim.y;</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    ix=blockIdx.y*blockDim.y+icol;</span><br><span class="line">    iy=blockIdx.x*blockDim.x+irow;</span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    transform_out_idx=iy*ny+ix;</span><br><span class="line">    <span class="keyword">if</span>(ix&lt;nx&amp;&amp; iy&lt;ny)&#123;</span><br><span class="line">    tile[threadIdx.y][threadIdx.x]=in[transform_in_idx];</span><br><span class="line">    __syncthreads();</span><br><span class="line">    out[transform_out_idx]=tile[icol][irow];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-2.png"
                      alt="1-2" 
                ></p>
<p></p>
<ol>
<li></li>
<li>bidx  block idx </li>
<li></li>
<li></li>
<li></li>
</ol>
<p> 5 </p>
<ul>
<li></li>
<li></li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformSmemPad</span><span class="params">(<span class="type">float</span> *in, <span class="type">float</span> *out, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    __shared__ <span class="type">float</span> tile[BDIMY][BDIMX + IPAD];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> ix, iy, transform_in_idx, transform_out_idx;</span><br><span class="line">    ix = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    transform_in_idx = iy * nx + ix;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bidx, irow, icol;</span><br><span class="line">    bidx = threadIdx.y * blockDim.x + threadIdx.x;</span><br><span class="line">    irow = bidx / blockDim.y;</span><br><span class="line">    icol = bidx % blockDim.y;</span><br><span class="line"></span><br><span class="line">    ix = blockIdx.y * blockDim.y + icol;</span><br><span class="line">    iy = blockIdx.x * blockDim.x + irow;</span><br><span class="line"></span><br><span class="line">    transform_out_idx = iy * ny + ix;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ix &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        tile[threadIdx.y][threadIdx.x] = in[transform_in_idx];</span><br><span class="line">        __syncthreads();</span><br><span class="line">        out[transform_out_idx] = tile[icol][irow];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">transformSmemUnrollPad</span><span class="params">(<span class="type">float</span> *in, <span class="type">float</span> *out, <span class="type">int</span> nx, <span class="type">int</span> ny)</span> </span>&#123;</span><br><span class="line">    __shared__ <span class="type">float</span> tile[BDIMY * (BDIMX * <span class="number">2</span> + IPAD)];</span><br><span class="line">    <span class="comment">// 1.</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> ix, iy, transform_in_idx, transform_out_idx;</span><br><span class="line">    ix = threadIdx.x + blockDim.x * blockIdx.x * <span class="number">2</span>;</span><br><span class="line">    iy = threadIdx.y + blockDim.y * blockIdx.y;</span><br><span class="line">    transform_in_idx = iy * nx + ix;</span><br><span class="line">    <span class="comment">// 2.</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bidx, irow, icol;</span><br><span class="line">    bidx = threadIdx.y * blockDim.x + threadIdx.x;</span><br><span class="line">    irow = bidx / blockDim.y;</span><br><span class="line">    icol = bidx % blockDim.y;</span><br><span class="line">    <span class="comment">// 3.</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> ix2 = blockIdx.y * blockDim.y + icol;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> iy2 = blockIdx.x * blockDim.x * <span class="number">2</span> + irow;</span><br><span class="line">    <span class="comment">// 4.</span></span><br><span class="line">    transform_out_idx = iy2 * ny + ix2;</span><br><span class="line">    <span class="keyword">if</span> (ix + blockDim.x &lt; nx &amp;&amp; iy &lt; ny) &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> row_idx = threadIdx.y * (blockDim.x * <span class="number">2</span> + IPAD) + threadIdx.x;</span><br><span class="line">        tile[row_idx] = in[transform_in_idx];</span><br><span class="line">        tile[row_idx + BDIMX] = in[transform_in_idx + BDIMX];</span><br><span class="line">        <span class="comment">// 5</span></span><br><span class="line">        __syncthreads();</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> col_idx = icol * (blockDim.x * <span class="number">2</span> + IPAD) + irow;</span><br><span class="line">        out[transform_out_idx] = tile[col_idx];</span><br><span class="line">        out[transform_out_idx + ny * BDIMX] = tile[col_idx + BDIMX];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-3-1719307539591-212.png"
                      alt="1-3" 
                ></p>
<ol>
<li></li>
<li></li>
<li></li>
<li> x B BDIMX AB </li>
<li> 4 </li>
</ol>
<p></p>
<h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2>
<p> 1616 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625165543828.png"
                      alt="image-20240625165543828" 
                ></p>
<p> 88 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625165643634.png"
                      alt="image-20240625165643634" 
                ></p>
<h1 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h1>
<h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2>
<p><br />
 DRAM   SM  64KB<br />
 DRAM </p>
<blockquote>
<p></p>
</blockquote>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__constant__</span><br></pre></td></tr></table></figure></div>
<p> CUDA <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpyToSymbol</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *symbol, <span class="type">const</span> <span class="type">void</span> * src,  <span class="type">size_t</span> count, <span class="type">size_t</span> offset, cudaMemcpyKind kind)</span></span></span><br></pre></td></tr></table></figure></div>
<p> copy kind </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1-1719307543197-215.png"
                      alt="1-1" 
                ></p>
<p></p>
<p>f(x)c3(f(x+4h)f(x4h))+c2(f(x+3h)f(x3h))+c1(f(x+2h)f(x2h))+c0(f(x+h)f(xh))</p>
<p>.<br />
 c0  c3<br />
 ci,0&lt;i&lt;4  c  32 <br />
 8 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">stencil_1d</span><span class="params">(<span class="type">float</span> *in, <span class="type">float</span> *out)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1.</span></span><br><span class="line">    __shared__ <span class="type">float</span> smem[BDIM + <span class="number">2</span> * TEMP_RADIO_SIZE];</span><br><span class="line">    <span class="comment">// 2.</span></span><br><span class="line">    <span class="type">int</span> idx = threadIdx.x + blockDim.x * blockIdx.x;</span><br><span class="line">    <span class="comment">// 3.</span></span><br><span class="line">    <span class="type">int</span> sidx = threadIdx.x + TEMP_RADIO_SIZE;</span><br><span class="line">    smem[sidx] = in[idx];</span><br><span class="line">    <span class="comment">// 4.</span></span><br><span class="line">    <span class="keyword">if</span> (threadIdx.x &lt; TEMP_RADIO_SIZE) &#123;</span><br><span class="line">        <span class="keyword">if</span> (idx &gt; TEMP_RADIO_SIZE)</span><br><span class="line">            smem[sidx - TEMP_RADIO_SIZE] = in[idx - TEMP_RADIO_SIZE];</span><br><span class="line">        <span class="keyword">if</span> (idx &lt; gridDim.x * blockDim.x - BDIM)</span><br><span class="line">            smem[sidx + BDIM] = in[idx + BDIM];</span><br><span class="line">    &#125;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// 5.</span></span><br><span class="line">    <span class="keyword">if</span> (idx &lt; TEMP_RADIO_SIZE || idx &gt;= gridDim.x * blockDim.x - TEMP_RADIO_SIZE)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">float</span> temp = <span class="number">.0</span>f;</span><br><span class="line"><span class="comment">// 6.</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= TEMP_RADIO_SIZE; i++) &#123;</span><br><span class="line">        temp += coef[i - <span class="number">1</span>] * (smem[sidx + i] - smem[sidx - i]);</span><br><span class="line">    &#125;</span><br><span class="line">    out[idx] = temp;</span><br><span class="line">    <span class="comment">// printf(&quot;%d:GPU :%lf,\n&quot;,idx,temp);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 9 4 -1-2-3-4  4  n+1,n+2,n+3,n+4 ~</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-2-1719307546862-218.png"
                      alt="1-2" 
                ></p>
<ol>
<li></li>
<li></li>
<li> TEMP_RADIO_SIZE  TEMP_RADIO_SIZE </li>
<li></li>
<li></li>
<li></li>
</ol>
<p> 4</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>,Kepler SM  48KB  32.<br />
</p>
<ul>
<li>__ldg </li>
<li></li>
</ul>
<p>__ldg()</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel</span><span class="params">(<span class="type">float</span>* output, <span class="type">float</span>* input)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">output[idx] += __ldg(&amp;input[idx]);</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">kernel</span><span class="params">(<span class="type">float</span>* output, <span class="type">const</span> <span class="type">float</span>* __restrict__ input)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">output[idx] += input[idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> __ldg()<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">stencil_1d_readonly</span><span class="params">(<span class="type">float</span> * in,<span class="type">float</span> * out,<span class="type">const</span> <span class="type">float</span>* __restrict__ dcoef)</span></span>&#123;</span><br><span class="line">    __shared__ <span class="type">float</span> smem[BDIM+<span class="number">2</span>*TEMP_RADIO_SIZE];</span><br><span class="line">    <span class="type">int</span> idx=threadIdx.x+blockDim.x*blockIdx.x;</span><br><span class="line">    <span class="type">int</span> sidx=threadIdx.x+TEMP_RADIO_SIZE;</span><br><span class="line">    smem[sidx]=in[idx];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (threadIdx.x&lt;TEMP_RADIO_SIZE)&#123;</span><br><span class="line">        <span class="keyword">if</span>(idx&gt;TEMP_RADIO_SIZE)</span><br><span class="line">            smem[sidx-TEMP_RADIO_SIZE]=in[idx-TEMP_RADIO_SIZE];</span><br><span class="line">        <span class="keyword">if</span>(idx&lt;gridDim.x*blockDim.x-BDIM)</span><br><span class="line">            smem[sidx+BDIM]=in[idx+BDIM];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="keyword">if</span> (idx&lt;TEMP_RADIO_SIZE||idx&gt;=gridDim.x*blockDim.x-TEMP_RADIO_SIZE)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">float</span> temp=<span class="number">.0</span>f;</span><br><span class="line">    <span class="meta">#<span class="keyword">pragma</span> unroll</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=TEMP_RADIO_SIZE;i++) &#123;</span><br><span class="line">        temp+=dcoef[i<span class="number">-1</span>]*(smem[sidx+i]-smem[sidx-i]);</span><br><span class="line">    &#125;</span><br><span class="line">    out[idx]=temp;</span><br><span class="line">    <span class="comment">//printf(&quot;%d:GPU :%lf,\n&quot;,idx,temp);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> * dcoef_ro;</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMalloc</span>((<span class="type">void</span>**)&amp;dcoef_ro,TEMP_RADIO_SIZE * <span class="built_in">sizeof</span>(<span class="type">float</span>)));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(dcoef_ro,templ_,TEMP_RADIO_SIZE * <span class="built_in">sizeof</span>(<span class="type">float</span>),cudaMemcpyHostToDevice));</span><br><span class="line">stencil_1d_readonly&lt;&lt;&lt;grid,block&gt;&gt;&gt;(in_dev,out_dev,dcoef_ro);</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaDeviceSynchronize</span>());</span><br><span class="line">iElaps=<span class="built_in">cpuSecond</span>()-iStart;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;stencil_1d_readonly Time elapsed %f sec\n&quot;</span>,iElaps);</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpy</span>(out_gpu,out_dev,nBytes,cudaMemcpyDeviceToHost));</span><br><span class="line"><span class="built_in">checkResult</span>(out_cpu,out_gpu,nxy);</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170025114.png"
                      alt="image-20240625170025114" 
                ></p>
<h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2>
<p></p>
<ul>
<li></li>
<li>SM  64KB 48KB</li>
<li></li>
<li></li>
</ul>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<blockquote>
<p> 3.0 </p>
</blockquote>
<p>shuffle instruction  32  32 <br />
<br />
 lane ID  [0,31][0,31]  threadIdx.x  ID ID</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> LaneID=threadIdx.x%<span class="number">32</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> warpID=threadIdx.x/<span class="number">32</span>;</span><br></pre></td></tr></table></figure></div>
<p> threadIdx.x=1,33,65  laneID  1</p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __shfl(<span class="type">int</span> var,<span class="type">int</span> srcLane,<span class="type">int</span> width=warpSize);</span><br></pre></td></tr></table></figure></div>
<p>var  int  var  1  var  1 2  var  1__shfl  var  var srcLane srcLane  with  3  var  width=160~15  0+3  var  3  var 16~32  16+3=19  var <br />
width  32.srcLane  width <br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-1-1719307553733-221.png"
                      alt="1-1" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __shfl_up(<span class="type">int</span> var,<span class="type">unsigned</span> <span class="type">int</span> delta,<span class="type">int</span> with=warpSize);</span><br></pre></td></tr></table></figure></div>
<p> delta  var with __shfl  32</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-2-1719307555178-224.png"
                      alt="1-2" 
                ></p>
<p> with  with <br />
 delta </p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __shfl_down(<span class="type">int</span> var,<span class="type">unsigned</span> <span class="type">int</span> delta,<span class="type">int</span> with=warpSize);</span><br></pre></td></tr></table></figure></div>
<p> up </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-3-1719307556974-227.png"
                      alt="1-3" 
                ></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __shfl_xor(<span class="type">int</span> var,<span class="type">int</span> laneMask,<span class="type">int</span> with=warpSize);</span><br></pre></td></tr></table></figure></div>
<p>xor  c  01  ^:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>^<span class="number">0</span>=<span class="number">0</span>;</span><br><span class="line"><span class="number">1</span>^<span class="number">0</span>=<span class="number">1</span>;</span><br><span class="line"><span class="number">0</span>^<span class="number">1</span>=<span class="number">1</span>;</span><br><span class="line"><span class="number">1</span>^<span class="number">1</span>=<span class="number">0</span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
__shfl_xor <br />
 laneMask  1 000001000001 , 0~31  laneMask  laneMask  1 1  0~31 </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">000001</span>^<span class="number">000000</span>=<span class="number">000001</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">000001</span>=<span class="number">000000</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">000010</span>=<span class="number">000011</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">000011</span>=<span class="number">000010</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">000100</span>=<span class="number">000101</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">000101</span>=<span class="number">000100</span>;</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"><span class="number">000001</span>^<span class="number">011110</span>=<span class="number">011111</span>;</span><br><span class="line"><span class="number">000001</span>^<span class="number">011111</span>=<span class="number">011110</span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-4.png"
                      alt="1-4" 
                ></p>
<p> 4  var  float </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> __shfl </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_broadcast</span><span class="params">(<span class="type">int</span> *in,<span class="type">int</span>*out,<span class="type">int</span> <span class="type">const</span> srcLans)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> value=in[threadIdx.x];</span><br><span class="line">    value=__shfl(value,srcLans,BDIM);</span><br><span class="line">    out[threadIdx.x]=value;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> var  value srcLane  2 2  value  value  2 <br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170353274.png"
                      alt="image-20240625170353274" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>__shfl_up </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_up</span><span class="params">(<span class="type">int</span> *in,<span class="type">int</span>*out,<span class="type">int</span> <span class="type">const</span> delta)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> value=in[threadIdx.x];</span><br><span class="line">    value=__shfl_up(value,delta,BDIM);</span><br><span class="line">    out[threadIdx.x]=value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170439121.png"
                      alt="image-20240625170439121" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>__shfl_down </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_down</span><span class="params">(<span class="type">int</span> *in,<span class="type">int</span>*out,<span class="type">int</span> <span class="type">const</span> delta)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> value=in[threadIdx.x];</span><br><span class="line">    value=__shfl_down(value,delta,BDIM);</span><br><span class="line">    out[threadIdx.x]=value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170508863.png"
                      alt="image-20240625170508863" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>__shfl </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_wrap</span><span class="params">(<span class="type">int</span> *in,<span class="type">int</span>*out,<span class="type">int</span> <span class="type">const</span> offset)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> value=in[threadIdx.x];</span><br><span class="line">    value=__shfl(value,threadIdx.x+offset,BDIM);</span><br><span class="line">    out[threadIdx.x]=value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> offset=2 <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170545982.png"
                      alt="image-20240625170545982" 
                ></p>
<p> 14  14 15 **shfl_down  0  1 **shfl  with </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srcLane=srcLane%width;</span><br></pre></td></tr></table></figure></div>
<p> srclane -2 </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>__shfl_xor </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_xor</span><span class="params">(<span class="type">int</span> *in,<span class="type">int</span>*out,<span class="type">int</span> <span class="type">const</span> mask)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> value=in[threadIdx.x];</span><br><span class="line">    value=__shfl_xor(value,mask,BDIM);</span><br><span class="line">    out[threadIdx.x]=value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>mask  1<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170622294.png"
                      alt="image-20240625170622294" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_xor_array</span><span class="params">(<span class="type">int</span> *in, <span class="type">int</span> *out, <span class="type">int</span> <span class="type">const</span> mask)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1.</span></span><br><span class="line">    <span class="type">int</span> idx = threadIdx.x * SEGM;</span><br><span class="line">    <span class="comment">// 2.</span></span><br><span class="line">    <span class="type">int</span> value[SEGM];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SEGM; i++)</span><br><span class="line">        value[i] = in[idx + i];</span><br><span class="line">    <span class="comment">// 3.</span></span><br><span class="line">    value[<span class="number">0</span>] = __shfl_xor(value[<span class="number">0</span>], mask, BDIM);</span><br><span class="line">    value[<span class="number">1</span>] = __shfl_xor(value[<span class="number">1</span>], mask, BDIM);</span><br><span class="line">    value[<span class="number">2</span>] = __shfl_xor(value[<span class="number">2</span>], mask, BDIM);</span><br><span class="line">    value[<span class="number">3</span>] = __shfl_xor(value[<span class="number">3</span>], mask, BDIM);</span><br><span class="line">    <span class="comment">// 4.</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SEGM; i++)</span><br><span class="line">        out[idx + i] = value[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> SEGM  4 SEGM <br />
</p>
<ol>
<li> SEGM </li>
<li></li>
<li> mask  1</li>
<li></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170721418.png"
                      alt="image-20240625170721418" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__inline__ __device__ <span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> *value, <span class="type">int</span> laneIdx, <span class="type">int</span> mask, <span class="type">int</span> firstIdx, <span class="type">int</span> secondIdx)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> pred = ((laneIdx % (<span class="number">2</span>)) == <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (pred) &#123;</span><br><span class="line">        <span class="type">int</span> tmp = value[firstIdx];</span><br><span class="line">        value[firstIdx] = value[secondIdx];</span><br><span class="line">        value[secondIdx] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    value[secondIdx] = __shfl_xor(value[secondIdx], mask, BDIM);</span><br><span class="line">    <span class="keyword">if</span> (pred) &#123;</span><br><span class="line">        <span class="type">int</span> tmp = value[firstIdx];</span><br><span class="line">        value[firstIdx] = value[secondIdx];</span><br><span class="line">        value[secondIdx] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">test_shfl_swap</span><span class="params">(<span class="type">int</span> *in, <span class="type">int</span> *out, <span class="type">int</span> <span class="type">const</span> mask, <span class="type">int</span> firstIdx, <span class="type">int</span> secondIdx)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1.</span></span><br><span class="line">    <span class="type">int</span> idx = threadIdx.x * SEGM;</span><br><span class="line">    <span class="type">int</span> value[SEGM];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SEGM; i++)</span><br><span class="line">        value[i] = in[idx + i];</span><br><span class="line">    <span class="comment">// 2.</span></span><br><span class="line">    <span class="built_in">swap</span>(value, threadIdx.x, mask, firstIdx, secondIdx);</span><br><span class="line">    <span class="comment">// 3.</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SEGM; i++)</span><br><span class="line">        out[idx + i] = value[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<ol>
<li></li>
<li> first  second xor  second  first  second </li>
<li></li>
</ol>
<p>2 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/1-5-1719307564932-232.png"
                      alt="img" 
                ><br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170721418.png"
                      alt="image-20240625170721418" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__inline__ __device__ <span class="type">int</span> <span class="title">warpReduce</span><span class="params">(<span class="type">int</span> localSum)</span> </span>&#123;</span><br><span class="line">    localSum += __shfl_xor(localSum, <span class="number">16</span>);</span><br><span class="line">    localSum += __shfl_xor(localSum, <span class="number">8</span>);</span><br><span class="line">    localSum += __shfl_xor(localSum, <span class="number">4</span>);</span><br><span class="line">    localSum += __shfl_xor(localSum, <span class="number">2</span>);</span><br><span class="line">    localSum += __shfl_xor(localSum, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> localSum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">reduceShfl</span><span class="params">(<span class="type">int</span> *g_idata, <span class="type">int</span> *g_odata, <span class="type">unsigned</span> <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// set thread ID</span></span><br><span class="line">    __shared__ <span class="type">int</span> smem[DIM];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> idx = blockDim.x * blockIdx.x + threadIdx.x;</span><br><span class="line">    <span class="comment">// convert global data pointer to the</span></span><br><span class="line">    <span class="comment">// 1.</span></span><br><span class="line">    <span class="type">int</span> mySum = g_idata[idx];</span><br><span class="line">    <span class="type">int</span> laneIdx = threadIdx.x % warpSize;</span><br><span class="line">    <span class="type">int</span> warpIdx = threadIdx.x / warpSize;</span><br><span class="line">    <span class="comment">// 2.</span></span><br><span class="line">    mySum = <span class="built_in">warpReduce</span>(mySum);</span><br><span class="line">    <span class="comment">// 3.</span></span><br><span class="line">    <span class="keyword">if</span> (laneIdx == <span class="number">0</span>)</span><br><span class="line">        smem[warpIdx] = mySum;</span><br><span class="line">    __syncthreads();</span><br><span class="line">    <span class="comment">// 4.</span></span><br><span class="line">    mySum = (threadIdx.x &lt; DIM) ? smem[laneIdx] : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (warpIdx == <span class="number">0</span>)</span><br><span class="line">        mySum = <span class="built_in">warpReduce</span>(mySum);</span><br><span class="line">    <span class="comment">// 5.</span></span><br><span class="line">    <span class="keyword">if</span> (threadIdx.x == <span class="number">0</span>)</span><br><span class="line">        g_odata[blockIdx.x] = mySum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>:</p>
<ol>
<li> ID  ID</li>
<li> xor 2  32  16 xor 16  0+161+172+18, 16 16  31  xor 8  0+81+92+10,, 8 </li>
<li></li>
<li> 2  3  5.<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625170853139.png"
                      alt="image-20240625170853139" 
                ></li>
</ol>
<p></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
<li> CPU  GPU </li>
<li></li>
<li></li>
<li></li>
<li> NVIDIA </li>
</ul>
<p> CUDA </p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
 GPU </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> GPU  CUDA <br />
CUDA  CUDA cudaMalloccudaMemcpyMemcpy<br />
<br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<p>CUDA <br />
<br />
CUDA <br />
CUDA </p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p><br />
 CUDA  API <br />
CUDA  API </p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
PCIe  SM </p>
<p></p>
<h2 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h2>
<p> CUDA  CUDA </p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
<br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p>CUDA  C++ CPU  GPU <br />
 cudaMemcpy </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMemcpyAsync</span><span class="params">(<span class="type">void</span>* dst, <span class="type">const</span> <span class="type">void</span>* src, <span class="type">size_t</span> count,cudaMemcpyKind kind, cudaStream_t stream = <span class="number">0</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>stream </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamCreate</span><span class="params">(cudaStream_t* pStream)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> C++</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cudaStream_t a;</span><br></pre></td></tr></table></figure></div>
<p> a  cudaStreamCreate </p>
<blockquote>
<p></p>
</blockquote>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaMallocHost</span><span class="params">(<span class="type">void</span> **ptr, <span class="type">size_t</span> size)</span></span>;</span><br><span class="line"><span class="function">cudaError_t <span class="title">cudaHostAlloc</span><span class="params">(<span class="type">void</span> **pHost, <span class="type">size_t</span> size, <span class="type">unsigned</span> <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kernel_name&lt;&lt;&lt;grid, block, sharedMemSize, stream&gt;&gt;&gt;(argument list);</span><br></pre></td></tr></table></figure></div>
<p>pStream  a  stream  a<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamDestroy</span><span class="params">(cudaStream_t stream)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamSynchronize</span><span class="params">(cudaStream_t stream)</span></span>;</span><br><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamQuery</span><span class="params">(cudaStream_t stream)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>cudaStreamSynchronize cudaStreamQuery  cudaSuccess  cudaErrorNotReady<br />
 CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nStreams; i++) &#123;</span><br><span class="line">    <span class="type">int</span> offset = i * bytesPerStream;</span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(&amp;d_a[offset], &amp;a[offset], bytePerStream, streams[i]);</span><br><span class="line">    kernel &lt;&lt; grid, block, <span class="number">0</span>, streams[i] &gt;&gt; (&amp;d_a[offset]);</span><br><span class="line">    <span class="built_in">cudaMemcpyAsync</span>(&amp;a[offset], &amp;d_a[offset], bytesPerStream, streams[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nStreams; i++) &#123;</span><br><span class="line">    <span class="built_in">cudaStreamSynchronize</span>(streams[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> for  nStreams <br />
 nStreams=3</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6-1.png"
                      alt="6-1" 
                ></p>
<p>H2D D2H  PCIe <br />
<br />
Fermi  16 Kepler  32 </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> Fermi  16 Fermi  CUDA </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6-2.png"
                      alt="6-2" 
                ></p>
<p> B  A Z  Y </p>
<ol>
<li> A B  B  A  A </li>
<li>A  B C</li>
<li>B  C  P  P </li>
<li>P  Q Q  P</li>
</ol>
<p> P  B  B P </p>
<h3 id="hyper-q-"><a class="markdownIt-Anchor" href="#hyper-q-"></a> Hyper-Q </h3>
<p>Hyper-Q 32 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6-3.png"
                      alt="6-3" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>3.5  C++<br />
<br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamCreateWithPriority</span><span class="params">(cudaStream_t* pStream, <span class="type">unsigned</span> <span class="type">int</span> flags,<span class="type">int</span> priority)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceGetStreamPriorityRange</span><span class="params">(<span class="type">int</span> *leastPriority, <span class="type">int</span> *greatestPriority)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>leastPriority  0<br />
greatestPriority  0<br />
 0</p>
<h2 id="cuda-"><a class="markdownIt-Anchor" href="#cuda-"></a> CUDA </h2>
<p>CUDA </p>
<ul>
<li>
<p></p>
</li>
<li>
<p></p>
<p> API </p>
<p> c  printf </p>
</li>
</ul>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cudaEvent_t event;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventCreate</span><span class="params">(cudaEvent_t* event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventDestroy</span><span class="params">(cudaEvent_t event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p><br />
 CUDA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventRecord</span><span class="params">(cudaEvent_t event, cudaStream_t stream = <span class="number">0</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventSynchronize</span><span class="params">(cudaEvent_t event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventQuery</span><span class="params">(cudaEvent_t event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> stream <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventElapsedTime</span><span class="params">(<span class="type">float</span>* ms, cudaEvent_t start, cudaEvent_t stop)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p> start  stop  cudaEventRecord <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create two events</span></span><br><span class="line">cudaEvent_t start, stop;</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line"><span class="comment">// record start event on the default stream</span></span><br><span class="line"><span class="built_in">cudaEventRecord</span>(start);</span><br><span class="line"><span class="comment">// execute kernel</span></span><br><span class="line">kernel&lt;&lt;&lt;grid, block&gt;&gt;&gt;(arguments);</span><br><span class="line"><span class="comment">// record stop event on the default stream</span></span><br><span class="line"><span class="built_in">cudaEventRecord</span>(stop);</span><br><span class="line"><span class="comment">// wait until the stop event completes</span></span><br><span class="line"><span class="built_in">cudaEventSynchronize</span>(stop);</span><br><span class="line"><span class="comment">// calculate the elapsed time between two events</span></span><br><span class="line"><span class="type">float</span> time;</span><br><span class="line"><span class="built_in">cudaEventElapsedTime</span>(&amp;time, start, stop);</span><br><span class="line"><span class="comment">// clean up the two events</span></span><br><span class="line"><span class="built_in">cudaEventDestroy</span>(start);</span><br><span class="line"><span class="built_in">cudaEventDestroy</span>(stop);</span><br></pre></td></tr></table></figure></div>
<p><br />
cudaEventRecord </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
<br />
<br />
CUDA </p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
</p>
<ul>
<li></li>
<li>/</li>
</ul>
<p><br />
</p>
<ul>
<li></li>
<li></li>
</ul>
<p><br />
</p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>cudaStreamCreate <br />
<br />
<br />
 A A CUDA  A <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kernel_1&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, stream_1&gt;&gt;&gt;();</span><br><span class="line">kernel_2&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1</span>&gt;&gt;&gt;();</span><br><span class="line">kernel_3&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, stream_2&gt;&gt;&gt;();</span><br></pre></td></tr></table></figure></div>
<p> stream_1  stream_2 kernel_1  kernel_2 kernel_2  kernel_1  kernel_2  kernel_3, kernel_3  kernel_2 <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamCreateWithFlags</span><span class="params">(cudaStream_t* pStream, <span class="type">unsigned</span> <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cudaStreamDefault;<span class="comment">// </span></span><br><span class="line">cudaStreamNonBlocking: <span class="comment">//</span></span><br></pre></td></tr></table></figure></div>
<p> stream_1  stream_2 </p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p> cudaMemcpy </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cudaDeviceSynchronize;</span><br><span class="line">cudaStreamSynchronize;</span><br><span class="line">cudaEventSynchronize;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p></p>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaDeviceSynchronize</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamSynchronize</span><span class="params">(cudaStream_t stream)</span></span>;</span><br><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamQuery</span><span class="params">(cudaStream_t stream)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventSynchronize</span><span class="params">(cudaEvent_t event)</span></span>;</span><br><span class="line"><span class="function">cudaError_t <span class="title">cudaEventQuery</span><span class="params">(cudaEvent_t event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamWaitEvent</span><span class="params">(cudaStream_t stream, cudaEvent_t event)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p><br />
</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/6-4.png"
                      alt="6-4" 
                ></p>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3>
<p>CDUA </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaEventCreateWithFlags</span><span class="params">(cudaEvent_t* event, <span class="type">unsigned</span> <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cudaEventDefault</span><br><span class="line">cudaEventBlockingSync</span><br><span class="line">cudaEventDisableTiming</span><br><span class="line">cudaEventInterprocess</span><br></pre></td></tr></table></figure></div>
<p> cudaEventBlockingSync  cudaEventSynchronize cudaEventSynchronize  cpu  cudaEventBlockingSync  CPU <br />
cudaEventDisableTiming  cudaStreamWaitEvent  cudaEventQuery <br />
cudaEventInterprocess </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<ul>
<li></li>
<li></li>
<li> Kepler  Fermi </li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> NVIDIA  nvvp <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        sum = sum + <span class="built_in">tan</span>(<span class="number">0.1</span>) * <span class="built_in">tan</span>(<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        sum = sum + <span class="built_in">tan</span>(<span class="number">0.1</span>) * <span class="built_in">tan</span>(<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel_3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        sum = sum + <span class="built_in">tan</span>(<span class="number">0.1</span>) * <span class="built_in">tan</span>(<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">kernel_4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        sum = sum + <span class="built_in">tan</span>(<span class="number">0.1</span>) * <span class="built_in">tan</span>(<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>N  100tan  GPU <br />
</p>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cudaStream_t *stream=(cudaStream_t*)<span class="built_in">malloc</span>(n_stream*<span class="built_in">sizeof</span>(cudaStream_t));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n_stream;i++)&#123;</span><br><span class="line">    <span class="built_in">cudaStreamCreate</span>(&amp;stream[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> malloc  free <br />
 Create  n_stream </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">dim3 <span class="title">grid</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">cudaEvent_t start, stop;</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line"><span class="built_in">cudaEventRecord</span>(start);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n_stream; i++) &#123;</span><br><span class="line">    kernel_1&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_2&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_3&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_4&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cudaEventRecord</span>(stop);</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaEventSynchronize</span>(stop));</span><br><span class="line"><span class="type">float</span> elapsed_time;</span><br><span class="line"><span class="built_in">cudaEventElapsedTime</span>(&amp;elapsed_time, start, stop);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;elapsed time:%f ms\n&quot;</span>, elapsed_time);</span><br></pre></td></tr></table></figure></div>
<p> 10  10  4 <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaEventSynchronize</span>(stop)</span><br></pre></td></tr></table></figure></div>
<p>nvvp nvvp <br />
<br />
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625171045981.png"
                      alt="image-20240625171045981" 
                ></p>
<h2 id="-openmp-"><a class="markdownIt-Anchor" href="#-openmp-"></a>  OpenMP </h2>
<p>OpenMP  pthread  pthread </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">omp_set_num_thread</span>(n_stream);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> omp parallel &#123;</span></span><br><span class="line">    <span class="type">int</span> i=<span class="built_in">omp_get_thread_num</span>();</span><br><span class="line">    kernel_1&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_2&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_3&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_4&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">omp_set_num_thread</span>(n_stream);</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> omp parallel</span></span><br></pre></td></tr></table></figure></div>
<p> OpenMP  API  n_stream </p>
<p>OpenMP  mac  GCC Linux  Windows Linux Windows  vs  IDE  cmake </p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -O3 -Xcompiler -fopenmp ./31_stream_omp/stream_omp.cu -o ./31_stream_omp/stream_omp -lgomp -I ./include/</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625171325330.png"
                      alt="image-20240625171325330" 
                ></p>
<p>CUDA  OpenMP  CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p>Kepler  Hyper-Q  32  8  32  8 <br />
 Linux </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#For Bash <span class="keyword">or</span> Bourne Shell:</span><br><span class="line"><span class="keyword">export</span> CUDA_DEVICE_MAX_CONNECTIONS=<span class="number">32</span></span><br><span class="line">#For C-Shell:</span><br><span class="line">setenv CUDA_DEVICE_MAX_CONNECTIONS <span class="number">32</span></span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setenv</span>(<span class="string">&quot;CUDA_DEVICE_MAX_CONNECTIONS&quot;</span>, <span class="string">&quot;32&quot;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure></div>
<h2 id="gpu-"><a class="markdownIt-Anchor" href="#gpu-"></a> GPU </h2>
<p> GPU </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">dim3 <span class="title">grid</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">dim3 <span class="title">block</span><span class="params">(<span class="number">16</span>,<span class="number">32</span>)</span></span>;</span><br><span class="line"><span class="function">dim3 <span class="title">grid</span><span class="params">(<span class="number">32</span>)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p>4 nvvp </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/nvvp-6.png"
                      alt="nvvp-6" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p> GPU <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n_stream;i++)&#123;</span><br><span class="line">    kernel_1&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_2&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_3&lt;&lt;&lt;grid,block&gt;&gt;&gt;();</span><br><span class="line">    kernel_4&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>kernel_3  NVVP  kernel_3 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/nvvp-7.png"
                      alt="nvvp-7" 
                ></p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
 cudaEventDisableTiming </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cudaEvent_t * event=(cudaEvent_t *)<span class="built_in">malloc</span>(n_stream*<span class="built_in">sizeof</span>(cudaEvent_t));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n_stream;i++)&#123;</span><br><span class="line">    <span class="built_in">cudaEventCreateWithFlag</span>(&amp;event[i],cudaEventDisableTiming);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n_stream;i++)&#123;</span><br><span class="line">    kernel_1&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_2&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_3&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    kernel_4&lt;&lt;&lt;grid,block,<span class="number">0</span>,stream[i]&gt;&gt;&gt;();</span><br><span class="line">    <span class="built_in">cudaEventRecord</span>(event[i],stream[i]);</span><br><span class="line">    <span class="built_in">cudaStreamWaitEvent</span>(stream[n_stream<span class="number">-1</span>],event[i],<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> 5 nvvp </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/nvvp-8.png"
                      alt="nvvp-8" 
                ></p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p> NVVPNVVP <br />
Fermi  Kepler </p>
<blockquote>
<p></p>
</blockquote>
<p></p>
<ul>
<li> A A </li>
<li> A</li>
</ul>
<p>CUDA </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">sumArraysGPU</span><span class="params">(<span class="type">float</span>*a,<span class="type">float</span>*b,<span class="type">float</span>*res,<span class="type">int</span> N)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> idx=blockIdx.x*blockDim.x+threadIdx.x;</span><br><span class="line">    <span class="keyword">if</span>(idx &lt; N)</span><br><span class="line">    <span class="comment">//for delay &#123;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;N_REPEAT;j++)</span><br><span class="line">        res[idx]=a[idx]+b[idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p> N_REPEAT  nvvp <br />
</p>
<ol>
<li></li>
<li></li>
<li></li>
</ol>
<p> A  A  BCD  N_SEGMENT  N_SEGMENT </p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cudaStream_t stream[N_SEGMENT];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaStreamCreate</span>(&amp;stream[i]));</span><br><span class="line">&#125;</span><br><span class="line">cudaEvent_t start, stop;</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line"><span class="built_in">cudaEventRecord</span>(start, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;a_d[ioffset], &amp;a_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;b_d[ioffset], &amp;b_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;(&amp;a_d[ioffset], &amp;b_d[ioffset], &amp;res_d[ioffset], iElem);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;res_from_gpu_h[ioffset], &amp;res_d[ioffset], nByte / N_SEGMENT, cudaMemcpyDeviceToHost, stream[i]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// timer</span></span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaEventRecord</span>(stop, <span class="number">0</span>));</span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaEventSynchronize</span>(stop));</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;a_d[ioffset], &amp;a_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;b_d[ioffset], &amp;b_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;(&amp;a_d[ioffset], &amp;b_d[ioffset], &amp;res_d[ioffset], iElem);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;res_from_gpu_h[ioffset], &amp;res_d[ioffset], nByte / N_SEGMENT, cudaMemcpyDeviceToHost, stream[i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><br />
 nvvp </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/re-0.png"
                      alt="re-0" 
                ></p>
<p></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/re-1.png"
                      alt="re-1" 
                ></p>
<p><br />
 nvvp </p>
<ul>
<li></li>
<li></li>
</ul>
<p></p>
<ol>
<li></li>
<li></li>
</ol>
<p></p>
<p>GMU  Kepler GMU  GMU </p>
<h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2>
<p><br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;a_d[ioffset], &amp;a_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;b_d[ioffset], &amp;b_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;(&amp;a_d[ioffset], &amp;b_d[ioffset], &amp;res_d[ioffset], iElem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;res_from_gpu_h[ioffset], &amp;res_d[ioffset], nByte / N_SEGMENT, cudaMemcpyDeviceToHost, stream[i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>nvvp </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/nvvp-2.png"
                      alt="nvvp-2" 
                ><br />
 Fermi  Fermi </p>
<h1 id="-gpu--cpu-"><a class="markdownIt-Anchor" href="#-gpu--cpu-"></a>  GPU  CPU </h1>
<p> GPU  CPU <br />
</p>
<ul>
<li></li>
<li>CPU </li>
</ul>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cudaEvent_t start, stop;</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line"><span class="built_in">cudaEventRecord</span>(start, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">    <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;a_d[ioffset], &amp;a_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;b_d[ioffset], &amp;b_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">    sumArraysGPU&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;(&amp;a_d[ioffset], &amp;b_d[ioffset], &amp;res_d[ioffset], iElem);</span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;res_from_gpu_h[ioffset], &amp;res_d[ioffset], nByte / N_SEGMENT, cudaMemcpyDeviceToHost, stream[i]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// timer</span></span><br><span class="line"><span class="built_in">CHECK</span>(<span class="built_in">cudaEventRecord</span>(stop, <span class="number">0</span>));</span><br><span class="line"><span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">cudaEventQuery</span>(stop) == cudaErrorNotReady) &#123;</span><br><span class="line">    counter++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;cpu counter:%d\n&quot;</span>, counter);</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625171615236.png"
                      alt="image-20240625171615236" 
                ></p>
<p> stop CPU <br />
</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaEventQuery</span>(stop)</span><br></pre></td></tr></table></figure></div>
<p> cpu </p>
<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>
<p></p>
<ul>
<li> CUDA  API</li>
<li></li>
</ul>
<p>;</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> CUDART_CB <span class="title">my_callback</span><span class="params">(cudaStream_t stream, cudaError_t status, <span class="type">void</span> *data)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;callback from stream %d\n&quot;</span>, *((<span class="type">int</span> *)data));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cudaError_t <span class="title">cudaStreamAddCallback</span><span class="params">(cudaStream_t stream,cudaStreamCallback_t callback, <span class="type">void</span> *userData, <span class="type">unsigned</span> <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure></div>
<p></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> CUDART_CB <span class="title">my_callback</span><span class="params">(cudaStream_t stream, cudaError_t status, <span class="type">void</span> *data)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;call back from stream:%d\n&quot;</span>, *((<span class="type">int</span> *)data));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// asynchronous calculation</span></span><br><span class="line">    <span class="type">int</span> iElem = nElem / N_SEGMENT;</span><br><span class="line">    cudaStream_t stream[N_SEGMENT];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">        <span class="built_in">CHECK</span>(<span class="built_in">cudaStreamCreate</span>(&amp;stream[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    cudaEvent_t start, stop;</span><br><span class="line">    <span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line">    <span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line">    <span class="built_in">cudaEventRecord</span>(start, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SEGMENT; i++) &#123;</span><br><span class="line">        <span class="type">int</span> ioffset = i * iElem;</span><br><span class="line">        <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;a_d[ioffset], &amp;a_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">        <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;b_d[ioffset], &amp;b_h[ioffset], nByte / N_SEGMENT, cudaMemcpyHostToDevice, stream[i]));</span><br><span class="line">        sumArraysGPU&lt;&lt;&lt;grid, block, <span class="number">0</span>, stream[i]&gt;&gt;&gt;(&amp;a_d[ioffset], &amp;b_d[ioffset], &amp;res_d[ioffset], iElem);</span><br><span class="line">        <span class="built_in">CHECK</span>(<span class="built_in">cudaMemcpyAsync</span>(&amp;res_from_gpu_h[ioffset], &amp;res_d[ioffset], nByte / N_SEGMENT, cudaMemcpyDeviceToHost, stream[i]));</span><br><span class="line">        <span class="built_in">CHECK</span>(<span class="built_in">cudaStreamAddCallback</span>(stream[i], my_callback, (<span class="type">void</span> *)(stream + i), <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// timer</span></span><br><span class="line">    <span class="built_in">CHECK</span>(<span class="built_in">cudaEventRecord</span>(stop, <span class="number">0</span>));</span><br><span class="line">    <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cudaEventQuery</span>(stop) == cudaErrorNotReady) &#123;</span><br><span class="line">        counter++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="../image/CUDA-note-summary/image-20240625171737082.png"
                      alt="image-20240625171737082" 
                ></p>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> CUDA-note-summary</li>
        <li><strong>Author:</strong> Charles</li>
        <li><strong>Created at
                :</strong> 2024-06-25 10:22:46</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2024-06-25 17:28:17
            </li>
        
        <li>
            <strong>Link:</strong> https://charles2530.github.io/2024/06/25/cuda-note-summary/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/GPU/">#GPU</a>&nbsp;
                    </li>
                
            </ul>
        

        
  <div class="recommended-article px-2 sm:px-6 md:px-8">
   <div class="recommended-desktop">
    <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>recommend_articles</span>
    </div>
    <div class="recommended-article-group"><a class="recommended-article-item" href="/2023/07/17/swift-note-19/" title="Swift-note-19" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.jpg" alt="Swift-note-19" class="!max-w-none">
  <span class="title">Swift-note-19</span>
</a><a class="recommended-article-item" href="/2023/08/17/html-note-2/" title="html-note-2" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.jfif" alt="html-note-2" class="!max-w-none">
  <span class="title">html-note-2</span>
</a><a class="recommended-article-item" href="/2022/12/29/datastruct-3/" title="datastruct_3" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p4.jfif" alt="datastruct_3" class="!max-w-none">
  <span class="title">datastruct_3</span>
</a></div>
   </div>
   <div class="recommended-mobile">
   <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>recommend_articles</span>
   </div>
   <div class="recommended-article-group"><a class="recommended-article-item" href="/2023/07/17/swift-note-19/" title="Swift-note-19" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.jpg" alt="Swift-note-19" class="!max-w-none">
  <span class="title">Swift-note-19</span>
</a><a class="recommended-article-item" href="/2023/08/17/html-note-2/" title="html-note-2" rel="bookmark">
  <img src="https://charles2530.github.io/image/background/p1.jfif" alt="html-note-2" class="!max-w-none">
  <span class="title">html-note-2</span>
</a></div>
   </div>
  </div>

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/05/22/computer-network-lab-note/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">computer-network-lab-note</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        <!-- 
            
    <div id="gitalk-container"></div>
    <script data-swup-reload-script
            src="//cdn.staticfile.org/gitalk/1.8.0/gitalk.min.js"></script>
    <script data-swup-reload-script>

        function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
                __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
                Gitalk && new Gitalk({
                    clientID: '8083299a8ee2aaf23879',
                    clientSecret: 'a8161e81d4872181e884fdb69f7be24916b6a9d0',
                    repo: 'charles2530_issues',
                    owner: 'Charles2530',
                    admin: ['Charles2530'],
                    id: __gitalk__pathname,
                    language: 'en',
                    proxy: 'https://github.com/login/oauth/access_token'
                }).render('gitalk-container');

            } catch (e) {
                window.Gitalk = null;
            }
        }

        if ('true') {
            const loadGitalkTimeout = setTimeout(() => {
                loadGitalk();
                clearTimeout(loadGitalkTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
        }
    </script>



         -->
        <script src="https://utteranc.es/client.js" repo="Charles2530/Charles2530.github.io" issue-term="pathname"
            label="Comment" theme="preferred-color-scheme" crossorigin="anonymous" async>
            </script>
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">CUDA-note-summary</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%9E%B6%E6%9E%84"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E6%80%A7"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%9E%B6%E6%9E%84"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#flynns-taxonomy"><span class="nav-text"> Flynns Taxonomy</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%86%85%E5%AD%98%E5%88%92%E5%88%86"><span class="nav-text"> </span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97%E4%B8%8E-cuda"><span class="nav-text">  CUDA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%9E%84%E6%9E%B6%E6%9E%84"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E4%BE%8B"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cuda%E4%B8%80%E7%A7%8D%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97%E5%B9%B3%E5%8F%B0"><span class="nav-text"> CUDA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hello-world"><span class="nav-text"> Hello World</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cuda-%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0"><span class="nav-text"> CUDA </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#cuda-%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0-2"><span class="nav-text"> CUDA </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cuda-%E7%BC%96%E7%A8%8B%E7%BB%93%E6%9E%84"><span class="nav-text"> CUDA </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%B8%E5%87%BD%E6%95%B0%E6%A6%82%E8%BF%B0"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E6%A0%B8%E5%87%BD%E6%95%B0"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%A0%B8%E5%87%BD%E6%95%B0"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E6%A0%B8%E5%87%BD%E6%95%B0"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%99%E6%A0%B8%E5%87%BD%E6%95%B0%E8%AE%A1%E6%97%B6"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-cpu-%E8%AE%A1%E6%97%B6"><span class="nav-text">  CPU </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-nvprof-%E8%AE%A1%E6%97%B6"><span class="nav-text">  nvprof </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%90%86%E8%AE%BA%E7%95%8C%E9%99%90%E6%9C%80%E5%A4%A7%E5%8C%96"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%84%E7%BB%87%E5%B9%B6%E8%A1%8C%E7%BA%BF%E7%A8%8B"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9D%97%E5%92%8C%E7%BA%BF%E7%A8%8B%E5%BB%BA%E7%AB%8B%E7%9F%A9%E9%98%B5%E7%B4%A2%E5%BC%95"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5%E5%8A%A0%E6%B3%95"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E7%BD%91%E6%A0%BC%E7%BB%84%E5%90%88%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#gpu-%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF"><span class="nav-text"> GPU </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#api-%E6%9F%A5%E8%AF%A2-gpu-%E4%BF%A1%E6%81%AF"><span class="nav-text"> API  GPU </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nvidia-smi"><span class="nav-text"> NVIDIA-SMI</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cuda-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0"><span class="nav-text"> CUDA </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gpu-%E6%9E%B6%E6%9E%84%E6%A6%82%E8%BF%B0"><span class="nav-text"> GPU </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sm"><span class="nav-text"> SM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simd-vs-simt"><span class="nav-text"> SIMD vs SIMT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cuda-%E7%BC%96%E7%A8%8B%E7%9A%84%E7%BB%84%E4%BB%B6%E4%B8%8E%E9%80%BB%E8%BE%91"><span class="nav-text"> CUDA </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fermi-%E6%9E%B6%E6%9E%84"><span class="nav-text"> Fermi </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#kepler-%E6%9E%B6%E6%9E%84"><span class="nav-text"> Kepler </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-profile-%E8%BF%9B%E8%A1%8C%E4%BC%98%E5%8C%96profile-driven-optimization"><span class="nav-text">  Profile Profile-Driven Optimization</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%90%86%E8%A7%A3%E7%BA%BF%E7%A8%8B%E6%9D%9F%E6%89%A7%E8%A1%8C%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%92%8C%E7%BA%BF%E7%A8%8B%E5%9D%97"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%88%86%E5%8C%96"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E4%BB%B6%E5%92%8C%E6%8C%87%E6%A0%87"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E5%88%86%E9%85%8D"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%B6%E8%BF%9F%E9%9A%90%E8%97%8F"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%A0%E7%94%A8%E7%8E%87"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E6%80%A7%E8%A1%A8%E7%8E%B0"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-nvprof-%E6%A3%80%E6%B5%8B%E6%B4%BB%E8%B7%83%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%9D%9F"><span class="nav-text">  nvprof </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-nvprof-%E6%A3%80%E6%B5%8B%E5%86%85%E5%AD%98%E6%93%8D%E4%BD%9C"><span class="nav-text">  nvprof </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%A4%A7%E5%B9%B6%E8%A1%8C%E6%80%A7"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%81%BF%E5%85%8D%E5%88%86%E6%94%AF%E5%88%86%E5%8C%96"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E8%A7%84%E7%BA%A6%E9%97%AE%E9%A2%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E8%A7%84%E7%BA%A6%E4%B8%AD%E7%9A%84%E5%88%86%E5%8C%96"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%B9%E5%96%84%E5%B9%B6%E8%A1%8C%E8%A7%84%E7%BA%A6%E7%9A%84%E5%88%86%E5%8C%96"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%A4%E9%94%99%E9%85%8D%E5%AF%B9%E7%9A%84%E8%A7%84%E7%BA%A6"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B1%95%E5%BC%80%E5%BE%AA%E7%8E%AF"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B1%95%E5%BC%80%E7%9A%84%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E5%B1%95%E5%BC%80%E7%9A%84%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0%E7%9A%84%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0%E7%9A%84%E5%BD%92%E7%BA%A6-2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%B9%B6%E8%A1%8C"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B5%8C%E5%A5%97%E6%89%A7%E8%A1%8C"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8-gpu-%E4%B8%8A%E5%B5%8C%E5%A5%97-hello-world"><span class="nav-text">  GPU  Hello World</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E7%9A%84%E4%BC%98%E7%82%B9"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cuda-%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="nav-text"> CUDA </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%B9%E7%90%86%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gpu-%E7%BC%93%E5%AD%98"><span class="nav-text"> GPU </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cuda-%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E6%80%BB%E7%BB%93"><span class="nav-text"> CUDA </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-2"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E5%92%8C%E9%87%8A%E6%94%BE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E4%BC%A0%E8%BE%93"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%BA%E5%AE%9A%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%B6%E6%8B%B7%E8%B4%9D%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9F%E4%B8%80%E8%99%9A%E6%8B%9F%E5%AF%BB%E5%9D%80"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9F%E4%B8%80%E5%86%85%E5%AD%98%E5%AF%BB%E5%9D%80"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E6%A8%A1%E5%BC%8F"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E9%BD%90%E4%B8%8E%E5%90%88%E5%B9%B6%E8%AE%BF%E9%97%AE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98%E8%AF%BB%E5%8F%96"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E5%8A%A0%E8%BD%BD"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B2%A1%E6%9C%89%E7%BC%93%E5%AD%98%E7%9A%84%E5%8A%A0%E8%BD%BD"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E9%BD%90%E8%AF%BB%E5%8F%96%E7%A4%BA%E4%BE%8B"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AA%E8%AF%BB%E7%BC%93%E5%AD%98"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98%E5%86%99%E5%85%A5"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%95%B0%E7%BB%84%E4%B8%8E%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#aos-%E6%95%B0%E6%8D%AE%E5%B8%83%E5%B1%80%E7%9A%84%E7%AE%80%E5%8D%95%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text"> AoS </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#soa-%E6%95%B0%E6%8D%AE%E5%B8%83%E5%B1%80%E7%9A%84%E7%AE%80%E5%8D%95%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text"> SoA </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E8%B0%83%E6%95%B4"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%95%E5%BC%80%E6%8A%80%E6%9C%AF"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E5%A4%A7%E5%B9%B6%E8%A1%8C%E6%80%A7-2"><span class="nav-text"> </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%B8%E5%87%BD%E6%95%B0%E5%8F%AF%E8%BE%BE%E5%88%B0%E7%9A%84%E5%B8%A6%E5%AE%BD"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%B8%A6%E5%AE%BD"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E8%BD%AC%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E8%BD%AC%E7%BD%AE%E6%A0%B8%E5%87%BD%E6%95%B0%E8%AE%BE%E7%BD%AE%E4%B8%8A%E9%99%90%E5%92%8C%E4%B8%8B%E9%99%90"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E7%B4%A0%E8%BD%AC%E7%BD%AE%E8%AF%BB%E5%8F%96%E8%A1%8C%E4%B8%8E%E8%AF%BB%E5%8F%96%E5%88%97"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%95%E5%BC%80%E8%BD%AC%E7%BD%AE%E8%AF%BB%E5%8F%96%E8%A1%8C%E4%B8%8E%E8%AF%BB%E5%8F%96%E5%88%97"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E8%A7%92%E8%BD%AC%E7%BD%AE%E8%AF%BB%E5%8F%96%E8%A1%8C%E4%B8%8E%E8%AF%BB%E5%8F%96%E5%88%97"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%98%A6%E5%9D%97%E6%9D%A5%E5%A2%9E%E5%8A%A0%E5%B9%B6%E8%A1%8C%E6%80%A7"><span class="nav-text"> </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%BB%9F%E4%B8%80%E5%86%85%E5%AD%98%E7%9A%84%E5%90%91%E9%87%8F%E5%8A%A0%E6%B3%95"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9F%E4%B8%80%E5%86%85%E5%AD%98%E7%9F%A9%E9%98%B5%E5%8A%A0%E6%B3%95"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%92%8C%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%92%8C%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98-2"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cuda-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E6%A6%82%E8%BF%B0"><span class="nav-text"> CUDA </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98-2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%AD%98%E5%82%A8%E4%BD%93%E5%92%8C%E8%AE%BF%E9%97%AE%E6%A8%A1%E5%BC%8F"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%AD%98%E5%82%A8%E4%BD%93"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E4%BD%93%E5%86%B2%E7%AA%81"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E6%A8%A1%E5%BC%8F"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%A1%AB%E5%85%85"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E6%A8%A1%E5%BC%8F%E9%85%8D%E7%BD%AE"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5-2"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%B1%E6%8E%92%E5%BA%8F%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E9%9A%9C%E7%A2%8D"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%A0%85%E6%A0%8F"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#volatile-%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="nav-text"> Volatile </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E6%95%B0%E6%8D%AE%E5%B8%83%E5%B1%80"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B9%E5%BD%A2%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BB%E5%BA%8F%E8%AE%BF%E9%97%AE%E5%92%8C%E5%88%97%E4%B8%BB%E5%BA%8F%E8%AE%BF%E9%97%AE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E8%A1%8C%E4%B8%BB%E5%BA%8F%E5%86%99%E5%92%8C%E6%8C%89%E5%88%97%E4%B8%BB%E5%BA%8F%E8%AF%BB"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E9%9D%99%E6%80%81%E5%A3%B0%E6%98%8E%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E5%8A%A8%E6%80%81%E5%A3%B0%E6%98%8E%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E5%BD%A2%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%86%85%E6%A0%B8%E6%80%A7%E8%83%BD%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A9%E5%BD%A2%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BB%E5%BA%8F%E8%AE%BF%E9%97%AE%E5%92%8C%E5%88%97%E4%B8%BB%E5%BA%8F%E8%AE%BF%E9%97%AE-2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E4%B8%BB%E5%BA%8F%E5%86%99%E6%93%8D%E4%BD%9C%E5%92%8C%E5%88%97%E4%B8%BB%E5%BA%8F%E8%AF%BB%E6%93%8D%E4%BD%9C"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%A3%B0%E6%98%8E%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E9%9D%99%E6%80%81%E5%A3%B0%E6%98%8E%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98-2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E5%8A%A8%E6%80%81%E5%A3%B0%E6%98%8E%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98-2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E5%BD%A2%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E5%86%85%E6%A0%B8%E6%80%A7%E8%83%BD%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-text"> </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%8F%E5%B0%91%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%B1%95%E5%BC%80%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%BD%92%E7%BA%A6"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E6%95%88%E5%B8%A6%E5%AE%BD"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%88%E5%B9%B6%E7%9A%84%E5%85%A8%E5%B1%80%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E5%87%86%E8%BD%AC%E7%BD%AE%E5%86%85%E6%A0%B8"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E7%9F%A9%E9%98%B5%E8%BD%AC%E7%BD%AE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%A1%AB%E5%85%85%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9A%84%E7%9F%A9%E9%98%B5%E8%BD%AC%E7%BD%AE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%B1%95%E5%BC%80%E7%9A%84%E7%9F%A9%E9%98%B5%E8%BD%AC%E7%BD%AE"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%A4%A7%E5%B9%B6%E8%A1%8C%E6%80%A7-3"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98-2"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98-3"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%B8%B8%E9%87%8F%E5%86%85%E5%AD%98%E5%AE%9E%E7%8E%B0%E4%B8%80%E7%BB%B4%E6%A8%A1%E6%9D%BF"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8E%E5%8F%AA%E8%AF%BB%E7%BC%93%E5%AD%98%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-3"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E6%B4%97%E7%89%8C%E6%8C%87%E4%BB%A4"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E6%B4%97%E7%89%8C%E6%8C%87%E4%BB%A4%E7%9A%84%E4%B8%8D%E5%90%8C%E5%BD%A2%E5%BC%8F"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%86%85%E7%9A%84%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%A8%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%80%BC%E7%9A%84%E5%B9%BF%E6%92%AD"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%86%85%E4%B8%8A%E7%A7%BB"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%86%85%E4%B8%8B%E7%A7%BB"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%9D%9F%E5%86%85%E7%8E%AF%E7%BB%95%E7%A7%BB%E5%8A%A8"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%A8%E7%BA%BF%E7%A8%8B%E6%9D%9F%E7%9A%84%E8%9D%B4%E8%9D%B6%E4%BA%A4%E6%8D%A2"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%A8%E7%BA%BF%E7%A8%8B%E6%9D%9F%E4%BA%A4%E6%8D%A2%E6%95%B0%E7%BB%84%E5%80%BC"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%A8%E7%BA%BF%E7%A8%8B%E6%9D%9F%E4%BD%BF%E7%94%A8%E6%95%B0%E7%BB%84%E7%B4%A2%E5%BC%95%E4%BA%A4%E6%8D%A2%E6%95%B0%E5%80%BC"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%9D%9F%E6%B4%97%E7%89%8C%E6%8C%87%E4%BB%A4%E7%9A%84%E5%B9%B6%E8%A1%8C%E8%A7%84%E7%BA%A6"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%81%E5%92%8C%E5%B9%B6%E5%8F%91"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%81%E5%92%8C%E4%BA%8B%E4%BB%B6%E6%A6%82%E8%BF%B0"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#cuda-%E6%B5%81"><span class="nav-text"> CUDA </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E8%B0%83%E5%BA%A6"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E5%81%87%E7%9A%84%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hyper-q-%E6%8A%80%E6%9C%AF"><span class="nav-text"> Hyper-Q </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cuda-%E4%BA%8B%E4%BB%B6"><span class="nav-text"> CUDA </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E9%94%80%E6%AF%81"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%B0%E5%BD%95%E4%BA%8B%E4%BB%B6%E5%92%8C%E8%AE%A1%E7%AE%97%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E5%90%8C%E6%AD%A5"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%BB%E5%A1%9E%E6%B5%81%E5%92%8C%E9%9D%9E%E9%98%BB%E5%A1%9E%E6%B5%81"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E5%BC%8F%E5%90%8C%E6%AD%A5"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%BE%E5%BC%8F%E5%90%8C%E6%AD%A5"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E9%85%8D%E7%BD%AE%E4%BA%8B%E4%BB%B6"><span class="nav-text"> </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E5%86%85%E6%A0%B8%E6%89%A7%E8%A1%8C"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E7%A9%BA%E6%B5%81%E4%B8%AD%E7%9A%84%E5%B9%B6%E5%8F%91%E5%86%85%E6%A0%B8"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-openmp-%E7%9A%84%E8%B0%83%E5%BA%A6%E6%93%8D%E4%BD%9C"><span class="nav-text">  OpenMP </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%B0%83%E6%95%B4%E6%B5%81%E8%A1%8C%E4%B8%BA"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gpu-%E8%B5%84%E6%BA%90%E7%9A%84%E5%B9%B6%E5%8F%91%E9%99%90%E5%88%B6"><span class="nav-text"> GPU </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%B5%81%E7%9A%84%E9%98%BB%E5%A1%9E%E8%A1%8C%E4%B8%BA"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%B5%81%E9%97%B4%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%87%8D%E5%8F%A0%E5%86%85%E6%A0%B8%E6%89%A7%E8%A1%8C%E5%92%8C%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="nav-text"> </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E8%B0%83%E5%BA%A6%E9%87%8D%E5%8F%A0"><span class="nav-text"> </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E8%B0%83%E5%BA%A6%E9%87%8D%E5%8F%A0"><span class="nav-text"> </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%87%8D%E5%8F%A0-gpu-%E5%92%8C-cpu-%E7%9A%84%E6%89%A7%E8%A1%8C"><span class="nav-text">  GPU  CPU </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%81%E5%9B%9E%E8%B0%83"><span class="nav-text"> </span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Charles</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        292 posts in total
                    </span>
                    
                        <span>
                            1260.3k words in total
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">Visitor Count</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">Total Page Views</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">Powered by Charles</span>
            <span class="text-sm lg:block">Theme&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.1</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex justify-center items-center">
                <a class="flex justify-center items-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/Swup.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/SwupSlideTheme.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/SwupScriptsPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/SwupProgressPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/SwupScrollPlugin.min.js"></script><script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/SwupPreloadPlugin.min.js"></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>






<script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/imageViewer.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/utils.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/main.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/layouts/navbarShrink.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/scrollTopBottom.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/lightDarkSwitch.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/layouts/categoryList.js"></script>


    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/localSearch.js"></script>



    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/codeBlock.js"></script>



    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/layouts/lazyload.js"></script>



    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/runtime.js"></script>
    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/odometer.min.js"></script>
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/assets/odometer-theme-minimal.css">



  <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/Typed.min.js"></script>
  <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/plugins/typed.js"></script>



    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/mermaid.min.js"></script>
    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/plugins/mermaid.js"></script>



    <script src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/libs/minimasonry.min.js"></script>
    <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/plugins/masonry.js"></script>




<div class="post-scripts" data-swup-reload-script>
    
        <script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/tools/tocToggle.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/layouts/toc.js"></script><script type="module" src="https://evan.beee.top/projects/hexo-theme-redefine@2.6.1/source/js/plugins/tabs.js"></script>
    
</div>


</body>
</html>
<!--  -->
<script type="text/javascript" src="/js/love.js"></script>